<!DOCTYPE html> <html lang=ko class=translated-ltr style><!--
 Page saved with SingleFile 
 url: https://google.github.io/styleguide/go/best-practices.html 
 saved date: Thu Jun 27 2024 13:39:48 GMT+0900 (한국 표준시)
--><meta charset=utf-8>
<meta http-equiv=X-UA-Compatible content="IE=edge">
<meta name=viewport content="width=device-width, initial-scale=1">
<title>스타일가이드 | Google이 만든 오픈소스 프로젝트를 위한 스타일 가이드</title>
<meta name=generator content="Jekyll v3.9.5">
<meta property=og:title content=styleguide>
<meta property=og:locale content=en_US>
<meta name=description content="Style guides for Google-originated open-source projects">
<meta property=og:description content="Style guides for Google-originated open-source projects">
<link rel=canonical href=https://google.github.io/styleguide/go/best-practices.html>
<meta property=og:url content=https://google.github.io/styleguide/go/best-practices.html>
<meta property=og:site_name content=styleguide>
<meta property=og:type content=website>
<meta name=twitter:card content=summary>
<meta property=twitter:title content=styleguide>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","description":"Style guides for Google-originated open-source projects","headline":"styleguide","url":"https://google.github.io/styleguide/go/best-practices.html"}</script>
<style class=anchorjs>.anchorjs-link{opacity:0;text-decoration:none;-webkit-font-smoothing:antialiased}:hover>.anchorjs-link,.anchorjs-link:focus{opacity:1}[data-anchorjs-icon]::after{content:attr(data-anchorjs-icon)}@font-face{font-family:anchorjs-icons;src:url(data:n/a;base64,AAEAAAALAIAAAwAwT1MvMg8yG2cAAAE4AAAAYGNtYXDp3gC3AAABpAAAAExnYXNwAAAAEAAAA9wAAAAIZ2x5ZlQCcfwAAAH4AAABCGhlYWQHFvHyAAAAvAAAADZoaGVhBnACFwAAAPQAAAAkaG10eASAADEAAAGYAAAADGxvY2EACACEAAAB8AAAAAhtYXhwAAYAVwAAARgAAAAgbmFtZQGOH9cAAAMAAAAAunBvc3QAAwAAAAADvAAAACAAAQAAAAEAAHzE2p9fDzz1AAkEAAAAAADRecUWAAAAANQA6R8AAAAAAoACwAAAAAgAAgAAAAAAAAABAAADwP/AAAACgAAA/9MCrQABAAAAAAAAAAAAAAAAAAAAAwABAAAAAwBVAAIAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAMCQAGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAg//0DwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAAIAAAACgAAxAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADAAAAAIAAgAAgAAACDpy//9//8AAAAg6cv//f///+EWNwADAAEAAAAAAAAAAAAAAAAACACEAAEAAAAAAAAAAAAAAAAxAAACAAQARAKAAsAAKwBUAAABIiYnJjQ3NzY2MzIWFxYUBwcGIicmNDc3NjQnJiYjIgYHBwYUFxYUBwYGIwciJicmNDc3NjIXFhQHBwYUFxYWMzI2Nzc2NCcmNDc2MhcWFAcHBgYjARQGDAUtLXoWOR8fORYtLTgKGwoKCjgaGg0gEhIgDXoaGgkJBQwHdR85Fi0tOAobCgoKOBoaDSASEiANehoaCQkKGwotLXoWOR8BMwUFLYEuehYXFxYugC44CQkKGwo4GkoaDQ0NDXoaShoKGwoFBe8XFi6ALjgJCQobCjgaShoNDQ0NehpKGgobCgoKLYEuehYXAAAADACWAAEAAAAAAAEACAAAAAEAAAAAAAIAAwAIAAEAAAAAAAMACAAAAAEAAAAAAAQACAAAAAEAAAAAAAUAAQALAAEAAAAAAAYACAAAAAMAAQQJAAEAEAAMAAMAAQQJAAIABgAcAAMAAQQJAAMAEAAMAAMAAQQJAAQAEAAMAAMAAQQJAAUAAgAiAAMAAQQJAAYAEAAMYW5jaG9yanM0MDBAAGEAbgBjAGgAbwByAGoAcwA0ADAAMABAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAH//wAP)format("truetype")}</style><style>/*! normalize.css v4.1.1 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}a{background-color:transparent}a:active,a:hover{outline-width:0}h1{margin:0.67em 0}::-webkit-input-placeholder{color:inherit;opacity:0.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*{box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:14px;line-height:1.5;color:#24292e;background-color:#fff}a{color:#0366d6;text-decoration:none}a:hover{text-decoration:underline}strong{font-weight:600}blockquote{margin:0}code{font-family:"SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace}pre{font-family:"SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace}@keyframes fade-in{0%{opacity:0}100%{opacity:1}}@keyframes fade-out{0%{opacity:1}100%{opacity:0}}@keyframes fade-up{0%{opacity:0.8;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}@keyframes fade-down{0%{opacity:1;transform:translateY(0)}100%{opacity:0.5;transform:translateY(100%)}}@keyframes grow-x{to{width:100%}}@keyframes shrink-x{to{width:0%}}@keyframes scale-in{0%{opacity:0;transform:scale(0.5)}100%{opacity:1;transform:scale(1)}}@keyframes pulse{0%{opacity:0.3}10%{opacity:1}100%{opacity:0.3}}@keyframes pulse-in{0%{transform:scale3d(1,1,1)}50%{transform:scale3d(1.1,1.1,1.1)}100%{transform:scale3d(1,1,1)}}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}.my-5{margin-top:32px!important;margin-bottom:32px!important}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}.px-3{padding-right:16px!important;padding-left:16px!important}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:1012px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:768px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (max-width:544px){}@media (min-width:544px) and (max-width:768px){}@media (min-width:768px) and (max-width:1012px){}@media (min-width:1012px){}.container-lg{max-width:1012px;margin-right:auto;margin-left:auto}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}@media (min-width:544px){}@media (min-width:768px){}@media (min-width:1012px){}@media (min-width:1280px){}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body::before{display:table;content:""}.markdown-body::after{display:table;clear:both;content:""}.markdown-body>*:first-child{margin-top:0!important}.markdown-body>*:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body pre{margin-top:0;margin-bottom:16px}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:0.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h3 code,.markdown-body h4 code{font-size:inherit}.markdown-body h1{padding-bottom:0.3em;font-size:2em;border-bottom:1px solid #eaecef}.markdown-body h2{padding-bottom:0.3em;font-size:1.5em;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body ul,.markdown-body ol{padding-left:2em}.markdown-body ul ul,.markdown-body ol ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body code{padding:0.2em 0.4em;margin:0;font-size:85%;background-color:rgba(27,31,35,0.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{font-size:100%;word-break:normal;white-space:pre;background:transparent}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.highlight .c{color:#999988;font-style:italic}.highlight .kt{color:#445588;font-weight:bold}.highlight .k{color:#000000;font-weight:bold}.highlight .m{color:#009999}.highlight .sc{color:#d14}.highlight .se{color:#d14}.highlight .s{color:#d14}.highlight .nb{color:#0086B3}.highlight .no{color:#008080}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .o{color:#000000;font-weight:bold}.highlight{background-color:#f8f8f8}</style>
<style>@-webkit-keyframes spinner-rotator{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(270deg);transform:rotate(270deg)}}@keyframes spinner-rotator{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(270deg);transform:rotate(270deg)}}@-webkit-keyframes spinner-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;-webkit-transform:rotate(135deg);transform:rotate(135deg)}100%{stroke-dashoffset:187;-webkit-transform:rotate(450deg);transform:rotate(450deg)}}@keyframes spinner-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;-webkit-transform:rotate(135deg);transform:rotate(135deg)}100%{stroke-dashoffset:187;-webkit-transform:rotate(450deg);transform:rotate(450deg)}}</style><meta name=referrer content=no-referrer><style>.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
 <body>
 <div class="container-lg px-3 my-5 markdown-body">
 
 <h1><a href=https://google.github.io/styleguide/><font style=vertical-align:inherit><font style=vertical-align:inherit>스타일 가이드</font></font></a></h1>
 
 
<h1 id=go-style-best-practices><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 스타일 모범 사례</font></font></h1>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>https://google.github.io/styleguide/go/best-practices</font></font></p>
<p><a href=https://google.github.io/styleguide/go/index><font style=vertical-align:inherit><font style=vertical-align:inherit>개요</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> | </font></font><a href=https://google.github.io/styleguide/go/guide><font style=vertical-align:inherit><font style=vertical-align:inherit>가이드</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> | </font></font><a href=https://google.github.io/styleguide/go/decisions><font style=vertical-align:inherit><font style=vertical-align:inherit>결정</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> |
 </font></font><a href=https://google.github.io/styleguide/go/best-practices><font style=vertical-align:inherit><font style=vertical-align:inherit>모범 사례</font></font></a></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 문서는 
Google의 </font></font><a href=https://google.github.io/styleguide/go/index><font style=vertical-align:inherit><font style=vertical-align:inherit>Go Style을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 설명하는 일련의 문서 중 일부입니다 . </font><font style=vertical-align:inherit>이 문서는 </font><strong><a href=https://google.github.io/styleguide/go/index#normative><font style=vertical-align:inherit>규범</font></a></strong></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 적이지도 </font><font style=vertical-align:inherit>않고
 </font><a href=https://google.github.io/styleguide/go/index#canonical><font style=vertical-align:inherit>표준</font></a></font><a href=https://google.github.io/styleguide/go/index#normative><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/index#canonical><font style=vertical-align:inherit></font></a></strong><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/guide><font style=vertical-align:inherit><font style=vertical-align:inherit> 적이지도 않으며 핵심 스타일 가이드</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 대한 보조 문서입니다
 </font><font style=vertical-align:inherit>. </font><font style=vertical-align:inherit>자세한 내용은 </font></font><a href=https://google.github.io/styleguide/go/index#about><font style=vertical-align:inherit><font style=vertical-align:inherit>개요를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 .</font></font></p>
<p><a id=about></a></p>
<h2 id=about><font style=vertical-align:inherit><font style=vertical-align:inherit>에 대한</font></font><a class=anchorjs-link href=#about aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 파일은 </font></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 스타일 가이드를 가장 잘 적용하는 방법에 대한 지침을</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 문서화합니다 . 이 지침은 자주 발생하는 일반적인 상황을 대상으로 작성되었지만 모든 상황에 적용되는 것은 아닙니다. 가능한 경우, 이를 적용할 시기와 적용하지 않을 시기를 결정하는 데 고려되는 고려 사항과 함께 다양한 대안 접근법이 논의됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>스타일 가이드 문서 전체에 대한 </font></font><a href=https://google.github.io/styleguide/go/index#about><font style=vertical-align:inherit><font style=vertical-align:inherit>개요를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 .</font></font></p>
<p><a id=naming></a></p>
<h2 id=naming><font style=vertical-align:inherit><font style=vertical-align:inherit>명명</font></font><a class=anchorjs-link href=#naming aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><a id=function-names></a></p>
<h3 id=function-and-method-names><font style=vertical-align:inherit><font style=vertical-align:inherit>함수 및 메서드 이름</font></font><a class=anchorjs-link href=#function-and-method-names aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><a id=function-name-repetition></a></p>
<h4 id=avoid-repetition><font style=vertical-align:inherit><font style=vertical-align:inherit>반복을 피하세요</font></font><a class=anchorjs-link href=#avoid-repetition aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수나 메소드의 이름을 선택할 때 이름이 읽히는 맥락을 고려하십시오. </font><font style=vertical-align:inherit>통화 현장에서 과도한 </font></font><a href=https://google.github.io/styleguide/go/decisions#repetition><font style=vertical-align:inherit><font style=vertical-align:inherit>반복을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 방지하려면 다음 권장 사항을 고려하십시오
 .</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적으로 함수 및 메서드 이름에서 다음은 생략될 수 있습니다.</font></font></p>
 <ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>입력 및 출력 유형(충돌이 없는 경우)</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>메소드 수신자의 유형</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>입력 또는 출력이 포인터인지 여부</font></font></li>
 </ul>
 </li>
 <li>
 <p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#repetitive-with-package><font style=vertical-align:inherit><font style=vertical-align:inherit>함수의 경우 패키지 이름을 반복</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 하지 마세요
 </font><font style=vertical-align:inherit>.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>yamlconfig</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>ParseYAMLConfig</span><span class=p>(</span><span class=n>input</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=n>Config</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> </div>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>yamlconfig</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>Parse</span><span class=p>(</span><span class=n>input</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=n>Config</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>메소드의 경우 메소드 수신자의 이름을 반복하지 마십시오.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>WriteConfigTo</span><span class=p>(</span><span class=n>w</span> <span class=n>io</span><span class=o>.</span><span class=n>Writer</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> </div>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>WriteTo</span><span class=p>(</span><span class=n>w</span> <span class=n>io</span><span class=o>.</span><span class=n>Writer</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>매개변수로 전달된 변수의 이름을 반복하지 마십시오.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>OverrideFirstWithSecond</span><span class=p>(</span><span class=n>dest</span><span class=p>,</span> <span class=n>source</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=kt>error</span>
</code></pre></div> </div>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>Override</span><span class=p>(</span><span class=n>dest</span><span class=p>,</span> <span class=n>source</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=kt>error</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>반환 값의 이름과 유형을 반복하지 마십시오.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>TransformYAMLToJSON</span><span class=p>(</span><span class=n>input</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=o>*</span><span class=n>jsonconfig</span><span class=o>.</span><span class=n>Config</span>
</code></pre></div> </div>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>Transform</span><span class=p>(</span><span class=n>input</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=o>*</span><span class=n>jsonconfig</span><span class=o>.</span><span class=n>Config</span>
</code></pre></div> </div>
 </li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>유사한 이름의 기능을 명확하게 해야 하는 경우 추가 정보를 포함하는 것이 허용됩니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>WriteTextTo</span><span class=p>(</span><span class=n>w</span> <span class=n>io</span><span class=o>.</span><span class=n>Writer</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>WriteBinaryTo</span><span class=p>(</span><span class=n>w</span> <span class=n>io</span><span class=o>.</span><span class=n>Writer</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div></div>
<p><a id=function-name-conventions></a></p>
<h4 id=naming-conventions><font style=vertical-align:inherit><font style=vertical-align:inherit>명명 규칙</font></font><a class=anchorjs-link href=#naming-conventions aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수와 메서드의 이름을 선택할 때 몇 가지 일반적인 규칙이 있습니다.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>무언가를 반환하는 함수에는 명사형 이름이 부여됩니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>JobName</span><span class=p>(</span><span class=n>key</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=n>value</span> <span class=kt>string</span><span class=p>,</span> <span class=n>ok</span> <span class=kt>bool</span><span class=p>)</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>이에 따라 함수와 메서드 이름은
 </font></font><a href=https://google.github.io/styleguide/go/decisions#getters><font style=vertical-align:inherit><font style=vertical-align:inherit>접두사를 피해야</font></font><code class="language-plaintext highlighter-rouge">Get</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 합니다 .</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>GetJobName</span><span class=p>(</span><span class=n>key</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=n>value</span> <span class=kt>string</span><span class=p>,</span> <span class=n>ok</span> <span class=kt>bool</span><span class=p>)</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>어떤 일을 하는 함수에는 동사와 비슷한 이름이 지정됩니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>WriteDetail</span><span class=p>(</span><span class=n>w</span> <span class=n>io</span><span class=o>.</span><span class=n>Writer</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>관련된 유형만 다른 ​​동일한 함수에는 이름 끝에 유형 이름이 포함됩니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>ParseInt</span><span class=p>(</span><span class=n>input</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=k>func</span> <span class=n>ParseInt64</span><span class=p>(</span><span class=n>input</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=k>func</span> <span class=n>AppendInt</span><span class=p>(</span><span class=n>buf</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>,</span> <span class=n>value</span> <span class=kt>int</span><span class=p>)</span> <span class=p>[]</span><span class=kt>byte</span>
<span class=k>func</span> <span class=n>AppendInt64</span><span class=p>(</span><span class=n>buf</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>,</span> <span class=n>value</span> <span class=kt>int64</span><span class=p>)</span> <span class=p>[]</span><span class=kt>byte</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>명확한 "기본" 버전이 있는 경우 해당 버전의 이름에서 유형을 생략할 수 있습니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>Marshal</span><span class=p>()</span> <span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Config</span><span class=p>)</span> <span class=n>MarshalText</span><span class=p>()</span> <span class=p>(</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> </div>
 </li>
</ul>
<p><a id=naming-doubles></a></p>
<h3 id=test-double-packages-and-types><font style=vertical-align:inherit><font style=vertical-align:inherit>이중 패키지 및 유형 테스트</font></font><a class=anchorjs-link href=#test-double-packages-and-types aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit>테스트 도우미, 특히 테스트 더블을</font></a><font style=vertical-align:inherit> 제공하는 패키지 및 유형의 </font></font><a href=https://google.github.io/styleguide/go/guide#naming><font style=vertical-align:inherit><font style=vertical-align:inherit>이름을 지정하는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 데 적용할 수 있는 몇 가지 원칙이 있습니다 </font><font style=vertical-align:inherit>. 테스트 더블은 스텁, 가짜, 모의 또는 스파이일 수 있습니다.</font></font><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 예제에서는 대부분 스텁을 사용합니다. 코드에서 가짜 또는 다른 종류의 테스트 더블을 사용하는 경우 그에 따라 이름을 업데이트하십시오.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음과 유사한 프로덕션 코드를 제공하는 잘 집중된 패키지가 있다고 가정합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>package</span> <span class=n>creditcard</span><font></font>
<font></font>
<span class=k>import</span> <span class=p>(</span>
    <span class=s>"errors"</span><font></font>
<font></font>
    <span class=s>"path/to/money"</span>
<span class=p>)</span><font></font>
<font></font>
<span class=c>// ErrDeclined indicates that the issuer declines the charge.</span>
<span class=k>var</span> <span class=n>ErrDeclined</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>New</span><span class=p>(</span><span class=s>"creditcard: declined"</span><span class=p>)</span><font></font>
<font></font>
<span class=c>// Card contains information about a credit card, such as its issuer,</span>
<span class=c>// expiration, and limit.</span>
<span class=k>type</span> <span class=n>Card</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=c>// omitted</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// Service allows you to perform operations with credit cards against external</span>
<span class=c>// payment processor vendors like charge, authorize, reimburse, and subscribe.</span>
<span class=k>type</span> <span class=n>Service</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=c>// omitted</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>s</span> <span class=o>*</span><span class=n>Service</span><span class=p>)</span> <span class=n>Charge</span><span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Card</span><span class=p>,</span> <span class=n>amount</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=c>/* omitted */</span> <span class=p>}</span>
</code></pre></div></div>
<p><a id=naming-doubles-helper-package></a></p>
<h4 id=creating-test-helper-packages><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 도우미 패키지 만들기</font></font><a class=anchorjs-link href=#creating-test-helper-packages aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다른 테스트 더블을 포함하는 패키지를 생성한다고 가정해 보겠습니다. </font></font><code class="language-plaintext highlighter-rouge">package creditcard</code><font style=vertical-align:inherit><font style=vertical-align:inherit>이 예에서는 (위의)를 </font><font style=vertical-align:inherit>사용합니다 .</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>한 가지 접근 방식은 테스트를 위해 프로덕션 패키지를 기반으로 새로운 Go 패키지를 도입하는 것입니다. 안전한 선택은 </font></font><code class="language-plaintext highlighter-rouge">test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>원래 패키지 이름("creditcard" + "test")에 단어를 추가하는 것입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>creditcardtest</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>달리 명시적으로 언급하지 않는 한 아래 섹션의 모든 예는 에 있습니다
 </font></font><code class="language-plaintext highlighter-rouge">package creditcardtest</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><a id=naming-doubles-simple></a></p>
<h4 id=simple-case><font style=vertical-align:inherit><font style=vertical-align:inherit>간단한 케이스</font></font><a class=anchorjs-link href=#simple-case aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>에 대한 테스트 더블 세트를 추가하려고 합니다 </font></font><code class="language-plaintext highlighter-rouge">Service</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. </font></font><code class="language-plaintext highlighter-rouge">Card</code><font style=vertical-align:inherit><font style=vertical-align:inherit>사실상 프로토콜 버퍼 메시지와 유사한 멍청한 데이터 유형이기 </font><font style=vertical-align:inherit>때문에 테스트에서 특별한 처리가 필요하지 않으므로 double이 필요하지 않습니다. </font><font style=vertical-align:inherit>한 가지 유형(예: )에 대해 더블 테스트만 예상하는 경우 </font></font><code class="language-plaintext highlighter-rouge">Service</code><font style=vertical-align:inherit><font style=vertical-align:inherit>더블 이름을 지정하는 데 간결한 접근 방식을 취할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>import</span> <span class=p>(</span>
    <span class=s>"path/to/creditcard"</span>
    <span class=s>"path/to/money"</span>
<span class=p>)</span><font></font>
<font></font>
<span class=c>// Stub stubs creditcard.Service and provides no behavior of its own.</span>
<span class=k>type</span> <span class=n>Stub</span> <span class=k>struct</span><span class=p>{}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>Stub</span><span class=p>)</span> <span class=n>Charge</span><span class=p>(</span><span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=k>return</span> <span class=no>nil</span> <span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이는 기본 패키지 이름과 해당 도메인 유형이 무엇 </font><font style=vertical-align:inherit>인지 암시하기 때문에 </font></font><code class="language-plaintext highlighter-rouge">StubService</code><font style=vertical-align:inherit><font style=vertical-align:inherit>또는 매우 열악한 </font><font style=vertical-align:inherit>과 같은 명명 선택보다 엄격하게 바람직합니다 .</font></font><code class="language-plaintext highlighter-rouge">StubCreditCardService</code><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">creditcardtest.Stub</code><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>마지막으로 패키지가 Bazel로 빌드된 경우 </font></font><code class="language-plaintext highlighter-rouge">go_library</code><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지의 새 규칙이 다음과 같이 표시되어 있는지 확인하세요 </font></font><code class="language-plaintext highlighter-rouge">testonly</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<pre><code class=language-build># Good:<font></font>
go_library(<font></font>
    name = "creditcardtest",<font></font>
    srcs = ["creditcardtest.go"],<font></font>
    deps = [<font></font>
        ":creditcard",<font></font>
        ":money",<font></font>
    ],<font></font>
    testonly = True,<font></font>
)<font></font>
</code></pre>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>위의 접근 방식은 일반적이며 다른 엔지니어도 합리적으로 잘 이해할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #42: 테스트용 스텁 작성</font></font></a></li>
</ul>
<p><a id=naming-doubles-multiple-behaviors></a></p>
<h4 id=multiple-test-double-behaviors><font style=vertical-align:inherit><font style=vertical-align:inherit>다중 테스트 이중 동작</font></font><a class=anchorjs-link href=#multiple-test-double-behaviors aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>한 종류의 스텁으로는 충분하지 않은 경우(예를 들어 항상 실패하는 스텁도 필요한 경우) 에뮬레이트하는 동작에 따라 스텁의 이름을 지정하는 것이 좋습니다. 여기서는 </font><font style=vertical-align:inherit>다음과 같은 새 스텁의 이름을 바꾸고 소개
 </font></font><code class="language-plaintext highlighter-rouge">Stub</code><font style=vertical-align:inherit><font style=vertical-align:inherit>합니다 </font><font style=vertical-align:inherit>.</font></font><code class="language-plaintext highlighter-rouge">AlwaysCharges</code><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">AlwaysDeclines</code><font style=vertical-align:inherit></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// AlwaysCharges stubs creditcard.Service and simulates success.</span>
<span class=k>type</span> <span class=n>AlwaysCharges</span> <span class=k>struct</span><span class=p>{}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>AlwaysCharges</span><span class=p>)</span> <span class=n>Charge</span><span class=p>(</span><span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=k>return</span> <span class=no>nil</span> <span class=p>}</span><font></font>
<font></font>
<span class=c>// AlwaysDeclines stubs creditcard.Service and simulates declined charges.</span>
<span class=k>type</span> <span class=n>AlwaysDeclines</span> <span class=k>struct</span><span class=p>{}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>AlwaysDeclines</span><span class=p>)</span> <span class=n>Charge</span><span class=p>(</span><span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>creditcard</span><span class=o>.</span><span class=n>ErrDeclined</span>
<span class=p>}</span>
</code></pre></div></div>
<p><a id=naming-doubles-multiple-types></a></p>
<h4 id=multiple-doubles-for-multiple-types><font style=vertical-align:inherit><font style=vertical-align:inherit>여러 유형에 대한 다중 복식</font></font><a class=anchorjs-link href=#multiple-doubles-for-multiple-types aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 이제 </font></font><code class="language-plaintext highlighter-rouge">package creditcard</code><font style=vertical-align:inherit><font style=vertical-align:inherit>아래에서 </font></font><code class="language-plaintext highlighter-rouge">Service</code><font style=vertical-align:inherit><font style=vertical-align:inherit>및 와 같이 double을 생성할 가치가 있는 여러 유형이 포함되어 있다고 가정합니다 </font></font><code class="language-plaintext highlighter-rouge">StoredValue</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>package</span> <span class=n>creditcard</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>Service</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=c>// omitted</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>Card</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=c>// omitted</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// StoredValue manages customer credit balances.  This applies when returned</span>
<span class=c>// merchandise is credited to a customer's local account instead of processed</span>
<span class=c>// by the credit issuer.  For this reason, it is implemented as a separate</span>
<span class=c>// service.</span>
<span class=k>type</span> <span class=n>StoredValue</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=c>// omitted</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>s</span> <span class=o>*</span><span class=n>StoredValue</span><span class=p>)</span> <span class=n>Credit</span><span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Card</span><span class=p>,</span> <span class=n>amount</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=c>/* omitted */</span> <span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 경우에는 보다 명시적인 테스트 이중 이름을 지정하는 것이 합리적입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>type</span> <span class=n>StubService</span> <span class=k>struct</span><span class=p>{}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>StubService</span><span class=p>)</span> <span class=n>Charge</span><span class=p>(</span><span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=k>return</span> <span class=no>nil</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>StubStoredValue</span> <span class=k>struct</span><span class=p>{}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>StubStoredValue</span><span class=p>)</span> <span class=n>Credit</span><span class=p>(</span><span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=k>return</span> <span class=no>nil</span> <span class=p>}</span>
</code></pre></div></div>
<p><a id=naming-doubles-local-variables></a></p>
<h4 id=local-variables-in-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트의 지역 변수</font></font><a class=anchorjs-link href=#local-variables-in-tests aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트에서 변수가 복식을 참조하는 경우 상황에 따라 복식을 다른 생산 유형과 가장 명확하게 구별하는 이름을 선택하십시오. 테스트하려는 일부 프로덕션 코드를 고려하십시오.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>package</span> <span class=n>payment</span><font></font>
<font></font>
<span class=k>import</span> <span class=p>(</span>
    <span class=s>"path/to/creditcard"</span>
    <span class=s>"path/to/money"</span>
<span class=p>)</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>CreditCard</span> <span class=k>interface</span> <span class=p>{</span>
    <span class=n>Charge</span><span class=p>(</span><span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>Processor</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=n>CC</span> <span class=n>CreditCard</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>var</span> <span class=n>ErrBadInstrument</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>New</span><span class=p>(</span><span class=s>"payment: instrument is invalid or expired"</span><span class=p>)</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>p</span> <span class=o>*</span><span class=n>Processor</span><span class=p>)</span> <span class=n>Process</span><span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>creditcard</span><span class=o>.</span><span class=n>Card</span><span class=p>,</span> <span class=n>amount</span> <span class=n>money</span><span class=o>.</span><span class=n>Money</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=k>if</span> <span class=n>c</span><span class=o>.</span><span class=n>Expired</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>ErrBadInstrument</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=n>p</span><span class=o>.</span><span class=n>CC</span><span class=o>.</span><span class=n>Charge</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>amount</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트에서는 "spy" for라는 테스트 더블이 </font></font><code class="language-plaintext highlighter-rouge">CreditCard</code><font style=vertical-align:inherit><font style=vertical-align:inherit>프로덕션 유형과 병치되므로 이름 앞에 접두사를 붙이면 명확성이 향상될 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>payment</span><font></font>
<font></font>
<span class=k>import</span> <span class=s>"path/to/creditcardtest"</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestProcessor</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>var</span> <span class=n>spyCC</span> <span class=n>creditcardtest</span><span class=o>.</span><span class=n>Spy</span><font></font>
<font></font>
    <span class=n>proc</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=n>Processor</span><span class=p>{</span><span class=n>CC</span><span class=o>:</span> <span class=n>spyCC</span><span class=p>}</span><font></font>
<font></font>
    <span class=c>// declarations omitted: card and amount</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>proc</span><span class=o>.</span><span class=n>Process</span><span class=p>(</span><span class=n>card</span><span class=p>,</span> <span class=n>amount</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"proc.Process(card, amount) = %v, want %v"</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span><font></font>
<font></font>
    <span class=n>charges</span> <span class=o>:=</span> <span class=p>[]</span><span class=n>creditcardtest</span><span class=o>.</span><span class=n>Charge</span><span class=p>{</span>
        <span class=p>{</span><span class=n>Card</span><span class=o>:</span> <span class=n>card</span><span class=p>,</span> <span class=n>Amount</span><span class=o>:</span> <span class=n>amount</span><span class=p>},</span>
    <span class=p>}</span><font></font>
<font></font>
    <span class=k>if</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span> <span class=o>:=</span> <span class=n>spyCC</span><span class=o>.</span><span class=n>Charges</span><span class=p>,</span> <span class=n>charges</span><span class=p>;</span> <span class=o>!</span><span class=n>cmp</span><span class=o>.</span><span class=n>Equal</span><span class=p>(</span><span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"spyCC.Charges = %v, want %v"</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이는 이름 앞에 접두사가 붙지 않은 경우보다 더 명확합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>payment</span><font></font>
<font></font>
<span class=k>import</span> <span class=s>"path/to/creditcardtest"</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestProcessor</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>var</span> <span class=n>cc</span> <span class=n>creditcardtest</span><span class=o>.</span><span class=n>Spy</span><font></font>
<font></font>
    <span class=n>proc</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=n>Processor</span><span class=p>{</span><span class=n>CC</span><span class=o>:</span> <span class=n>cc</span><span class=p>}</span><font></font>
<font></font>
    <span class=c>// declarations omitted: card and amount</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>proc</span><span class=o>.</span><span class=n>Process</span><span class=p>(</span><span class=n>card</span><span class=p>,</span> <span class=n>amount</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"proc.Process(card, amount) = %v, want %v"</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span><font></font>
<font></font>
    <span class=n>charges</span> <span class=o>:=</span> <span class=p>[]</span><span class=n>creditcardtest</span><span class=o>.</span><span class=n>Charge</span><span class=p>{</span>
        <span class=p>{</span><span class=n>Card</span><span class=o>:</span> <span class=n>card</span><span class=p>,</span> <span class=n>Amount</span><span class=o>:</span> <span class=n>amount</span><span class=p>},</span>
    <span class=p>}</span><font></font>
<font></font>
    <span class=k>if</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span> <span class=o>:=</span> <span class=n>cc</span><span class=o>.</span><span class=n>Charges</span><span class=p>,</span> <span class=n>charges</span><span class=p>;</span> <span class=o>!</span><span class=n>cmp</span><span class=o>.</span><span class=n>Equal</span><span class=p>(</span><span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"cc.Charges = %v, want %v"</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><a id=shadowing></a></p>
<h3 id=shadowing><font style=vertical-align:inherit><font style=vertical-align:inherit>섀도잉</font></font><a class=anchorjs-link href=#shadowing aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 설명에서는 </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>스토핑(stomping)</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 및 </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>섀도잉(shadowing)</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 이라는 두 가지 비공식 용어를 사용합니다 . Go 언어 사양의 공식 개념은 아닙니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>많은 프로그래밍 언어와 마찬가지로 Go에는 가변 변수가 있습니다. 변수에 할당하면 값이 변경됩니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>abs</span><span class=p>(</span><span class=n>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
    <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=m>0</span> <span class=p>{</span>
        <span class=n>i</span> <span class=o>*=</span> <span class=o>-</span><span class=m>1</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=n>i</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>연산자 와 함께 </font></font><a href=https://go.dev/ref/spec#Short_variable_declarations><font style=vertical-align:inherit><font style=vertical-align:inherit>짧은 변수 선언을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용할 때 </font></font><code class="language-plaintext highlighter-rouge">:=</code><font style=vertical-align:inherit><font style=vertical-align:inherit>경우에 따라 새 변수가 생성되지 않습니다. 우리는 이것을 </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>쿵쾅쿵쾅</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 이라고 부를 수 있습니다 </font><font style=vertical-align:inherit>. 원래 값이 더 이상 필요하지 않을 때 이렇게 해도 괜찮습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// innerHandler is a helper for some request handler, which itself issues</span>
<span class=c>// requests to other backends.</span>
<span class=k>func</span> <span class=p>(</span><span class=n>s</span> <span class=o>*</span><span class=n>Server</span><span class=p>)</span> <span class=n>innerHandler</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>req</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>MyRequest</span><span class=p>)</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>MyResponse</span> <span class=p>{</span>
    <span class=c>// Unconditionally cap the deadline for this part of request handling.</span>
    <span class=n>ctx</span><span class=p>,</span> <span class=n>cancel</span> <span class=o>:=</span> <span class=n>context</span><span class=o>.</span><span class=n>WithTimeout</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=m>3</span><span class=o>*</span><span class=n>time</span><span class=o>.</span><span class=n>Second</span><span class=p>)</span>
    <span class=k>defer</span> <span class=n>cancel</span><span class=p>()</span>
    <span class=n>ctxlog</span><span class=o>.</span><span class=n>Info</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>"Capped deadline in inner request"</span><span class=p>)</span><font></font>
<font></font>
    <span class=c>// Code here no longer has access to the original context.</span>
    <span class=c>// This is good style if when first writing this, you anticipate</span>
    <span class=c>// that even as the code grows, no operation legitimately should</span>
    <span class=c>// use the (possibly unbounded) original context that the caller provided.</span><font></font>
<font></font>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>하지만 새 범위에서 짧은 변수 선언을 사용할 때는 주의하세요. 그러면 새 변수가 발생하게 됩니다. 이것을 </font><font style=vertical-align:inherit>원래 변수 </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>의 그림자</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 라고 부를 수 있습니다 . </font><font style=vertical-align:inherit>블록 끝 뒤의 코드는 원본을 나타냅니다. 조건부로 기한을 단축하려는 버그가 있는 시도는 다음과 같습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>s</span> <span class=o>*</span><span class=n>Server</span><span class=p>)</span> <span class=n>innerHandler</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>req</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>MyRequest</span><span class=p>)</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>MyResponse</span> <span class=p>{</span>
    <span class=c>// Attempt to conditionally cap the deadline.</span>
    <span class=k>if</span> <span class=o>*</span><span class=n>shortenDeadlines</span> <span class=p>{</span>
        <span class=n>ctx</span><span class=p>,</span> <span class=n>cancel</span> <span class=o>:=</span> <span class=n>context</span><span class=o>.</span><span class=n>WithTimeout</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=m>3</span><span class=o>*</span><span class=n>time</span><span class=o>.</span><span class=n>Second</span><span class=p>)</span>
        <span class=k>defer</span> <span class=n>cancel</span><span class=p>()</span>
        <span class=n>ctxlog</span><span class=o>.</span><span class=n>Info</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>"Capped deadline in inner request"</span><span class=p>)</span>
    <span class=p>}</span><font></font>
<font></font>
    <span class=c>// BUG: "ctx" here again means the context that the caller provided.</span>
    <span class=c>// The above buggy code compiled because both ctx and cancel</span>
    <span class=c>// were used inside the if statement.</span><font></font>
<font></font>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>올바른 버전의 코드는 다음과 같습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>s</span> <span class=o>*</span><span class=n>Server</span><span class=p>)</span> <span class=n>innerHandler</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>req</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>MyRequest</span><span class=p>)</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>MyResponse</span> <span class=p>{</span>
    <span class=k>if</span> <span class=o>*</span><span class=n>shortenDeadlines</span> <span class=p>{</span>
        <span class=k>var</span> <span class=n>cancel</span> <span class=k>func</span><span class=p>()</span>
        <span class=c>// Note the use of simple assignment, = and not :=.</span>
        <span class=n>ctx</span><span class=p>,</span> <span class=n>cancel</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>WithTimeout</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=m>3</span><span class=o>*</span><span class=n>time</span><span class=o>.</span><span class=n>Second</span><span class=p>)</span>
        <span class=k>defer</span> <span class=n>cancel</span><span class=p>()</span>
        <span class=n>ctxlog</span><span class=o>.</span><span class=n>Info</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>"Capped deadline in inner request"</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>stomping을 호출한 경우에는 새 변수가 없기 때문에 할당되는 유형이 원래 변수의 유형과 일치해야 합니다. 섀도잉을 사용하면 완전히 새로운 엔터티가 도입되어 다른 유형을 가질 수 있습니다. 의도적인 섀도잉은 유용한 방법이 될 수 있지만 </font></font><a href=https://google.github.io/styleguide/go/guide#clarity><font style=vertical-align:inherit><font style=vertical-align:inherit>명확성</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 향상된다면 언제든지 새 이름을 사용할 수 있습니다
 </font><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>매우 작은 범위가 아닌 표준 패키지와 동일한 이름을 가진 변수를 사용하는 것은 좋지 않습니다. 그렇게 하면 해당 패키지의 무료 함수와 값에 액세스할 수 없게 되기 때문입니다. 반대로, 패키지 이름을 선택할 때 가져오기 이름
 </font></font><a href=https://google.github.io/styleguide/go/decisions#import-renaming><font style=vertical-align:inherit><font style=vertical-align:inherit>변경이</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 필요 하거나 클라이언트 측에서 좋은 변수 이름이 섀도잉될 가능성이 있는 이름은 피하세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>LongFunction</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>url</span> <span class=o>:=</span> <span class=s>"https://example.com/"</span>
    <span class=c>// Oops, now we can't use net/url in code below.</span>
<span class=p>}</span>
</code></pre></div></div>
<p><a id=util-packages></a></p>
<h3 id=util-packages><font style=vertical-align:inherit><font style=vertical-align:inherit>유틸리티 패키지</font></font><a class=anchorjs-link href=#util-packages aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">package</code><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 패키지에는 가져오기 경로와 별도로 선언 </font><font style=vertical-align:inherit>에 지정된 이름이 있습니다 . </font><font style=vertical-align:inherit>패키지 이름은 경로보다 가독성에 더 중요합니다.</font></font></p>
<p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#package-names><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 패키지 이름은 패키지가 제공하는 것과 관련이</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 있어야 합니다
 </font><font style=vertical-align:inherit>. 패키지 이름을 </font></font><code class="language-plaintext highlighter-rouge">util</code><font style=vertical-align:inherit><font style=vertical-align:inherit>, </font></font><code class="language-plaintext highlighter-rouge">helper</code><font style=vertical-align:inherit><font style=vertical-align:inherit>또는 이와 유사한 이름으로 지정하는 것은 일반적으로 좋지 않은 선택입니다( </font><font style=vertical-align:inherit>그러나 이름의 </font><em><font style=vertical-align:inherit>일부로</font></em></font><code class="language-plaintext highlighter-rouge">common</code><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용할 수 있음 ). </font><font style=vertical-align:inherit>정보가 없는 이름은 코드를 읽기 어렵게 만들고, 너무 광범위하게 사용하면 불필요한
 </font><a href=https://google.github.io/styleguide/go/decisions#import-renaming><font style=vertical-align:inherit>가져오기 충돌이</font></a><font style=vertical-align:inherit> 발생할 수 있습니다 .</font></font><em><font style=vertical-align:inherit></font></em><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#import-renaming><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>대신, 호출 사이트의 모양을 고려하십시오.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>db</span> <span class=o>:=</span> <span class=n>spannertest</span><span class=o>.</span><span class=n>NewDatabaseFromFile</span><span class=p>(</span><span class=o>...</span><span class=p>)</span><font></font>
<font></font>
<span class=n>_</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>f</span><span class=o>.</span><span class=n>Seek</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>io</span><span class=o>.</span><span class=n>SeekStart</span><span class=p>)</span><font></font>
<font></font>
<span class=n>b</span> <span class=o>:=</span> <span class=n>elliptic</span><span class=o>.</span><span class=n>Marshal</span><span class=p>(</span><span class=n>curve</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">cloud.google.com/go/spanner/spannertest</code><font style=vertical-align:inherit><font style=vertical-align:inherit>가져오기 목록( , </font></font><code class="language-plaintext highlighter-rouge">io</code><font style=vertical-align:inherit><font style=vertical-align:inherit>및 ) </font><font style=vertical-align:inherit>을 모르더라도 이들 각각이 수행하는 작업을 대략적으로 알 수 있습니다 </font></font><code class="language-plaintext highlighter-rouge">crypto/elliptic</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 덜 집중된 이름을 사용하면 다음과 같이 읽을 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=n>db</span> <span class=o>:=</span> <span class=n>test</span><span class=o>.</span><span class=n>NewDatabaseFromFile</span><span class=p>(</span><span class=o>...</span><span class=p>)</span><font></font>
<font></font>
<span class=n>_</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>f</span><span class=o>.</span><span class=n>Seek</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>common</span><span class=o>.</span><span class=n>SeekStart</span><span class=p>)</span><font></font>
<font></font>
<span class=n>b</span> <span class=o>:=</span> <span class=n>helper</span><span class=o>.</span><span class=n>Marshal</span><span class=p>(</span><span class=n>curve</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</code></pre></div></div>
<p><a id=package-size></a></p>
<h2 id=package-size><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 크기</font></font><a class=anchorjs-link href=#package-size aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 패키지가 얼마나 커야 하는지, 관련 유형을 동일한 패키지에 배치할지 아니면 다른 패키지로 분할할지 자문하고 있다면 </font></font><a href=https://go.dev/blog/package-names><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 이름에 대한 Go 블로그 게시물에서</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 시작하는 것이 좋습니다 . 게시물 제목에도 불구하고 이름만 지정하는 것이 아닙니다. 여기에는 몇 가지 유용한 힌트가 포함되어 있으며 몇 가지 유용한 기사와 강연이 인용되어 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음은 몇 가지 다른 고려 사항과 참고 사항입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자는 </font><font style=vertical-align:inherit>한 페이지에서 패키지에 대한 </font></font><a href=https://pkg.go.dev/><font style=vertical-align:inherit><font style=vertical-align:inherit>godoc를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 볼 수 있으며 패키지에서 제공하는 유형별로 내보낸 모든 메소드는 해당 유형별로 그룹화됩니다. Godoc은 또한 반환되는 유형과 함께 생성자를 그룹화합니다. </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>클라이언트 코드가</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 서로 상호 작용하기 위해 서로 다른 유형의 두 값이 필요한 </font><font style=vertical-align:inherit>경우 사용자는 해당 값을 동일한 패키지에 두는 것이 편리할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 내의 코드는 패키지에서 내보내지지 않은 식별자에 액세스할 수 있습니다. </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>구현이</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 밀접하게 결합 된 몇 가지 관련 유형이 있는 경우 </font><font style=vertical-align:inherit>동일한 패키지에 배치하면 이러한 세부 정보로 공용 API를 오염시키지 않고 이러한 결합을 달성할 수 있습니다. 이 결합에 대한 좋은 테스트는 패키지가 밀접하게 관련된 주제를 다루는 두 패키지의 가상 사용자를 상상하는 것입니다. 사용자가 의미 있는 방식으로 사용하기 위해 두 패키지를 모두 가져와야 하는 경우 두 패키지를 함께 결합하는 것이 일반적으로 올바른 것입니다. 하다. 표준 라이브러리는 일반적으로 이러한 종류의 범위 지정 및 계층화를 잘 보여줍니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>즉, 전체 프로젝트를 단일 패키지에 넣으면 해당 패키지가 너무 커질 수 있습니다. 어떤 것이 개념적으로 구별되는 경우, 자체적인 작은 패키지를 제공하면 사용하기가 더 쉬워질 수 있습니다. 클라이언트에 알려진 패키지의 짧은 이름과 내보낸 유형 이름이 함께 작동하여 의미 있는 식별자를 만듭니다. 예: </font></font><code class="language-plaintext highlighter-rouge">bytes.Buffer</code><font style=vertical-align:inherit><font style=vertical-align:inherit>, </font></font><code class="language-plaintext highlighter-rouge">ring.New</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 블로그
 </font></font><a href=https://go.dev/blog/package-names><font style=vertical-align:inherit><font style=vertical-align:inherit>게시물에는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 더 많은 예제가 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 스타일은 파일 크기에 대해 유연합니다. 관리자가 호출자에게 영향을 주지 않고 패키지 내의 코드를 한 파일에서 다른 파일로 이동할 수 있기 때문입니다. 그러나 일반적인 지침에 따르면, 수천 줄의 줄이 포함된 단일 파일이나 작은 파일이 많이 있는 것은 일반적으로 좋은 생각이 아닙니다. 다른 언어에서는 "하나의 유형, 하나의 파일" 규칙이 없습니다. 경험상 파일은 관리자가 어떤 파일에 어떤 내용이 포함되어 있는지 알 수 있을 만큼 집중되어야 하며 파일은 일단 쉽게 찾을 수 있을 만큼 작아야 합니다. 표준 라이브러리는 대용량 패키지를 여러 소스 파일로 분할하여 관련 코드를 파일별로 그룹화하는 경우가 많습니다. </font></font><a href=https://go.dev/src/bytes/><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지</font></font><code class="language-plaintext highlighter-rouge">bytes</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 소스가 </font><font style=vertical-align:inherit>좋은 예입니다. 긴 패키지 문서가 포함된 패키지는 </font><a href=https://google.github.io/styleguide/go/decisions#package-comments><font style=vertical-align:inherit>패키지 문서</font></a></font><code class="language-plaintext highlighter-rouge">doc.go</code><font style=vertical-align:inherit><font style=vertical-align:inherit> , 패키지 선언 및 기타 항목 이 포함된 </font><font style=vertical-align:inherit>하나의 파일을 전용으로 선택할 수 있지만
 </font><font style=vertical-align:inherit>필수는 아닙니다.</font></font><a href=https://google.github.io/styleguide/go/decisions#package-comments><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Google 코드베이스와 Bazel을 사용하는 프로젝트 내에서 Go 코드의 디렉터리 레이아웃은 오픈 소스 Go 프로젝트의 디렉터리 레이아웃과 다릅니다.
 </font></font><code class="language-plaintext highlighter-rouge">go_library</code><font style=vertical-align:inherit><font style=vertical-align:inherit>단일 디렉터리에 여러 대상이 있을 수 있습니다. 각 패키지에 자체 디렉토리를 제공하는 좋은 이유는 향후 프로젝트를 오픈 소스로 예상하는 경우입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=#naming-doubles><font style=vertical-align:inherit><font style=vertical-align:inherit>더블 패키지 테스트</font></font></a></li>
</ul>
<p><a id=imports></a></p>
<h2 id=imports><font style=vertical-align:inherit><font style=vertical-align:inherit>수입품</font></font><a class=anchorjs-link href=#imports aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><a id=import-protos></a></p>
<h3 id=protos-and-stubs><font style=vertical-align:inherit><font style=vertical-align:inherit>프로토스와 스텁</font></font><a class=anchorjs-link href=#protos-and-stubs aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Proto 라이브러리 가져오기는 언어 간 특성으로 인해 표준 Go 가져오기와 다르게 처리됩니다. 이름이 변경된 proto 가져오기에 대한 규칙은 패키지를 생성한 규칙을 기반으로 합니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>접미사 </font></font><code class="language-plaintext highlighter-rouge">pb</code><font style=vertical-align:inherit><font style=vertical-align:inherit>는 일반적으로 규칙에 사용됩니다 </font></font><code class="language-plaintext highlighter-rouge">go_proto_library</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>접미사 </font></font><code class="language-plaintext highlighter-rouge">grpc</code><font style=vertical-align:inherit><font style=vertical-align:inherit>는 일반적으로 규칙에 사용됩니다 </font></font><code class="language-plaintext highlighter-rouge">go_grpc_library</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적으로 다음과 같이 짧은 한 글자 또는 두 글자로 된 접두사가 사용됩니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>import</span> <span class=p>(</span>
    <span class=n>fspb</span> <span class=s>"path/to/package/foo_service_go_proto"</span>
    <span class=n>fsgrpc</span> <span class=s>"path/to/package/foo_service_go_grpc"</span>
<span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지에서 사용되는 proto가 하나만 있거나 패키지가 해당 proto와 밀접하게 연결되어 있는 경우 접두사를 생략할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가져오기( pb "경로/to/패키지/foo_service_go_proto" grpc "경로/to/패키지/foo_service_go_grpc")</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>proto의 기호가 일반적이거나 자체 설명이 충분하지 않은 경우 또는 약어로 패키지 이름을 줄이는 것이 불분명한 경우 짧은 단어를 접두사로 충분할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>import</span> <span class=p>(</span>
    <span class=n>mapspb</span> <span class=s>"path/to/package/maps_go_proto"</span>
<span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 경우 </font><font style=vertical-align:inherit>문제의 코드가 아직 지도와 명확하게 관련되어 있지 않은 경우 </font></font><code class="language-plaintext highlighter-rouge">mapspb.Address</code><font style=vertical-align:inherit><font style=vertical-align:inherit>보다 더 명확할 수 있습니다 .</font></font><code class="language-plaintext highlighter-rouge">mpb.Address</code><font style=vertical-align:inherit></font></p>
<p><a id=import-order></a></p>
<h3 id=import-ordering><font style=vertical-align:inherit><font style=vertical-align:inherit>수입주문</font></font><a class=anchorjs-link href=#import-ordering aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적으로 수입은 다음 두 개(또는 그 이상)의 블록으로 그룹화됩니다.</font></font></p>
<ol>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>표준 라이브러리 가져오기(예: </font></font><code class="language-plaintext highlighter-rouge">"fmt"</code><font style=vertical-align:inherit><font style=vertical-align:inherit>)</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>가져오기(예: "/path/to/somelib")</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>(선택사항) Protobuf 가져오기(예: </font></font><code class="language-plaintext highlighter-rouge">fpb "path/to/foo_go_proto"</code><font style=vertical-align:inherit><font style=vertical-align:inherit>)</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>(선택사항) 부작용 가져오기(예: </font></font><code class="language-plaintext highlighter-rouge">_ "path/to/package"</code><font style=vertical-align:inherit><font style=vertical-align:inherit>)</font></font></li>
</ol>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>파일에 위의 선택적 카테고리 중 하나에 대한 그룹이 없으면 관련 가져오기가 프로젝트 가져오기 그룹에 포함됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적으로 명확하고 이해하기 쉬운 가져오기 그룹화는 괜찮습니다. 예를 들어 팀은 protobuf 가져오기와 별도로 gRPC 가져오기를 그룹화하도록 선택할 수 있습니다.</font></font></p>
<blockquote>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 두 개의 필수 그룹(표준 라이브러리용 그룹 하나, 기타 모든 가져오기용 그룹)만 유지 관리하는 코드의 경우 도구 </font></font><code class="language-plaintext highlighter-rouge">goimports</code><font style=vertical-align:inherit><font style=vertical-align:inherit>는 이 지침과 일치하는 출력을 생성합니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 </font></font><code class="language-plaintext highlighter-rouge">goimports</code><font style=vertical-align:inherit><font style=vertical-align:inherit>필수 그룹 이외의 그룹에 대해서는 지식이 없습니다. 선택적 그룹은 도구에 의해 무효화되기 쉽습니다. 선택적 그룹을 사용하는 경우 그룹화가 규정을 준수하도록 작성자와 검토자 모두의 주의가 필요합니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>어느 접근 방식이든 괜찮지만 imports 섹션을 일관되지 않고 부분적으로 그룹화된 상태로 두지 마십시오.</font></font></p>
</blockquote>
<p><a id=error-handling></a></p>
<h2 id=error-handling><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 처리</font></font><a class=anchorjs-link href=#error-handling aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go에서 </font></font><a href=https://go.dev/blog/errors-are-values><font style=vertical-align:inherit><font style=vertical-align:inherit>오류는 값입니다</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> . 코드에 의해 생성되고 코드에 의해 소비됩니다. 오류는 다음과 같습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>인간에게 표시하기 위한 진단 정보로 변환</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>관리자가 사용함</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>최종 사용자가 해석함</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 메시지는 로그 메시지, 오류 덤프, 렌더링된 UI를 포함한 다양한 표면에도 표시됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>오류를 처리(생성 또는 소비)하는 코드는 의도적으로 그렇게 해야 합니다. 오류 반환 값을 무시하거나 맹목적으로 전파하고 싶을 수 있습니다. 그러나 호출 프레임의 현재 함수가 오류를 가장 효과적으로 처리할 수 있도록 배치되었는지 항상 고려해 볼 가치가 있습니다. 이것은 광범위한 주제이며 범주별 조언을 제공하기 어렵습니다. 판단을 내리되 다음 사항을 염두에 두십시오.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 값을 생성할 때 여기에
 </font></font><a href=#error-structure><font style=vertical-align:inherit><font style=vertical-align:inherit>구조를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 부여할지 여부를 결정합니다 .</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>오류를 처리할 때 </font><font style=vertical-align:inherit>
자신은 가지고 있지만 발신자 및/또는 수신자는 갖고 있지 않을 수 있는 </font></font><a href=#error-extra-info><font style=vertical-align:inherit><font style=vertical-align:inherit>정보를 추가하는 것을 고려하세요.</font></font></a><font style=vertical-align:inherit></font></li>
 <li><font style=vertical-align:inherit></font><a href=#error-logging><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 로깅</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 대한 지침도 참조하세요 </font><font style=vertical-align:inherit>.</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적으로 오류를 무시하는 것은 적절하지 않지만 관련 작업을 조정하는 경우에는 이에 대한 합리적인 예외가 있으며, 여기서는 첫 번째 오류만 유용한 경우가 많습니다. 패키지는 </font></font><a href=https://pkg.go.dev/golang.org/x/sync/errgroup><code class="language-plaintext highlighter-rouge">errgroup</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>모두 실패하거나 그룹으로 취소될 수 있는 작업 그룹에 대한 편리한 추상화를 제공합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://go.dev/doc/effective_go#errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 발생 시 효과적인 이동</font></font></a></li>
 <li><a href=https://go.dev/blog/go1.13-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류에 대한 Go Blog의 게시물</font></font></a></li>
 <li><a href=https://pkg.go.dev/errors><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지</font></font><code class="language-plaintext highlighter-rouge">errors</code></a></li>
 <li><a href=https://commandcenter.blogspot.com/2017/12/error-handling-in-upspin.html><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지</font></font><code class="language-plaintext highlighter-rouge">upspin.io/errors</code></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #89: 정식 상태 코드를 오류로 사용해야 하는 경우</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #48: 센티넬 값 오류</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #13: 검사를 위한 오류 설계</font></font></a></li>
</ul>
<p><a id=error-structure></a></p>
<h3 id=error-structure><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 구조</font></font><a class=anchorjs-link href=#error-structure aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자가 오류를 조사해야 하는 경우(예: 서로 다른 오류 조건 구별) 오류 값 구조를 제공하여 호출자가 문자열 일치를 수행하도록 하는 대신 프로그래밍 방식으로 이를 수행할 수 있습니다. 이 조언은 프로덕션 코드뿐만 아니라 다양한 오류 조건을 고려하는 테스트에도 적용됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가장 단순한 구조적 오류는 매개변수화되지 않은 전역 값입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>type</span> <span class=n>Animal</span> <span class=kt>string</span><font></font>
<font></font>
<span class=k>var</span> <span class=p>(</span>
    <span class=c>// ErrDuplicate occurs if this animal has already been seen.</span>
    <span class=n>ErrDuplicate</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>New</span><span class=p>(</span><span class=s>"duplicate"</span><span class=p>)</span><font></font>
<font></font>
    <span class=c>// ErrMarsupial occurs because we're allergic to marsupials outside Australia.</span>
    <span class=c>// Sorry.</span>
    <span class=n>ErrMarsupial</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>New</span><span class=p>(</span><span class=s>"marsupials are not supported"</span><span class=p>)</span>
<span class=p>)</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>process</span><span class=p>(</span><span class=n>animal</span> <span class=n>Animal</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=k>switch</span> <span class=p>{</span>
    <span class=k>case</span> <span class=n>seen</span><span class=p>[</span><span class=n>animal</span><span class=p>]</span><span class=o>:</span>
        <span class=k>return</span> <span class=n>ErrDuplicate</span>
    <span class=k>case</span> <span class=n>marsupial</span><span class=p>(</span><span class=n>animal</span><span class=p>)</span><span class=o>:</span>
        <span class=k>return</span> <span class=n>ErrMarsupial</span>
    <span class=p>}</span>
    <span class=n>seen</span><span class=p>[</span><span class=n>animal</span><span class=p>]</span> <span class=o>=</span> <span class=no>true</span>
    <span class=c>// ...</span>
    <span class=k>return</span> <span class=no>nil</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자는 함수의 반환된 오류 값을 알려진 오류 값 중 하나와 간단히 비교할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>handlePet</span><span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>switch</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>process</span><span class=p>(</span><span class=n>an</span><span class=p>);</span> <span class=n>err</span> <span class=p>{</span>
    <span class=k>case</span> <span class=n>ErrDuplicate</span><span class=o>:</span>
        <span class=k>return</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"feed %q: %v"</span><span class=p>,</span> <span class=n>an</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=k>case</span> <span class=n>ErrMarsupial</span><span class=o>:</span>
        <span class=c>// Try to recover with a friend instead.</span>
        <span class=n>alternate</span> <span class=o>=</span> <span class=n>an</span><span class=o>.</span><span class=n>BackupAnimal</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>handlePet</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>alternate</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">==</code><font style=vertical-align:inherit><font style=vertical-align:inherit>위에서는 센티널 값을 사용합니다. 여기서 오류는 예상 값과 </font><font style=vertical-align:inherit>같아야 합니다(의 의미에서
 ). </font><font style=vertical-align:inherit>이는 많은 경우에 완벽하게 적합합니다. 래핑된 오류를 반환 </font><font style=vertical-align:inherit>하는 경우
 </font></font><code class="language-plaintext highlighter-rouge">process</code><font style=vertical-align:inherit><font style=vertical-align:inherit>(아래 설명) 를 사용할 수 있습니다 </font></font><a href=https://pkg.go.dev/errors#Is><code class="language-plaintext highlighter-rouge">errors.Is</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>handlePet</span><span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>switch</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>process</span><span class=p>(</span><span class=n>an</span><span class=p>);</span> <span class=p>{</span>
    <span class=k>case</span> <span class=n>errors</span><span class=o>.</span><span class=n>Is</span><span class=p>(</span><span class=n>err</span><span class=p>,</span> <span class=n>ErrDuplicate</span><span class=p>)</span><span class=o>:</span>
        <span class=k>return</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"feed %q: %v"</span><span class=p>,</span> <span class=n>an</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=k>case</span> <span class=n>errors</span><span class=o>.</span><span class=n>Is</span><span class=p>(</span><span class=n>err</span><span class=p>,</span> <span class=n>ErrMarsupial</span><span class=p>)</span><span class=o>:</span>
        <span class=c>// ...</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>문자열 형식을 기준으로 오류를 구별하려고 시도하지 마십시오. (
 자세한 내용은 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 팁 #13: 검사를 위한 오류 설계를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 
.)</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>handlePet</span><span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>err</span> <span class=o>:=</span> <span class=n>process</span><span class=p>(</span><span class=n>an</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>regexp</span><span class=o>.</span><span class=n>MatchString</span><span class=p>(</span><span class=s>`duplicate`</span><span class=p>,</span> <span class=n>err</span><span class=o>.</span><span class=n>Error</span><span class=p>())</span> <span class=p>{</span><span class=o>...</span><span class=p>}</span>
    <span class=k>if</span> <span class=n>regexp</span><span class=o>.</span><span class=n>MatchString</span><span class=p>(</span><span class=s>`marsupial`</span><span class=p>,</span> <span class=n>err</span><span class=o>.</span><span class=n>Error</span><span class=p>())</span> <span class=p>{</span><span class=o>...</span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자가 프로그래밍 방식으로 필요로 하는 오류에 추가 정보가 있는 경우 이상적으로는 구조적으로 표시되어야 합니다. 예를 들어
 </font></font><a href=https://pkg.go.dev/os#PathError><code class="language-plaintext highlighter-rouge">os.PathError</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자가 쉽게 액세스할 수 있는 구조체 필드에 실패한 작업의 경로 이름을 배치하도록 유형이 문서화되어 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다른 오류 구조도 적절하게 사용할 수 있습니다(예: 오류 코드 및 세부 문자열이 포함된 프로젝트 구조). </font></font><a href=https://pkg.go.dev/google.golang.org/grpc/status><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지</font></font><code class="language-plaintext highlighter-rouge">status</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 는 일반적인 캡슐화입니다. 이 접근 방식을 선택하는 경우(꼭 수행할 의무는 없음) </font></font><a href=https://pkg.go.dev/google.golang.org/grpc/codes><font style=vertical-align:inherit><font style=vertical-align:inherit>표준 코드를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용하세요 . 상태 코드를 </font><font style=vertical-align:inherit>
사용하는 것이 올바른 선택인지 알아보려면 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 팁 #89: 표준 상태 코드를 오류로 사용하는 경우를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요
 .</font></font></p>
<p><a id=error-extra-info></a></p>
<h3 id=adding-information-to-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류에 정보 추가</font></font><a class=anchorjs-link href=#adding-information-to-errors aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>오류를 반환하는 모든 함수는 오류 값을 유용하게 만들기 위해 노력해야 합니다. 종종 함수는 콜체인의 중간에 있고 호출한 다른 함수(아마도 다른 패키지에서도)의 오류를 전파할 뿐입니다. 여기에는 추가 정보로 오류에 주석을 달 수 있는 기회가 있지만 프로그래머는 중복되거나 관련 없는 세부 정보를 추가하지 않고 오류에 충분한 정보가 있는지 확인해야 합니다. 확실하지 않은 경우 개발 중에 오류 조건을 트리거해 보십시오. 이는 오류 관찰자(사람 또는 코드)가 어떤 결과를 얻게 될지 평가하는 좋은 방법입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>컨벤션 및 좋은 문서화에 도움이 됩니다. 예를 들어, 표준 패키지는 </font></font><code class="language-plaintext highlighter-rouge">os</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
사용 가능한 경우 해당 오류에 경로 정보가 포함되어 있음을 광고합니다. 이는 오류를 반환받는 호출자가 이미 실패한 함수를 제공했다는 정보로 주석을 달 필요가 없기 때문에 유용한 스타일입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>Open</span><span class=p>(</span><span class=s>"settings.txt"</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>err</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// Output:</span>
<span class=c>//</span>
<span class=c>// open settings.txt: no such file or directory</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>오류의 의미</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 대해 흥미로운 말이 있다면 </font><font style=vertical-align:inherit>물론 추가할 수 있습니다. 콜체인의 어느 레벨이 이 의미를 이해하는 데 가장 적합한지 고려해 보세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>Open</span><span class=p>(</span><span class=s>"settings.txt"</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=c>// We convey the significance of this error to us. Note that the current</span>
    <span class=c>// function might perform more than one file operation that can fail, so</span>
    <span class=c>// these annotations can also serve to disambiguate to the caller what went</span>
    <span class=c>// wrong.</span>
    <span class=k>return</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"launch codes unavailable: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// Output:</span>
<span class=c>//</span>
<span class=c>// launch codes unavailable: open settings.txt: no such file or directory</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>여기서 중복된 정보와 대조해 보세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>Open</span><span class=p>(</span><span class=s>"settings.txt"</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"could not open settings.txt: %w"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// Output:</span>
<span class=c>//</span>
<span class=c>// could not open settings.txt: open settings.txt: no such file or directory</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>전파된 오류에 정보를 추가할 때 오류를 래핑하거나 새로운 오류를 표시할 수 있습니다. 오류를 </font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>in 동사 로 래핑하면 </font></font><code class="language-plaintext highlighter-rouge">fmt.Errorf</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
호출자가 원래 오류의 데이터에 액세스할 수 있습니다. 이는 때때로 매우 유용할 수 있지만 다른 경우에는 이러한 세부 정보가 발신자에게 오해의 소지가 있거나 흥미롭지 않습니다. </font><font style=vertical-align:inherit>자세한 내용은 </font></font><a href=https://blog.golang.org/go1.13-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 래핑에 대한 블로그 게시물을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요
 . </font><font style=vertical-align:inherit>래핑 오류는 또한 명확하지 않은 방식으로 패키지의 API 표면을 확장하므로 패키지의 구현 세부 사항을 변경하면 손상이 발생할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>노출된 기본 오류를 문서화하고 검증하는 테스트가 없으면 </font><font style=vertical-align:inherit>사용하지 않는 것이 가장 좋습니다 . 발신자가 </font></font><code class="language-plaintext highlighter-rouge">errors.Unwrap</code><font style=vertical-align:inherit><font style=vertical-align:inherit>에 </font><font style=vertical-align:inherit>전화할 것이라고 예상하지 않는 경우에는 </font></font><code class="language-plaintext highlighter-rouge">errors.Is</code><font style=vertical-align:inherit><font style=vertical-align:inherit>을 사용하지 마십시오 </font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>동일한 개념이 </font><font style=vertical-align:inherit>다음과 같은
 </font></font><a href=#error-structure><font style=vertical-align:inherit><font style=vertical-align:inherit>구조적 오류 에 적용됩니다( </font></font></a><font style=vertical-align:inherit><a href=https://pkg.go.dev/google.golang.org/grpc/codes><font style=vertical-align:inherit>정규 코드</font></a></font><a href=https://pkg.go.dev/google.golang.org/grpc/status><code class="language-plaintext highlighter-rouge">*status.Status</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조 </font><font style=vertical-align:inherit>). 예를 들어, 서버가 백엔드에 잘못된 요청을 보내고 코드를 수신하는 경우 </font><font style=vertical-align:inherit>클라이언트가 아무 잘못도 하지 않았다고 가정하면 </font><font style=vertical-align:inherit>이 코드가 클라이언트에 전파되어서는 </font><em><font style=vertical-align:inherit>안</font></em><font style=vertical-align:inherit> 됩니다. 대신 </font><font style=vertical-align:inherit>클라이언트에 정식 코드를 반환하세요.</font></font><a href=https://pkg.go.dev/google.golang.org/grpc/codes><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">InvalidArgument</code><font style=vertical-align:inherit></font><em><font style=vertical-align:inherit></font></em><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Internal</code><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 오류에 주석을 달면 자동화된 로깅 시스템이 오류의 상태 페이로드를 보존하는 데 도움이 됩니다. 예를 들어, 오류에 주석을 달면 내부 함수에서 적절합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=p>(</span><span class=n>s</span> <span class=o>*</span><span class=n>Server</span><span class=p>)</span> <span class=n>internalFunction</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=c>// ...</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"couldn't find remote file: %w"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>시스템 경계(일반적으로 RPC, IPC, 저장소 등)에 직접 있는 코드는 표준 오류 공간을 사용하여 오류를 보고해야 합니다. 도메인별 오류를 처리하고 이를 정식으로 표현하는 것은 여기서 코드의 책임입니다. 예를 들어:</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>FortuneTeller</span><span class=p>)</span> <span class=n>SuggestFortune</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>SuggestionRequest</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>SuggestionResponse</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// ...</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=no>nil</span><span class=p>,</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"couldn't find remote file: %w"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>import</span> <span class=p>(</span>
    <span class=s>"google.golang.org/grpc/codes"</span>
    <span class=s>"google.golang.org/grpc/status"</span>
<span class=p>)</span>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>FortuneTeller</span><span class=p>)</span> <span class=n>SuggestFortune</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>SuggestionRequest</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>SuggestionResponse</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// ...</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=c>// Or use fmt.Errorf with the %w verb if deliberately wrapping an</span>
        <span class=c>// error which the caller is meant to unwrap.</span>
        <span class=k>return</span> <span class=no>nil</span><span class=p>,</span> <span class=n>status</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=n>codes</span><span class=o>.</span><span class=n>Internal</span><span class=p>,</span> <span class=s>"couldn't find fortune database"</span><span class=p>,</span> <span class=n>status</span><span class=o>.</span><span class=n>ErrInternal</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=#documentation-conventions-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 문서화 규칙</font></font></a></li>
</ul>
<p><a id=error-percent-w></a></p>
<h3 id=placement-of-w-in-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>%w 배치 오류</font></font><a class=anchorjs-link href=#placement-of-w-in-errors aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 문자열 끝에 </font><font style=vertical-align:inherit>배치하는 것이 좋습니다 .</font></font></p>
<p><font style=vertical-align:inherit></font><a href=https://blog.golang.org/go1.13-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류는 동사</font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 로 래핑되거나
 </font><font style=vertical-align:inherit>구현하는 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>구조화된 오류</font></font></a><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Unwrap() error</code><font style=vertical-align:inherit><font style=vertical-align:inherit> (예:
 ) </font><font style=vertical-align:inherit>에 배치될
 수 </font><a href=https://blog.golang.org/go1.13-errors><font style=vertical-align:inherit>있습니다</font></a></font><a href=https://pkg.go.dev/io/fs#PathError><code class="language-plaintext highlighter-rouge">fs.PathError</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> .</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>래핑된 오류는 오류 체인을 형성합니다. 각각의 새 래핑 레이어는 오류 체인 앞에 새 항목을 추가합니다. 메소드 </font><font style=vertical-align:inherit>를 사용하여 오류 체인을 탐색할 수 있습니다
 </font></font><code class="language-plaintext highlighter-rouge">Unwrap() error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 예를 들어:</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=n>err1</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err1"</span><span class=p>)</span>
<span class=n>err2</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err2: %w"</span><span class=p>,</span> <span class=n>err1</span><span class=p>)</span>
<span class=n>err3</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err3: %w"</span><span class=p>,</span> <span class=n>err2</span><span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이는 다음과 같은 형태의 오류 체인을 형성합니다.</font></font></p>
<pre><code class=language-mermaid>flowchart LR<font></font>
  err3 == err3 wraps err2 ==&gt; err2;<font></font>
  err2 == err2 wraps err1 ==&gt; err1;<font></font>
</code></pre>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>동사의 위치에 관계없이 </font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>반환된 오류는 항상 오류 체인의 앞부분을 나타내며 </font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>다음 자식입니다. 마찬가지로 </font></font><code class="language-plaintext highlighter-rouge">Unwrap() error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>항상 최신 오류부터 가장 오래된 오류까지 오류 체인을 순회합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 동사 의 배치는 </font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 체인이 최신 항목에서 가장 오래된 항목으로, 가장 오래된 항목에서 최신 항목으로 인쇄되는지 여부에 영향을 미치거나 둘 다 인쇄되지 않습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>err1</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err1"</span><span class=p>)</span>
<span class=n>err2</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err2: %w"</span><span class=p>,</span> <span class=n>err1</span><span class=p>)</span>
<span class=n>err3</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err3: %w"</span><span class=p>,</span> <span class=n>err2</span><span class=p>)</span>
<span class=n>fmt</span><span class=o>.</span><span class=n>Println</span><span class=p>(</span><span class=n>err3</span><span class=p>)</span> <span class=c>// err3: err2: err1</span>
<span class=c>// err3 is a newest-to-oldest error chain, that prints newest-to-oldest.</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=n>err1</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err1"</span><span class=p>)</span>
<span class=n>err2</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"%w: err2"</span><span class=p>,</span> <span class=n>err1</span><span class=p>)</span>
<span class=n>err3</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"%w: err3"</span><span class=p>,</span> <span class=n>err2</span><span class=p>)</span>
<span class=n>fmt</span><span class=o>.</span><span class=n>Println</span><span class=p>(</span><span class=n>err3</span><span class=p>)</span> <span class=c>// err1: err2: err3</span>
<span class=c>// err3 is a newest-to-oldest error chain, that prints oldest-to-newest.</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=n>err1</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err1"</span><span class=p>)</span>
<span class=n>err2</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err2-1 %w err2-2"</span><span class=p>,</span> <span class=n>err1</span><span class=p>)</span>
<span class=n>err3</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"err3-1 %w err3-2"</span><span class=p>,</span> <span class=n>err2</span><span class=p>)</span>
<span class=n>fmt</span><span class=o>.</span><span class=n>Println</span><span class=p>(</span><span class=n>err3</span><span class=p>)</span> <span class=c>// err3-1 err2-1 err1 err2-2 err3-2</span>
<span class=c>// err3 is a newest-to-oldest error chain, that neither prints newest-to-oldest</span>
<span class=c>// nor oldest-to-newest.</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>따라서 오류 텍스트가 오류 체인 구조를 반영하려면 </font></font><code class="language-plaintext highlighter-rouge">%w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>동사를 형식으로 끝에 배치하는 것이 좋습니다 </font></font><code class="language-plaintext highlighter-rouge">[...]: %w</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><a id=error-logging></a></p>
<h3 id=logging-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 로깅</font></font><a class=anchorjs-link href=#logging-errors aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수는 때때로 호출자에게 전파하지 않고 외부 시스템에 오류를 알려야 합니다. 로깅은 여기서 명백한 선택이지만, 무엇을 어떻게 로깅하는지에 대해 의식하세요.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#useful-test-failures><font style=vertical-align:inherit><font style=vertical-align:inherit>좋은 테스트 실패 메시지</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 와 마찬가지로 </font><font style=vertical-align:inherit>로그 메시지는 무엇이 잘못되었는지 명확하게 표현하고 문제 진단을 위한 관련 정보를 포함하여 유지관리자에게 도움이 되어야 합니다.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>중복을 피하세요. 오류를 반환하는 경우 일반적으로 직접 기록하지 않고 호출자가 처리하도록 하는 것이 좋습니다. 호출자는 오류를 기록하거나 </font></font><a href=https://pkg.go.dev/golang.org/x/time/rate#Sometimes><code class="language-plaintext highlighter-rouge">rate.Sometimes</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>. 다른 옵션에는 복구 시도 또는 </font></font><a href=#checks-and-panics><font style=vertical-align:inherit><font style=vertical-align:inherit>프로그램 중지가</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 포함됩니다 . 어떤 경우든 발신자에게 제어권을 부여하면 로그 스팸을 방지하는 데 도움이 됩니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 이 접근 방식의 단점은 모든 로깅이 호출자의 회선 좌표를 사용하여 기록된다는 것입니다.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit></font><a href=https://en.wikipedia.org/wiki/Personal_data><font style=vertical-align:inherit><font style=vertical-align:inherit>PII</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 주의하세요 </font><font style=vertical-align:inherit>. 많은 로그 싱크는 민감한 최종 사용자 정보를 보관하는 데 적합하지 않습니다.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>드물게 사용하십시오 </font></font><code class="language-plaintext highlighter-rouge">log.Error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. ERROR 수준 로깅은 플러시를 유발하며 낮은 로깅 수준보다 비용이 더 많이 듭니다. 이는 코드 성능에 심각한 영향을 미칠 수 있습니다. 오류 수준과 경고 수준 사이를 결정할 때 오류 수준의 메시지는 경고보다 "더 심각한" 메시지가 아니라 조치가 가능해야 한다는 모범 사례를 고려하세요.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>Google 내부에는 로그 파일에 기록하고 누군가가 이를 알아차리기를 바라는 것보다 더 효과적인 알림을 제공하도록 설정할 수 있는 모니터링 시스템이 있습니다. 이는 표준 라이브러리
 </font></font><a href=https://pkg.go.dev/expvar><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지</font></font><code class="language-plaintext highlighter-rouge">expvar</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 와 유사하지만 동일하지는 않습니다 .</font></font></p>
 </li>
</ul>
<p><a id=vlog></a></p>
<h4 id=custom-verbosity-levels><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자 정의 자세한 수준</font></font><a class=anchorjs-link href=#custom-verbosity-levels aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>자세한 로깅( </font></font><a href=https://pkg.go.dev/github.com/golang/glog#V><code class="language-plaintext highlighter-rouge">log.V</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>)을 활용하세요. 자세한 로깅은 개발 및 추적에 유용할 수 있습니다. 자세한 수준에 대한 규칙을 설정하는 것이 도움이 될 수 있습니다. 예를 들어:</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>다음 위치에 약간의 추가 정보를 작성하세요.</font></font><code class="language-plaintext highlighter-rouge">V(1)</code></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>더 많은 정보를 추적하세요</font></font><code class="language-plaintext highlighter-rouge">V(2)</code></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>큰 내부 상태를 덤프합니다.</font></font><code class="language-plaintext highlighter-rouge">V(3)</code></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>자세한 로깅 비용을 최소화하려면 이 </font></font><code class="language-plaintext highlighter-rouge">log.V</code><font style=vertical-align:inherit><font style=vertical-align:inherit>꺼진 경우에도 값비싼 함수를 실수로 호출하지 않도록 해야 합니다. </font></font><code class="language-plaintext highlighter-rouge">log.V</code><font style=vertical-align:inherit><font style=vertical-align:inherit>두 가지 API를 제공합니다. 더 편리한 것은 이러한 우발적인 비용의 위험을 안고 있습니다. 의심스러운 경우에는 약간 더 장황한 스타일을 사용하세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>sql</span> <span class=o>:=</span> <span class=k>range</span> <span class=n>queries</span> <span class=p>{</span>
  <span class=n>log</span><span class=o>.</span><span class=n>V</span><span class=p>(</span><span class=m>1</span><span class=p>)</span><span class=o>.</span><span class=n>Infof</span><span class=p>(</span><span class=s>"Handling %v"</span><span class=p>,</span> <span class=n>sql</span><span class=p>)</span>
  <span class=k>if</span> <span class=n>log</span><span class=o>.</span><span class=n>V</span><span class=p>(</span><span class=m>2</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>log</span><span class=o>.</span><span class=n>Infof</span><span class=p>(</span><span class=s>"Handling %v"</span><span class=p>,</span> <span class=n>sql</span><span class=o>.</span><span class=n>Explain</span><span class=p>())</span>
  <span class=p>}</span>
  <span class=n>sql</span><span class=o>.</span><span class=n>Run</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=c>// sql.Explain called even when this log is not printed.</span>
<span class=n>log</span><span class=o>.</span><span class=n>V</span><span class=p>(</span><span class=m>2</span><span class=p>)</span><span class=o>.</span><span class=n>Infof</span><span class=p>(</span><span class=s>"Handling %v"</span><span class=p>,</span> <span class=n>sql</span><span class=o>.</span><span class=n>Explain</span><span class=p>())</span>
</code></pre></div></div>
<p><a id=program-init></a></p>
<h3 id=program-initialization><font style=vertical-align:inherit><font style=vertical-align:inherit>프로그램 초기화</font></font><a class=anchorjs-link href=#program-initialization aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>프로그램 초기화 오류(예: 잘못된 플래그 및 구성)는 위쪽으로 전파되어야 하며 </font><font style=vertical-align:inherit>오류 수정 방법을 설명하는 오류와 함께 </font></font><code class="language-plaintext highlighter-rouge">main</code><font style=vertical-align:inherit><font style=vertical-align:inherit>호출되어야 합니다 . </font></font><code class="language-plaintext highlighter-rouge">log.Exit</code><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 경우 </font></font><code class="language-plaintext highlighter-rouge">log.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>검사를 가리키는 스택 추적은 사람이 생성한 실행 가능한 메시지만큼 유용하지 않을 가능성이 높기 때문에 일반적으로 사용해서는 안 됩니다.</font></font></p>
<p><a id=checks-and-panics></a></p>
<h3 id=program-checks-and-panics><font style=vertical-align:inherit><font style=vertical-align:inherit>프로그램 점검 및 패닉</font></font><a class=anchorjs-link href=#program-checks-and-panics aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#dont-panic><font style=vertical-align:inherit><font style=vertical-align:inherit>패닉에 대한 결정</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 명시된 대로 </font><font style=vertical-align:inherit>표준 오류 처리는 오류 반환 값을 중심으로 구성되어야 합니다. 라이브러리는 특히 일시적인 오류의 경우 프로그램을 중단하는 것보다 호출자에게 오류를 반환하는 것을 선호해야 합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>불변성에 대해 일관성 검사를 수행하고 이를 위반하는 경우 프로그램을 종료해야 하는 경우가 가끔 있습니다. 일반적으로 이는 불변 검사가 실패하여 내부 상태를 복구할 수 없게 된 경우에만 수행됩니다. Google 코드베이스에서 이를 수행하는 가장 안정적인 방법은 </font></font><code class="language-plaintext highlighter-rouge">log.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. </font></font><code class="language-plaintext highlighter-rouge">panic</code><font style=vertical-align:inherit><font style=vertical-align:inherit>지연된 함수가 교착 상태에 빠지거나 내부 또는 외부 상태를 더욱 손상시킬 수 있으므로 이러한 경우에 </font><font style=vertical-align:inherit>사용하는 것은 신뢰할 수 없습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>마찬가지로, 충돌을 피하기 위해 패닉을 복구하려는 유혹에 저항하십시오. 그렇게 하면 손상된 상태가 전파될 수 있습니다. 패닉 상태에서 멀어질수록 잠금이나 기타 리소스를 보유하고 있을 수 있는 프로그램 상태에 대해 아는 것이 줄어듭니다. 그런 다음 프로그램은 문제를 진단하기 더욱 어렵게 만들 수 있는 다른 예상치 못한 오류 모드를 개발할 수 있습니다. 코드에서 예상치 못한 패닉을 처리하려고 하는 대신 모니터링 도구를 사용하여 예상치 못한 오류를 표면화하고 우선순위가 높은 관련 버그를 수정하세요.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 표준 </font></font><a href=https://pkg.go.dev/net/http#Server><code class="language-plaintext highlighter-rouge">net/http</code><font style=vertical-align:inherit><font style=vertical-align:inherit>서버는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 조언을 위반하고 요청 핸들러에서 패닉을 복구합니다. 숙련된 Go 엔지니어들 사이에서는 이것이 역사적인 실수였다는 데 의견이 일치합니다. 다른 언어로 된 애플리케이션 서버에서 서버 로그를 샘플링하면 처리되지 않은 큰 스택 추적을 찾는 것이 일반적입니다. 서버에서 이 함정을 피하세요.</font></font></p>
<p><a id=when-to-panic></a></p>
<h3 id=when-to-panic><font style=vertical-align:inherit><font style=vertical-align:inherit>당황해야 할 때</font></font><a class=anchorjs-link href=#when-to-panic aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>API 오용으로 인해 표준 라이브러리에 패닉이 발생합니다. 예를 들어 </font></font><a href=https://pkg.go.dev/reflect><code class="language-plaintext highlighter-rouge">reflect</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>값이 잘못 해석되었음을 암시하는 방식으로 값에 액세스하는 경우 많은 경우 패닉이 발생합니다. 이는 범위를 벗어난 슬라이스 요소에 액세스하는 것과 같은 핵심 언어 버그에 대한 패닉과 유사합니다. 코드 검토 및 테스트를 통해 프로덕션 코드에 나타날 것으로 예상되지 않는 버그를 발견해야 합니다. 표준 라이브러리는 </font><font style=vertical-align:inherit>Google 코드베이스가 사용하는 </font></font><a href=https://google.github.io/styleguide/go/decisions#logging><font style=vertical-align:inherit><font style=vertical-align:inherit>레벨</font></font><code class="language-plaintext highlighter-rouge">log</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 패키지 에 액세스할 수 없기 때문에 이러한 패닉은 라이브러리에 의존하지 않는 불변 검사 역할을 합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>패닉이 유용할 수 있는 또 다른 경우는 흔하지 않지만 콜체인에 항상 일치하는 복구가 있는 패키지의 내부 구현 세부 사항입니다. 파서 및 이와 유사하게 깊게 중첩되고 밀접하게 결합된 내부 함수 그룹은 배관 오류 반환이 가치 없이 복잡성을 추가하는 이 설계의 이점을 누릴 수 있습니다. 이 디자인의 핵심 특성은 이러한 패닉이 패키지 경계를 넘어 탈출하는 것이 허용되지 않으며 패키지 API의 일부를 형성하지 않는다는 것입니다. 이는 일반적으로 퍼블릭 API 표면에서 전파되는 패닉을 반환된 오류로 변환하는 최상위 지연 복구를 통해 수행됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>패닉은 컴파일러가 도달할 수 없는 코드를 식별할 수 없는 경우에도 사용됩니다. 예를 들어 다음과 같은 함수를 사용하면 다음이 </font></font><code class="language-plaintext highlighter-rouge">log.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>반환되지 않습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>answer</span><span class=p>(</span><span class=n>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
    <span class=k>switch</span> <span class=n>i</span> <span class=p>{</span>
    <span class=k>case</span> <span class=m>42</span><span class=o>:</span>
        <span class=k>return</span> <span class=s>"yup"</span>
    <span class=k>case</span> <span class=m>54</span><span class=o>:</span>
        <span class=k>return</span> <span class=s>"base 13, huh"</span>
    <span class=k>default</span><span class=o>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Sorry, %d is not the answer."</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
        <span class=nb>panic</span><span class=p>(</span><span class=s>"unreachable"</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><a href=https://pkg.go.dev/github.com/golang/glog#pkg-overview><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">log</code><font style=vertical-align:inherit><font style=vertical-align:inherit>플래그가 구문 분석되기 전에 함수를 </font><font style=vertical-align:inherit>호출하지 마십시오</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> . func 
에서 죽어야 하는 경우 </font></font><code class="language-plaintext highlighter-rouge">init</code><font style=vertical-align:inherit><font style=vertical-align:inherit>로깅 호출 대신 패닉이 허용됩니다.</font></font></p>
<p><a id=documentation></a></p>
<h2 id=documentation><font style=vertical-align:inherit><font style=vertical-align:inherit>선적 서류 비치</font></font><a class=anchorjs-link href=#documentation aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><a id=documentation-conventions></a></p>
<h3 id=conventions><font style=vertical-align:inherit><font style=vertical-align:inherit>규칙</font></font><a class=anchorjs-link href=#conventions aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 섹션은 결정 문서의 </font></font><a href=https://google.github.io/styleguide/go/decisions#commentary><font style=vertical-align:inherit><font style=vertical-align:inherit>설명</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 섹션을 보완합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>친숙한 스타일로 문서화된 Go 코드는 잘못 문서화되었거나 전혀 문서화되지 않은 코드보다 읽기 쉽고 오용될 가능성이 적습니다. 실행 가능한
 </font></font><a href=https://google.github.io/styleguide/go/decisions#examples><font style=vertical-align:inherit><font style=vertical-align:inherit>예제는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> Godoc 및 코드 검색에 표시되며 코드 사용 방법을 설명하는 훌륭한 방법입니다.</font></font></p>
<p><a id=documentation-conventions-params></a></p>
<h4 id=parameters-and-configuration><font style=vertical-align:inherit><font style=vertical-align:inherit>매개변수 및 구성</font></font><a class=anchorjs-link href=#parameters-and-configuration aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>문서에 모든 매개변수를 열거해야 하는 것은 아닙니다. 이는 다음에 적용됩니다:</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>함수 및 메서드 매개변수</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>구조체 필드</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션용 API</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>오류가 발생하기 쉽거나 명확하지 않은 필드와 매개변수가 흥미로운 이유를 설명하여 문서화하세요.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음 스니펫에서 강조된 해설은 독자에게 유용한 정보를 거의 제공하지 않습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=c>// Sprintf formats according to a format specifier and returns the resulting</span>
<span class=c>// string.</span>
<span class=c>//</span>
<span class=c>// format is the format, and data is the interpolation data.</span>
<span class=k>func</span> <span class=n>Sprintf</span><span class=p>(</span><span class=n>format</span> <span class=kt>string</span><span class=p>,</span> <span class=n>data</span> <span class=o>...</span><span class=n>any</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 이 코드 조각은 해설에서 독자에게 명확하지 않거나 실질적으로 도움이 되는 내용을 언급하는 이전 코드 시나리오와 유사한 코드 시나리오를 보여줍니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Sprintf formats according to a format specifier and returns the resulting</span>
<span class=c>// string.</span>
<span class=c>//</span>
<span class=c>// The provided data is used to interpolate the format string. If the data does</span>
<span class=c>// not match the expected format verbs or the amount of data does not satisfy</span>
<span class=c>// the format specification, the function will inline warnings about formatting</span>
<span class=c>// errors into the output string as described by the Format errors section</span>
<span class=c>// above.</span>
<span class=k>func</span> <span class=n>Sprintf</span><span class=p>(</span><span class=n>format</span> <span class=kt>string</span><span class=p>,</span> <span class=n>data</span> <span class=o>...</span><span class=n>any</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>무엇을 어떤 깊이로 문서화할지 선택할 때 잠재 고객을 고려하세요. 유지 관리자, 팀에 새로 합류한 사람, 외부 사용자, 심지어 6개월 후의 자신도 처음 문서를 작성할 때 생각했던 것과 약간 다른 정보를 감상할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #41: 함수 호출 매개변수 식별</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #51: 구성 패턴</font></font></a></li>
</ul>
<p><a id=documentation-conventions-contexts></a></p>
<h4 id=contexts><font style=vertical-align:inherit><font style=vertical-align:inherit>컨텍스트</font></font><a class=anchorjs-link href=#contexts aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>컨텍스트 인수를 취소하면 해당 인수가 제공되는 기능이 중단된다는 의미입니다. 함수가 오류를 반환할 수 있는 경우 일반적으로 오류는 입니다 </font></font><code class="language-plaintext highlighter-rouge">ctx.Err()</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 사실은 다시 언급할 필요가 없습니다:</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=c>// Run executes the worker's run loop.</span>
<span class=c>//</span>
<span class=c>// The method will process work until the context is cancelled and accordingly</span>
<span class=c>// returns an error.</span>
<span class=k>func</span> <span class=p>(</span><span class=n>Worker</span><span class=p>)</span> <span class=n>Run</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=kt>error</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그것이 암시되기 때문에 다음이 더 좋습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Run executes the worker's run loop.</span>
<span class=k>func</span> <span class=p>(</span><span class=n>Worker</span><span class=p>)</span> <span class=n>Run</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=kt>error</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>상황에 따른 동작이 다르거나 명확하지 않은 경우 다음 중 하나라도 해당되면 명시적으로 문서화해야 합니다.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">ctx.Err()</code><font style=vertical-align:inherit><font style=vertical-align:inherit>이 함수는 컨텍스트가 취소될 때를 </font><font style=vertical-align:inherit>제외하고 오류를 반환합니다 .</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Run executes the worker's run loop.</span>
<span class=c>//</span>
<span class=c>// If the context is cancelled, Run returns a nil error.</span>
<span class=k>func</span> <span class=p>(</span><span class=n>Worker</span><span class=p>)</span> <span class=n>Run</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=kt>error</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수에는 함수를 중단하거나 수명에 영향을 미칠 수 있는 다른 메커니즘이 있습니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Run executes the worker's run loop.</span>
<span class=c>//</span>
<span class=c>// Run processes work until the context is cancelled or Stop is called.</span>
<span class=c>// Context cancellation is handled asynchronously internally: run may return</span>
<span class=c>// before all work has stopped. The Stop method is synchronous and waits</span>
<span class=c>// until all operations from the run loop finish. Use Stop for graceful</span>
<span class=c>// shutdown.</span>
<span class=k>func</span> <span class=p>(</span><span class=n>Worker</span><span class=p>)</span> <span class=n>Run</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=kt>error</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>Worker</span><span class=p>)</span> <span class=n>Stop</span><span class=p>()</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 함수에는 컨텍스트 수명, 계보 또는 연결된 값에 대한 특별한 기대치가 있습니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// NewReceiver starts receiving messages sent to the specified queue.</span>
<span class=c>// The context should not have a deadline.</span>
<span class=k>func</span> <span class=n>NewReceiver</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=o>*</span><span class=n>Receiver</span><font></font>
<font></font>
<span class=c>// Principal returns a human-readable name of the party who made the call.</span>
<span class=c>// The context must have a value attached to it from security.NewContext.</span>
<span class=k>func</span> <span class=n>Principal</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>,</span> <span class=n>ok</span> <span class=kt>bool</span><span class=p>)</span>
</code></pre></div> </div>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>경고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 호출자에게 그러한 요구(예: 마감 기한이 없는 컨텍스트)를 요구하는 API를 설계하지 마세요. 위의 내용은 패턴을 보증하는 것이 아니라 피할 수 없는 경우 이를 문서화하는 방법의 예일 뿐입니다.</font></font></p>
 </li>
</ul>
<p><a id=documentation-conventions-concurrency></a></p>
<h4 id=concurrency><font style=vertical-align:inherit><font style=vertical-align:inherit>동시성</font></font><a class=anchorjs-link href=#concurrency aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 사용자는 개념적으로 읽기 전용 작업이 동시에 사용하기에 안전하고 추가 동기화가 필요하지 않다고 가정합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>동시성에 대한 추가 설명은 이 Godoc에서 안전하게 제거할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Len returns the number of bytes of the unread portion of the buffer;</span>
<span class=c>// b.Len() == len(b.Bytes()).</span>
<span class=c>//</span>
<span class=c>// It is safe to be called concurrently by multiple goroutines.</span>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>Buffer</span><span class=p>)</span> <span class=n>Len</span><span class=p>()</span> <span class=kt>int</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 변형 작업은 동시 사용에 안전하지 않다고 가정하며, 사용자는 동기화를 고려해야 합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>마찬가지로 동시성에 대한 추가 설명은 여기에서 안전하게 제거할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Grow grows the buffer's capacity.</span>
<span class=c>//</span>
<span class=c>// It is not safe to be called concurrently by multiple goroutines.</span>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>Buffer</span><span class=p>)</span> <span class=n>Grow</span><span class=p>(</span><span class=n>n</span> <span class=kt>int</span><span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음 중 하나에 해당하는 경우 문서화를 적극 권장합니다.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>작업이 읽기 전용인지 변경인지는 확실하지 않습니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>lrucache</span><font></font>
<font></font>
<span class=c>// Lookup returns the data associated with the key from the cache.</span>
<span class=c>//</span>
<span class=c>// This operation is not safe for concurrent use.</span>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>Cache</span><span class=p>)</span> <span class=n>Lookup</span><span class=p>(</span><span class=n>key</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=n>data</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>,</span> <span class=n>ok</span> <span class=kt>bool</span><span class=p>)</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>왜? 키를 조회할 때 캐시 적중이 발생하면 내부적으로 LRU 캐시가 변경됩니다. 이것이 어떻게 구현되는지는 모든 독자에게 명확하지 않을 수 있습니다.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>동기화는 API에 의해 제공됩니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>fortune_go_proto</span><font></font>
<font></font>
<span class=c>// NewFortuneTellerClient returns an *rpc.Client for the FortuneTeller service.</span>
<span class=c>// It is safe for simultaneous use by multiple goroutines.</span>
<span class=k>func</span> <span class=n>NewFortuneTellerClient</span><span class=p>(</span><span class=n>cc</span> <span class=o>*</span><span class=n>rpc</span><span class=o>.</span><span class=n>ClientConn</span><span class=p>)</span> <span class=o>*</span><span class=n>FortuneTellerClient</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>왜? Stubby는 동기화를 제공하거든요.</font></font></p>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> API가 유형이고 API가 전체 동기화를 제공하는 경우 일반적으로 유형 정의만이 의미를 문서화합니다.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>API는 사용자가 구현한 유형의 인터페이스를 사용하며 인터페이스 소비자에게는 특별한 동시성 요구 사항이 있습니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>health</span><font></font>
<font></font>
<span class=c>// A Watcher reports the health of some entity (usually a backend service).</span>
<span class=c>//</span>
<span class=c>// Watcher methods are safe for simultaneous use by multiple goroutines.</span>
<span class=k>type</span> <span class=n>Watcher</span> <span class=k>interface</span> <span class=p>{</span>
    <span class=c>// Watch sends true on the passed-in channel when the Watcher's</span>
    <span class=c>// status has changed.</span>
    <span class=n>Watch</span><span class=p>(</span><span class=n>changed</span> <span class=k>chan</span><span class=o>&lt;-</span> <span class=kt>bool</span><span class=p>)</span> <span class=p>(</span><span class=n>unwatch</span> <span class=k>func</span><span class=p>())</span><font></font>
<font></font>
    <span class=c>// Health returns nil if the entity being watched is healthy, or a</span>
    <span class=c>// non-nil error explaining why the entity is not healthy.</span>
    <span class=n>Health</span><span class=p>()</span> <span class=kt>error</span>
<span class=p>}</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>왜? API가 여러 고루틴에서 사용하기에 안전한지 여부는 계약의 일부입니다.</font></font></p>
 </li>
</ul>
<p><a id=documentation-conventions-cleanup></a></p>
<h4 id=cleanup><font style=vertical-align:inherit><font style=vertical-align:inherit>대청소</font></font><a class=anchorjs-link href=#cleanup aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>API에 있는 명시적인 정리 요구 사항을 문서화하세요. 그렇지 않으면 호출자가 API를 올바르게 사용하지 않아 리소스 누출 및 기타 버그가 발생할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자에게 달려 있는 정리 작업을 호출합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// NewTicker returns a new Ticker containing a channel that will send the</span>
<span class=c>// current time on the channel after each tick.</span>
<span class=c>//</span>
<span class=c>// Call Stop to release the Ticker's associated resources when done.</span>
<span class=k>func</span> <span class=n>NewTicker</span><span class=p>(</span><span class=n>d</span> <span class=n>Duration</span><span class=p>)</span> <span class=o>*</span><span class=n>Ticker</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>Ticker</span><span class=p>)</span> <span class=n>Stop</span><span class=p>()</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>리소스를 정리하는 방법이 불분명할 경우 다음 방법을 설명하세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Get issues a GET to the specified URL.</span>
<span class=c>//</span>
<span class=c>// When err is nil, resp always contains a non-nil resp.Body.</span>
<span class=c>// Caller should close resp.Body when done reading from it.</span>
<span class=c>//</span>
<span class=c>//    resp, err := http.Get("http://example.com/")</span>
<span class=c>//    if err != nil {</span>
<span class=c>//        // handle error</span>
<span class=c>//    }</span>
<span class=c>//    defer resp.Body.Close()</span>
<span class=c>//    body, err := io.ReadAll(resp.Body)</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Client</span><span class=p>)</span> <span class=n>Get</span><span class=p>(</span><span class=n>url</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=n>resp</span> <span class=o>*</span><span class=n>Response</span><span class=p>,</span> <span class=n>err</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #110: 종료와 연기를 혼합하지 마세요</font></font></a></li>
</ul>
<p><a id=documentation-conventions-errors></a></p>
<h4 id=errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류</font></font><a class=anchorjs-link href=#errors aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자가 코드에서 처리할 수 있는 조건 유형을 예측할 수 있도록 함수가 호출자에게 반환하는 중요한 오류 감시 값 또는 오류 유형을 문서화하세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>os</span><font></font>
<font></font>
<span class=c>// Read reads up to len(b) bytes from the File and stores them in b. It returns</span>
<span class=c>// the number of bytes read and any error encountered.</span>
<span class=c>//</span>
<span class=c>// At end of file, Read returns 0, io.EOF.</span>
<span class=k>func</span> <span class=p>(</span><span class=o>*</span><span class=n>File</span><span class=p>)</span> <span class=n>Read</span><span class=p>(</span><span class=n>b</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>)</span> <span class=p>(</span><span class=n>n</span> <span class=kt>int</span><span class=p>,</span> <span class=n>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수가 특정 오류 유형을 반환하는 경우 오류가 포인터 수신자인지 아닌지를 정확하게 확인하세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>os</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>PathError</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=n>Op</span>   <span class=kt>string</span>
    <span class=n>Path</span> <span class=kt>string</span>
    <span class=n>Err</span>  <span class=kt>error</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// Chdir changes the current working directory to the named directory.</span>
<span class=c>//</span>
<span class=c>// If there is an error, it will be of type *PathError.</span>
<span class=k>func</span> <span class=n>Chdir</span><span class=p>(</span><span class=n>dir</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>반환된 값이 포인터 수신기인지 여부를 문서화하면 호출자가 , 및 를 사용하여 오류를 올바르게 비교할 </font></font><a href=https://pkg.go.dev/errors#Is><code class="language-plaintext highlighter-rouge">errors.Is</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>수 </font></font><a href=https://pkg.go.dev/errors#As><code class="language-plaintext highlighter-rouge">errors.As</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>있습니다
 </font></font><a href=https://pkg.go.dev/github.com/google/go-cmp/cmp><code class="language-plaintext highlighter-rouge">package cmp</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>. 포인터가 아닌 값은 포인터 값과 동일하지 않기 때문입니다.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 예제 에서 </font></font><code class="language-plaintext highlighter-rouge">Chdir</code><font style=vertical-align:inherit><font style=vertical-align:inherit>반환 유형은 </font><a href=https://go.dev/doc/faq#nil_error><font style=vertical-align:inherit>nil 인터페이스 값이 작동하는 방식</font></a><font style=vertical-align:inherit> 이
 </font></font><code class="language-plaintext highlighter-rouge">error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>아니라 로 기록됩니다 </font><font style=vertical-align:inherit>.</font></font><code class="language-plaintext highlighter-rouge">*PathError</code><font style=vertical-align:inherit></font><a href=https://go.dev/doc/faq#nil_error><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지에서 발견된 대부분의 오류에 동작이 적용되는 경우 </font></font><a href=https://google.github.io/styleguide/go/decisions#package-comments><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 문서</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 전반적인 오류 규칙을 문서화합니다
 .</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Package os provides a platform-independent interface to operating system</span>
<span class=c>// functionality.</span>
<span class=c>//</span>
<span class=c>// Often, more information is available within the error. For example, if a</span>
<span class=c>// call that takes a file name fails, such as Open or Stat, the error will</span>
<span class=c>// include the failing file name when printed and will be of type *PathError,</span>
<span class=c>// which may be unpacked for more information.</span>
<span class=k>package</span> <span class=n>os</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 접근 방식을 신중하게 적용하면
 큰 노력 없이도 </font></font><a href=#error-extra-info><font style=vertical-align:inherit><font style=vertical-align:inherit>오류에 추가 정보를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 추가할 수 있으며 호출자가 중복된 주석을 추가하는 것을 방지할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #106: 오류 명명 규칙</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #89: 정식 상태 코드를 오류로 사용해야 하는 경우</font></font></a></li>
</ul>
<p><a id=documentation-preview></a></p>
<h3 id=preview><font style=vertical-align:inherit><font style=vertical-align:inherit>시사</font></font><a class=anchorjs-link href=#preview aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go에는
 </font></font><a href=https://pkg.go.dev/golang.org/x/pkgsite/cmd/pkgsite><font style=vertical-align:inherit><font style=vertical-align:inherit>문서 서버</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 가 있습니다 . 코드 검토 프로세스 전과 도중에 코드가 생성하는 문서를 미리 보는 것이 좋습니다. 이는
 </font></font><a href=#godoc-formatting><font style=vertical-align:inherit><font style=vertical-align:inherit>godoc 형식</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 올바르게 렌더링되었는지 확인하는 데 도움이 됩니다.</font></font></p>
<p><a id=godoc-formatting></a></p>
<h3 id=godoc-formatting><font style=vertical-align:inherit><font style=vertical-align:inherit>Godoc 형식</font></font><a class=anchorjs-link href=#godoc-formatting aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><a href=https://pkg.go.dev/><font style=vertical-align:inherit><font style=vertical-align:inherit>Godoc은 </font></font></a><font style=vertical-align:inherit></font><a href=https://go.dev/doc/comment><font style=vertical-align:inherit><font style=vertical-align:inherit>문서 형식을 지정</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 하기 위한 특정 구문을 제공합니다 </font><font style=vertical-align:inherit>.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>단락을 구분하려면 빈 줄이 필요합니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// LoadConfig reads a configuration out of the named file.</span>
<span class=c>//</span>
<span class=c>// See some/shortlink for config file format details.</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 파일에는 godoc의 해당 문서에 첨부된 </font></font><a href=https://google.github.io/styleguide/go/decisions#examples><font style=vertical-align:inherit><font style=vertical-align:inherit>실행 가능한 예제가</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 포함될 수 있습니다 .</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>ExampleConfig_WriteTo</span><span class=p>()</span> <span class=p>{</span>
  <span class=n>cfg</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=n>Config</span><span class=p>{</span>
    <span class=n>Name</span><span class=o>:</span> <span class=s>"example"</span><span class=p>,</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>cfg</span><span class=o>.</span><span class=n>WriteTo</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>Stdout</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=n>log</span><span class=o>.</span><span class=n>Exitf</span><span class=p>(</span><span class=s>"Failed to write config: %s"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
  <span class=p>}</span>
  <span class=c>// Output:</span>
  <span class=c>// {</span>
  <span class=c>//   "name": "example"</span>
  <span class=c>// }</span>
<span class=p>}</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>두 개의 공백을 추가하여 줄을 들여쓰면 그대로 형식이 지정됩니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Update runs the function in an atomic transaction.</span>
<span class=c>//</span>
<span class=c>// This is typically used with an anonymous TransactionFunc:</span>
<span class=c>//</span>
<span class=c>//   if err := db.Update(func(state *State) { state.Foo = bar }); err != nil {</span>
<span class=c>//     //...</span>
<span class=c>//   }</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 주석에 코드를 포함하는 것보다 실행 가능한 예제에 코드를 넣는 것이 더 적절할 수 있는 경우가 많습니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 축어적 형식은 목록이나 테이블과 같이 godoc에 기본이 아닌 형식에 활용될 수 있습니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// LoadConfig reads a configuration out of the named file.</span>
<span class=c>//</span>
<span class=c>// LoadConfig treats the following keys in special ways:</span>
<span class=c>//   "import" will make this configuration inherit from the named file.</span>
<span class=c>//   "env" if present will be populated with the system environment.</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>대문자로 시작하고 괄호와 쉼표 외에 구두점을 포함하지 않으며 다른 문단이 이어지는 단일 줄은 머리글로 형식이 지정됩니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// The following line is formatted as a heading.</span>
<span class=c>//</span>
<span class=c>// Using headings</span>
<span class=c>//</span>
<span class=c>// Headings come with autogenerated anchor tags for easy linking.</span>
</code></pre></div> </div>
 </li>
</ul>
<p><a id=signal-boost></a></p>
<h3 id=signal-boosting><font style=vertical-align:inherit><font style=vertical-align:inherit>신호 증폭</font></font><a class=anchorjs-link href=#signal-boosting aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>때로는 코드 줄이 일반적인 것처럼 보이지만 실제로는 그렇지 않습니다. 이에 대한 가장 좋은 예 중 하나는 수표입니다 </font></font><code class="language-plaintext highlighter-rouge">err == nil</code><font style=vertical-align:inherit><font style=vertical-align:inherit>( </font></font><code class="language-plaintext highlighter-rouge">err != nil</code><font style=vertical-align:inherit><font style=vertical-align:inherit>훨씬 더 일반적이기 때문입니다). 다음 두 가지 조건부 검사는 구별하기 어렵습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>doSomething</span><span class=p>();</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>doSomething</span><span class=p>();</span> <span class=n>err</span> <span class=o>==</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>대신 주석을 추가하여 조건문의 신호를 "강화"할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>doSomething</span><span class=p>();</span> <span class=n>err</span> <span class=o>==</span> <span class=no>nil</span> <span class=p>{</span> <span class=c>// if NO error</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 의견은 조건부의 차이점에 주목합니다.</font></font></p>
<p><a id=vardecls></a></p>
<h2 id=variable-declarations><font style=vertical-align:inherit><font style=vertical-align:inherit>변수 선언</font></font><a class=anchorjs-link href=#variable-declarations aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><a id=vardeclinitialization></a></p>
<h3 id=initialization><font style=vertical-align:inherit><font style=vertical-align:inherit>초기화</font></font><a class=anchorjs-link href=#initialization aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일관성을 위해 </font><font style=vertical-align:inherit>0이 아닌 값으로 새 변수를 초기화하는 </font></font><code class="language-plaintext highlighter-rouge">:=</code><font style=vertical-align:inherit><font style=vertical-align:inherit>것이 좋습니다.</font></font><code class="language-plaintext highlighter-rouge">var</code><font style=vertical-align:inherit></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>i</span> <span class=o>:=</span> <span class=m>42</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>var</span> <span class=n>i</span> <span class=o>=</span> <span class=m>42</span>
</code></pre></div></div>
<p><a id=vardeclzero></a></p>
<h3 id=non-pointer-zero-values><font style=vertical-align:inherit><font style=vertical-align:inherit>포인터가 아닌 0 값</font></font><a class=anchorjs-link href=#non-pointer-zero-values aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음 선언에서는 </font></font><a href=https://golang.org/ref/spec#The_zero_value><font style=vertical-align:inherit><font style=vertical-align:inherit>0 값을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용합니다 .</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=p>(</span>
    <span class=n>coords</span> <span class=n>Point</span>
    <span class=n>magic</span>  <span class=p>[</span><span class=m>4</span><span class=p>]</span><span class=kt>byte</span>
    <span class=n>primes</span> <span class=p>[]</span><span class=kt>int</span>
<span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>나중에 사용할 준비가 된</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 빈 값을 전달하려면 0 값을 사용하여 값을 선언해야 합니다 </font><font style=vertical-align:inherit>. 명시적 초기화와 함께 복합 리터럴을 사용하는 것은 투박할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>var</span> <span class=p>(</span>
    <span class=n>coords</span> <span class=o>=</span> <span class=n>Point</span><span class=p>{</span><span class=n>X</span><span class=o>:</span> <span class=m>0</span><span class=p>,</span> <span class=n>Y</span><span class=o>:</span> <span class=m>0</span><span class=p>}</span>
    <span class=n>magic</span>  <span class=o>=</span> <span class=p>[</span><span class=m>4</span><span class=p>]</span><span class=kt>byte</span><span class=p>{</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>}</span>
    <span class=n>primes</span> <span class=o>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>(</span><span class=no>nil</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>0 값 선언의 일반적인 적용은 비정렬화할 때 변수를 출력으로 사용하는 경우입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=n>coords</span> <span class=n>Point</span>
<span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>json</span><span class=o>.</span><span class=n>Unmarshal</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>coords</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#copying><font style=vertical-align:inherit><font style=vertical-align:inherit>구조체에 복사하면 안 되는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 잠금이나 기타 필드가 필요한 경우 </font><font style=vertical-align:inherit>
이를 값 유형으로 만들어 0 값 초기화를 활용할 수 있습니다. 이는 포함하는 유형이 이제 값이 아닌 포인터를 통해 전달되어야 함을 의미합니다. 해당 유형의 메소드는 포인터 수신기를 사용해야 합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>type</span> <span class=n>Counter</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=c>// This field does not have to be "*sync.Mutex". However,</span>
    <span class=c>// users must now pass *Counter objects between themselves, not Counter.</span>
    <span class=n>mu</span>   <span class=n>sync</span><span class=o>.</span><span class=n>Mutex</span>
    <span class=n>data</span> <span class=k>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int64</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// Note this must be a pointer receiver to prevent copying.</span>
<span class=k>func</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span><span class=n>Counter</span><span class=p>)</span> <span class=n>IncrementBy</span><span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>,</span> <span class=n>n</span> <span class=kt>int64</span><span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>복사할 수 없는 필드가 포함되어 있더라도 복합의 로컬 변수(예: 구조체 및 배열)에 대한 값 유형을 사용하는 것이 허용됩니다. 그러나 복합이 함수에 의해 반환되거나 이에 대한 모든 액세스가 결국 주소를 가져와야 하는 경우 처음부터 변수를 포인터 유형으로 선언하는 것이 좋습니다. 마찬가지로 protobuf는 포인터 유형으로 선언되어야 합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>NewCounter</span><span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>)</span> <span class=o>*</span><span class=n>Counter</span> <span class=p>{</span>
    <span class=n>c</span> <span class=o>:=</span> <span class=nb>new</span><span class=p>(</span><span class=n>Counter</span><span class=p>)</span> <span class=c>// "&amp;Counter{}" is also fine.</span>
    <span class=n>registerCounter</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>c</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>c</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>var</span> <span class=n>myMsg</span> <span class=o>=</span> <span class=nb>new</span><span class=p>(</span><span class=n>pb</span><span class=o>.</span><span class=n>Bar</span><span class=p>)</span> <span class=c>// or "&amp;pb.Bar{}".</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">*pb.Something</code><font style=vertical-align:inherit><font style=vertical-align:inherit>만족 </font></font><a href=https://pkg.go.dev/google.golang.org/protobuf/proto#Message><code class="language-plaintext highlighter-rouge">proto.Message</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>하지만 </font></font><code class="language-plaintext highlighter-rouge">pb.Something</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
그렇지 않기 </font><font style=vertical-align:inherit>때문이다 .</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>NewCounter</span><span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>)</span> <span class=o>*</span><span class=n>Counter</span> <span class=p>{</span>
    <span class=k>var</span> <span class=n>c</span> <span class=n>Counter</span>
    <span class=n>registerCounter</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>)</span>
    <span class=k>return</span> <span class=o>&amp;</span><span class=n>c</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>var</span> <span class=n>myMsg</span> <span class=o>=</span> <span class=n>pb</span><span class=o>.</span><span class=n>Bar</span><span class=p>{}</span>
</code></pre></div></div>
<blockquote>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>중요:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 지도 유형을 수정하려면 먼저 명시적으로 초기화해야 합니다. 그러나 값이 0인 맵에서 읽는 것은 전혀 문제가 없습니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>맵 및 슬라이스 유형의 경우 코드가 특히 성능에 민감하고 크기를 미리 알고 있는 경우 크기 </font></font><a href=#vardeclsize><font style=vertical-align:inherit><font style=vertical-align:inherit>힌트</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 섹션을 참조하세요.</font></font></p>
</blockquote>
<p><a id=vardeclcomposite></a></p>
<h3 id=composite-literals><font style=vertical-align:inherit><font style=vertical-align:inherit>복합 리터럴</font></font><a class=anchorjs-link href=#composite-literals aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음은 </font></font><a href=https://golang.org/ref/spec#Composite_literals><font style=vertical-align:inherit><font style=vertical-align:inherit>복합 리터럴</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 선언입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=p>(</span>
    <span class=n>coords</span>   <span class=o>=</span> <span class=n>Point</span><span class=p>{</span><span class=n>X</span><span class=o>:</span> <span class=n>x</span><span class=p>,</span> <span class=n>Y</span><span class=o>:</span> <span class=n>y</span><span class=p>}</span>
    <span class=n>magic</span>    <span class=o>=</span> <span class=p>[</span><span class=m>4</span><span class=p>]</span><span class=kt>byte</span><span class=p>{</span><span class=sc>'I'</span><span class=p>,</span> <span class=sc>'W'</span><span class=p>,</span> <span class=sc>'A'</span><span class=p>,</span> <span class=sc>'D'</span><span class=p>}</span>
    <span class=n>primes</span>   <span class=o>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>7</span><span class=p>,</span> <span class=m>11</span><span class=p>}</span>
    <span class=n>captains</span> <span class=o>=</span> <span class=k>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=s>"Kirk"</span><span class=o>:</span> <span class=s>"James Tiberius"</span><span class=p>,</span> <span class=s>"Picard"</span><span class=o>:</span> <span class=s>"Jean-Luc"</span><span class=p>}</span>
<span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>초기 요소나 멤버를 알고 있는 경우 복합 리터럴을 사용하여 값을 선언해야 합니다.</font></font></p>
<p><font style=vertical-align:inherit></font><a href=#vardeclzero><font style=vertical-align:inherit><font style=vertical-align:inherit>대조적으로, 복합 리터럴을 사용하여 비어 있거나 멤버 없는 값을 선언하는 것은 0 값 초기화</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 비해 시각적으로 방해가 될 수 있습니다 </font><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>0 값에 대한 포인터가 필요한 경우 빈 복합 리터럴과 </font></font><code class="language-plaintext highlighter-rouge">new</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 둘 다 괜찮지만 </font></font><code class="language-plaintext highlighter-rouge">new</code><font style=vertical-align:inherit><font style=vertical-align:inherit>키워드는 0이 아닌 값이 필요한 경우 복합 리터럴이 작동하지 않는다는 점을 독자에게 상기시키는 역할을 할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=p>(</span>
  <span class=n>buf</span> <span class=o>=</span> <span class=nb>new</span><span class=p>(</span><span class=n>bytes</span><span class=o>.</span><span class=n>Buffer</span><span class=p>)</span> <span class=c>// non-empty Buffers are initialized with constructors.</span>
  <span class=n>msg</span> <span class=o>=</span> <span class=nb>new</span><span class=p>(</span><span class=n>pb</span><span class=o>.</span><span class=n>Message</span><span class=p>)</span> <span class=c>// non-empty proto messages are initialized with builders or by setting fields one by one.</span>
<span class=p>)</span>
</code></pre></div></div>
<p><a id=vardeclsize></a></p>
<h3 id=size-hints><font style=vertical-align:inherit><font style=vertical-align:inherit>사이즈 힌트</font></font><a class=anchorjs-link href=#size-hints aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음은 용량을 사전 할당하기 위해 크기 힌트를 활용하는 선언입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=p>(</span>
    <span class=c>// Preferred buffer size for target filesystem: st_blksize.</span>
    <span class=n>buf</span> <span class=o>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=m>131072</span><span class=p>)</span>
    <span class=c>// Typically process up to 8-10 elements per run (16 is a safe assumption).</span>
    <span class=n>q</span> <span class=o>=</span> <span class=nb>make</span><span class=p>([]</span><span class=n>Node</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>16</span><span class=p>)</span>
    <span class=c>// Each shard processes shardSize (typically 32000+) elements.</span>
    <span class=n>seen</span> <span class=o>=</span> <span class=nb>make</span><span class=p>(</span><span class=k>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>bool</span><span class=p>,</span> <span class=n>shardSize</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>크기 힌트 및 사전 할당은 </font></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>코드 및 통합의 경험적 분석과 결합되어</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 성능에 민감하고 리소스 효율적인 코드를 생성하는 중요한 단계입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>대부분의 코드에는 크기 힌트나 사전 할당이 필요하지 않으며 필요에 따라 런타임에서 슬라이스나 맵을 늘릴 수 있습니다. 최종 크기가 알려진 경우(예: 맵과 슬라이스 간 변환 시) 미리 할당하는 것이 허용되지만 이는 가독성 요구 사항이 아니며 작은 경우 복잡해질 가치가 없을 수 있습니다.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>경고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 필요한 것보다 더 많은 메모리를 사전 할당하면 플릿의 메모리가 낭비되거나 성능이 저하될 수도 있습니다. 의심스러운 경우
 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #3: Go 코드 벤치마킹을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조 하고 기본값은
 </font></font><a href=#vardeclzero><font style=vertical-align:inherit><font style=vertical-align:inherit>0 초기화</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 또는
 </font></font><a href=#vardeclcomposite><font style=vertical-align:inherit><font style=vertical-align:inherit>복합 리터럴 선언</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 입니다 .</font></font></p>
<p><a id=decl-chan></a></p>
<h3 id=channel-direction><font style=vertical-align:inherit><font style=vertical-align:inherit>채널 방향</font></font><a class=anchorjs-link href=#channel-direction aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가능한 경우 </font></font><a href=https://go.dev/ref/spec#Channel_types><font style=vertical-align:inherit><font style=vertical-align:inherit>채널 방향을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 지정하십시오 .</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// sum computes the sum of all of the values. It reads from the channel until</span>
<span class=c>// the channel is closed.</span>
<span class=k>func</span> <span class=n>sum</span><span class=p>(</span><span class=n>values</span> <span class=o>&lt;-</span><span class=k>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이는 사양 없이 발생할 수 있는 일반적인 프로그래밍 오류를 방지합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>sum</span><span class=p>(</span><span class=n>values</span> <span class=k>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=p>(</span><span class=n>out</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span> <span class=n>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=n>values</span> <span class=p>{</span>
        <span class=n>out</span> <span class=o>+=</span> <span class=n>v</span>
    <span class=p>}</span>
    <span class=c>// values must already be closed for this code to be reachable, which means</span>
    <span class=c>// a second close triggers a panic.</span>
    <span class=nb>close</span><span class=p>(</span><span class=n>values</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>방향이 지정되면 컴파일러는 이와 같은 간단한 오류를 포착합니다. 또한 유형에 대한 소유권 척도를 전달하는 데 도움이 됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Bryan Mills의 강연 "고전적 동시성 패턴 재고":
 </font></font><a href="https://drive.google.com/file/d/1nPdvhB0PutEJzdCq5ms6UI58dp50fcAN/view?usp=sharing"><font style=vertical-align:inherit><font style=vertical-align:inherit>슬라이드 </font></font></a> <a href="https://www.youtube.com/watch?v=5zXAHh5tJqQ"><font style=vertical-align:inherit><font style=vertical-align:inherit>비디오</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 도 참조하세요 .</font></font></p>
<p><a id=funcargs></a></p>
<h2 id=function-argument-lists><font style=vertical-align:inherit><font style=vertical-align:inherit>함수 인수 목록</font></font><a class=anchorjs-link href=#function-argument-lists aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수의 서명이 너무 길어지지 않도록 하세요. 더 많은 매개변수가 함수에 추가될수록 개별 매개변수의 역할은 덜 명확해지고 동일한 유형의 인접한 매개변수는 혼동되기 쉬워집니다. 인수 수가 많은 함수는 기억하기 어렵고 호출 사이트에서 읽기가 더 어렵습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>API를 설계할 때, 서명이 복잡해지는 고도로 구성 가능한 함수를 여러 개의 더 간단한 함수로 분할하는 것을 고려하세요. 필요한 경우 (내보내지 않은) 구현을 공유할 수 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수에 많은 입력이 필요한 경우 </font><font style=vertical-align:inherit>
일부 인수에 대해 </font></font><a href=#option-structure><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 구조체를 도입하거나 고급 </font></font></a><font style=vertical-align:inherit></font><a href=#variadic-options><font style=vertical-align:inherit><font style=vertical-align:inherit>가변 옵션</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 
기술을 사용하는 것이 좋습니다. 어떤 전략을 선택할지에 대한 주요 고려 사항은 예상되는 모든 사용 사례에서 함수 호출이 어떻게 보이는가입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>아래 권장 사항은 주로 내보내지 않은 API보다 더 높은 표준이 적용되는 내보낸 API에 적용됩니다. 이러한 기술은 사용 사례에 불필요할 수 있습니다. 자신의 판단에 따라 </font></font><a href=https://google.github.io/styleguide/go/guide#clarity><font style=vertical-align:inherit><font style=vertical-align:inherit>명확성</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 과
 </font></font><a href=https://google.github.io/styleguide/go/guide#least-mechanism><font style=vertical-align:inherit><font style=vertical-align:inherit>최소 메커니즘</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 원칙의 균형을 맞추십시오 </font><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:
 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 팁 #24: 사례별 구성 사용</font></font></a></p>
<p><a id=option-structure></a></p>
<h3 id=option-structure><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 구조</font></font><a class=anchorjs-link href=#option-structure aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 구조는 함수나 메서드의 인수 중 일부 또는 전부를 수집한 다음 함수나 메서드에 마지막 인수로 전달되는 구조체 형식입니다. (구조체는 내보낸 함수에서 사용되는 경우에만 내보내야 합니다.)</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 구조를 사용하면 다음과 같은 여러 가지 이점이 있습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>구조체 리터럴에는 각 인수에 대한 필드와 값이 모두 포함되어 있어 자체 문서화가 가능하고 교체하기가 더 어렵습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>관련이 없거나 "기본" 필드는 생략할 수 있습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>호출자는 옵션 구조체를 공유하고 이에 대한 작업을 위한 도우미를 작성할 수 있습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>구조체는 함수 인수보다 더 깔끔한 필드별 문서를 제공합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 구조체는 호출 사이트에 영향을 주지 않고 시간이 지남에 따라 커질 수 있습니다.</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음은 개선할 수 있는 기능의 예입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>config</span> <span class=o>*</span><span class=n>replicator</span><span class=o>.</span><span class=n>Config</span><span class=p>,</span> <span class=n>primaryRegions</span><span class=p>,</span> <span class=n>readonlyRegions</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=n>replicateExisting</span><span class=p>,</span> <span class=n>overwritePolicies</span> <span class=kt>bool</span><span class=p>,</span> <span class=n>replicationInterval</span> <span class=n>time</span><span class=o>.</span><span class=n>Duration</span><span class=p>,</span> <span class=n>copyWorkers</span> <span class=kt>int</span><span class=p>,</span> <span class=n>healthWatcher</span> <span class=n>health</span><span class=o>.</span><span class=n>Watcher</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>위 함수는 다음과 같이 옵션 구조를 사용하여 다시 작성할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>type</span> <span class=n>ReplicationOptions</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=n>Config</span>              <span class=o>*</span><span class=n>replicator</span><span class=o>.</span><span class=n>Config</span>
    <span class=n>PrimaryRegions</span>      <span class=p>[]</span><span class=kt>string</span>
    <span class=n>ReadonlyRegions</span>     <span class=p>[]</span><span class=kt>string</span>
    <span class=n>ReplicateExisting</span>   <span class=kt>bool</span>
    <span class=n>OverwritePolicies</span>   <span class=kt>bool</span>
    <span class=n>ReplicationInterval</span> <span class=n>time</span><span class=o>.</span><span class=n>Duration</span>
    <span class=n>CopyWorkers</span>         <span class=kt>int</span>
    <span class=n>HealthWatcher</span>       <span class=n>health</span><span class=o>.</span><span class=n>Watcher</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>opts</span> <span class=n>ReplicationOptions</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그런 다음 다른 패키지에서 함수를 호출할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>foo</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// Complex call:</span>
    <span class=n>storage</span><span class=o>.</span><span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>storage</span><span class=o>.</span><span class=n>ReplicationOptions</span><span class=p>{</span>
        <span class=n>Config</span><span class=o>:</span>              <span class=n>config</span><span class=p>,</span>
        <span class=n>PrimaryRegions</span><span class=o>:</span>      <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"us-east1"</span><span class=p>,</span> <span class=s>"us-central2"</span><span class=p>,</span> <span class=s>"us-west3"</span><span class=p>},</span>
        <span class=n>ReadonlyRegions</span><span class=o>:</span>     <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"us-east5"</span><span class=p>,</span> <span class=s>"us-central6"</span><span class=p>},</span>
        <span class=n>OverwritePolicies</span><span class=o>:</span>   <span class=no>true</span><span class=p>,</span>
        <span class=n>ReplicationInterval</span><span class=o>:</span> <span class=m>1</span> <span class=o>*</span> <span class=n>time</span><span class=o>.</span><span class=n>Hour</span><span class=p>,</span>
        <span class=n>CopyWorkers</span><span class=o>:</span>         <span class=m>100</span><span class=p>,</span>
        <span class=n>HealthWatcher</span><span class=o>:</span>       <span class=n>watcher</span><span class=p>,</span>
    <span class=p>})</span><font></font>
<font></font>
    <span class=c>// Simple call:</span>
    <span class=n>storage</span><span class=o>.</span><span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>storage</span><span class=o>.</span><span class=n>ReplicationOptions</span><span class=p>{</span>
        <span class=n>Config</span><span class=o>:</span>         <span class=n>config</span><span class=p>,</span>
        <span class=n>PrimaryRegions</span><span class=o>:</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"us-east1"</span><span class=p>,</span> <span class=s>"us-central2"</span><span class=p>,</span> <span class=s>"us-west3"</span><span class=p>},</span>
    <span class=p>})</span>
<span class=p>}</span>
</code></pre></div></div>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고: </font></font></strong> <a href=https://google.github.io/styleguide/go/decisions#contexts><font style=vertical-align:inherit><font style=vertical-align:inherit>컨텍스트는 옵션 구조체에 포함되지 않습니다</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> .</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 옵션은 다음 중 일부가 적용될 때 선호되는 경우가 많습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>모든 호출자는 하나 이상의 옵션을 지정해야 합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>많은 수의 발신자가 다양한 옵션을 제공해야 합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션은 사용자가 호출할 여러 함수 간에 공유됩니다.</font></font></li>
</ul>
<p><a id=variadic-options></a></p>
<h3 id=variadic-options><font style=vertical-align:inherit><font style=vertical-align:inherit>가변 옵션</font></font><a class=anchorjs-link href=#variadic-options aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가변 옵션을 사용하면 함수의 </font></font><a href=https://golang.org/ref/spec#Passing_arguments_to_..._parameters><font style=vertical-align:inherit><font style=vertical-align:inherit>가변( </font></font><code class="language-plaintext highlighter-rouge">...</code><font style=vertical-align:inherit><font style=vertical-align:inherit>) 매개</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 변수 에 전달될 수 있는 클로저를 반환하는 내보낸 함수가 생성됩니다 . </font><font style=vertical-align:inherit>함수는 옵션 값(있는 경우)을 매개변수로 취하고, 반환된 클로저는 입력에 따라 업데이트되는 변경 가능한 참조(일반적으로 구조체 유형에 대한 포인터)를 허용합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가변 옵션을 사용하면 다음과 같은 여러 가지 이점을 얻을 수 있습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션은 구성이 필요하지 않을 때 호출 사이트에서 공간을 차지하지 않습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션은 여전히 ​​값이므로 호출자는 이를 공유하고, 도우미를 작성하고, 축적할 수 있습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션은 여러 매개변수를 허용할 수 있습니다(예: </font></font><code class="language-plaintext highlighter-rouge">cartesian.Translate(dx, dy
int) TransformOption</code><font style=vertical-align:inherit><font style=vertical-align:inherit>).</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 함수는 godoc에서 옵션을 함께 그룹화하기 위해 명명된 유형을 반환할 수 있습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지는 타사 패키지가 자체 옵션을 정의(또는 정의)하는 것을 허용(또는 방지)할 수 있습니다.</font></font></li>
</ul>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 가변 옵션을 사용하려면 상당한 양의 추가 코드가 필요하므로(다음 예 참조) 이점이 오버헤드보다 클 때만 사용해야 합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음은 개선할 수 있는 기능의 예입니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>config</span> <span class=o>*</span><span class=n>placer</span><span class=o>.</span><span class=n>Config</span><span class=p>,</span> <span class=n>primaryCells</span><span class=p>,</span> <span class=n>readonlyCells</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=n>replicateExisting</span><span class=p>,</span> <span class=n>overwritePolicies</span> <span class=kt>bool</span><span class=p>,</span> <span class=n>replicationInterval</span> <span class=n>time</span><span class=o>.</span><span class=n>Duration</span><span class=p>,</span> <span class=n>copyWorkers</span> <span class=kt>int</span><span class=p>,</span> <span class=n>healthWatcher</span> <span class=n>health</span><span class=o>.</span><span class=n>Watcher</span><span class=p>)</span> <span class=p>{</span>
  <span class=o>...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>위의 예는 다음과 같이 가변 옵션을 사용하여 다시 작성할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>type</span> <span class=n>replicationOptions</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=n>readonlyCells</span>       <span class=p>[]</span><span class=kt>string</span>
    <span class=n>replicateExisting</span>   <span class=kt>bool</span>
    <span class=n>overwritePolicies</span>   <span class=kt>bool</span>
    <span class=n>replicationInterval</span> <span class=n>time</span><span class=o>.</span><span class=n>Duration</span>
    <span class=n>copyWorkers</span>         <span class=kt>int</span>
    <span class=n>healthWatcher</span>       <span class=n>health</span><span class=o>.</span><span class=n>Watcher</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// A ReplicationOption configures EnableReplication.</span>
<span class=k>type</span> <span class=n>ReplicationOption</span> <span class=k>func</span><span class=p>(</span><span class=o>*</span><span class=n>replicationOptions</span><span class=p>)</span><font></font>
<font></font>
<span class=c>// ReadonlyCells adds additional cells that should additionally</span>
<span class=c>// contain read-only replicas of the data.</span>
<span class=c>//</span>
<span class=c>// Passing this option multiple times will add additional</span>
<span class=c>// read-only cells.</span>
<span class=c>//</span>
<span class=c>// Default: none</span>
<span class=k>func</span> <span class=n>ReadonlyCells</span><span class=p>(</span><span class=n>cells</span> <span class=o>...</span><span class=kt>string</span><span class=p>)</span> <span class=n>ReplicationOption</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>func</span><span class=p>(</span><span class=n>opts</span> <span class=o>*</span><span class=n>replicationOptions</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>opts</span><span class=o>.</span><span class=n>readonlyCells</span> <span class=o>=</span> <span class=nb>append</span><span class=p>(</span><span class=n>opts</span><span class=o>.</span><span class=n>readonlyCells</span><span class=p>,</span> <span class=n>cells</span><span class=o>...</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// ReplicateExisting controls whether files that already exist in the</span>
<span class=c>// primary cells will be replicated.  Otherwise, only newly-added</span>
<span class=c>// files will be candidates for replication.</span>
<span class=c>//</span>
<span class=c>// Passing this option again will overwrite earlier values.</span>
<span class=c>//</span>
<span class=c>// Default: false</span>
<span class=k>func</span> <span class=n>ReplicateExisting</span><span class=p>(</span><span class=n>enabled</span> <span class=kt>bool</span><span class=p>)</span> <span class=n>ReplicationOption</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>func</span><span class=p>(</span><span class=n>opts</span> <span class=o>*</span><span class=n>replicationOptions</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>opts</span><span class=o>.</span><span class=n>replicateExisting</span> <span class=o>=</span> <span class=n>enabled</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=c>// ... other options ...</span><font></font>
<font></font>
<span class=c>// DefaultReplicationOptions control the default values before</span>
<span class=c>// applying options passed to EnableReplication.</span>
<span class=k>var</span> <span class=n>DefaultReplicationOptions</span> <span class=o>=</span> <span class=p>[]</span><span class=n>ReplicationOption</span><span class=p>{</span>
    <span class=n>OverwritePolicies</span><span class=p>(</span><span class=no>true</span><span class=p>),</span>
    <span class=n>ReplicationInterval</span><span class=p>(</span><span class=m>12</span> <span class=o>*</span> <span class=n>time</span><span class=o>.</span><span class=n>Hour</span><span class=p>),</span>
    <span class=n>CopyWorkers</span><span class=p>(</span><span class=m>10</span><span class=p>),</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>config</span> <span class=o>*</span><span class=n>placer</span><span class=o>.</span><span class=n>Config</span><span class=p>,</span> <span class=n>primaryCells</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=n>opts</span> <span class=o>...</span><span class=n>ReplicationOption</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>var</span> <span class=n>options</span> <span class=n>replicationOptions</span>
    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>opt</span> <span class=o>:=</span> <span class=k>range</span> <span class=n>DefaultReplicationOptions</span> <span class=p>{</span>
        <span class=n>opt</span><span class=p>(</span><span class=o>&amp;</span><span class=n>options</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>opt</span> <span class=o>:=</span> <span class=k>range</span> <span class=n>opts</span> <span class=p>{</span>
        <span class=n>opt</span><span class=p>(</span><span class=o>&amp;</span><span class=n>options</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그런 다음 다른 패키지에서 함수를 호출할 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>foo</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// Complex call:</span>
    <span class=n>storage</span><span class=o>.</span><span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>config</span><span class=p>,</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"po"</span><span class=p>,</span> <span class=s>"is"</span><span class=p>,</span> <span class=s>"ea"</span><span class=p>},</span>
        <span class=n>storage</span><span class=o>.</span><span class=n>ReadonlyCells</span><span class=p>(</span><span class=s>"ix"</span><span class=p>,</span> <span class=s>"gg"</span><span class=p>),</span>
        <span class=n>storage</span><span class=o>.</span><span class=n>OverwritePolicies</span><span class=p>(</span><span class=no>true</span><span class=p>),</span>
        <span class=n>storage</span><span class=o>.</span><span class=n>ReplicationInterval</span><span class=p>(</span><span class=m>1</span><span class=o>*</span><span class=n>time</span><span class=o>.</span><span class=n>Hour</span><span class=p>),</span>
        <span class=n>storage</span><span class=o>.</span><span class=n>CopyWorkers</span><span class=p>(</span><span class=m>100</span><span class=p>),</span>
        <span class=n>storage</span><span class=o>.</span><span class=n>HealthWatcher</span><span class=p>(</span><span class=n>watcher</span><span class=p>),</span>
    <span class=p>)</span><font></font>
<font></font>
    <span class=c>// Simple call:</span>
    <span class=n>storage</span><span class=o>.</span><span class=n>EnableReplication</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>config</span><span class=p>,</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"po"</span><span class=p>,</span> <span class=s>"is"</span><span class=p>,</span> <span class=s>"ea"</span><span class=p>})</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음 중 다수가 적용되는 경우 이 옵션을 선호합니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>대부분의 호출자는 어떤 옵션도 지정할 필요가 없습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>대부분의 옵션은 자주 사용되지 않습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>많은 옵션이 있습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션에는 인수가 필요합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션이 실패하거나 잘못 설정될 수 있습니다(이 경우 옵션 함수가 를 반환함 </font></font><code class="language-plaintext highlighter-rouge">error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>).</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션에는 구조체에 맞추기 어려울 수 있는 많은 문서가 필요합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자 또는 다른 패키지는 사용자 정의 옵션을 제공할 수 있습니다.</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 스타일의 옵션은 값을 알리기 위해 존재 여부를 사용하는 대신 매개변수를 허용해야 합니다. 후자는 주장의 동적 구성을 훨씬 더 어렵게 만들 수 있습니다. 예를 들어 바이너리 설정은 부울을 허용해야 합니다(예:
 </font></font><code class="language-plaintext highlighter-rouge">rpc.FailFast(enable bool)</code><font style=vertical-align:inherit><font style=vertical-align:inherit>가 바람직함 </font></font><code class="language-plaintext highlighter-rouge">rpc.EnableFailFast()</code><font style=vertical-align:inherit><font style=vertical-align:inherit>). 열거 옵션은 열거 상수를 허용해야 합니다(예:
 </font></font><code class="language-plaintext highlighter-rouge">log.Format(log.Capacitor)</code><font style=vertical-align:inherit><font style=vertical-align:inherit>보다 바람직함 </font></font><code class="language-plaintext highlighter-rouge">log.CapacitorFormat()</code><font style=vertical-align:inherit><font style=vertical-align:inherit>). 대안은 전달할 옵션을 프로그래밍 방식으로 선택해야 하는 사용자에게 훨씬 더 어렵습니다. 이러한 사용자는 단순히 옵션에 대한 인수를 변경하는 것이 아니라 매개변수의 실제 구성을 변경해야 합니다. 모든 사용자가 전체 옵션 세트를 정적으로 알고 있다고 가정하지 마십시오.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적으로 옵션은 순서대로 처리되어야 합니다. 충돌이 있거나 비누적 옵션이 여러 번 전달되는 경우 마지막 인수가 승리해야 합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>옵션 함수에 대한 매개변수는 일반적으로 이 패턴에서 내보내지지 않으며 옵션이 패키지 자체 내에서만 정의되도록 제한합니다. 다른 패키지가 옵션을 정의하도록 허용하는 것이 적절한 경우가 있을 수 있지만 이는 좋은 기본값입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 옵션을 어떻게 사용할 수 있는지에 대한 자세한 내용은 </font></font><a href=http://commandcenter.blogspot.com/2014/01/self-referential-functions-and-design.html><font style=vertical-align:inherit><font style=vertical-align:inherit>Rob Pike의 원래 블로그 게시물</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 과 </font></font><a href=https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis><font style=vertical-align:inherit><font style=vertical-align:inherit>Dave Cheney의 강연을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 .</font></font></p>
<p><a id=complex-clis></a></p>
<h2 id=complex-command-line-interfaces><font style=vertical-align:inherit><font style=vertical-align:inherit>복잡한 명령줄 인터페이스</font></font><a class=anchorjs-link href=#complex-command-line-interfaces aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일부 프로그램은 사용자에게 하위 명령이 포함된 풍부한 명령줄 인터페이스를 제공하려고 합니다. 예를 들어, </font></font><code class="language-plaintext highlighter-rouge">kubectl create</code><font style=vertical-align:inherit><font style=vertical-align:inherit>, </font></font><code class="language-plaintext highlighter-rouge">kubectl run</code><font style=vertical-align:inherit><font style=vertical-align:inherit>및 기타 여러 하위 명령은 모두 프로그램에서 제공됩니다 </font></font><code class="language-plaintext highlighter-rouge">kubectl</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 이를 달성하기 위해 일반적으로 사용되는 최소한 다음 라이브러리가 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>선호하는 것이 없거나 다른 고려 사항이 동일하다면 </font></font><a href=https://pkg.go.dev/github.com/google/subcommands><font style=vertical-align:inherit><font style=vertical-align:inherit>하위 명령이</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 
권장됩니다. 하위 명령이 가장 간단하고 올바르게 사용하기 쉽기 때문입니다. 그러나 제공되지 않는 다른 기능이 필요한 경우 다른 옵션 중 하나를 선택하세요.</font></font></p>
<ul>
 <li>
 <p><strong><a href=https://pkg.go.dev/github.com/spf13/cobra><font style=vertical-align:inherit><font style=vertical-align:inherit>코브라</font></font></a></strong></p>
 <ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>플래그 규칙: getopt</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>Google 코드베이스 외부에서는 일반적입니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>많은 추가 기능.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>사용법의 함정(아래 참조)</font></font></li>
 </ul>
 </li>
 <li>
 <p><strong><a href=https://pkg.go.dev/github.com/google/subcommands><font style=vertical-align:inherit><font style=vertical-align:inherit>하위 명령</font></font></a></strong></p>
 <ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>플래그 컨벤션: 이동</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>간단하고 올바르게 사용하기 쉽습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>추가 기능이 필요하지 않은 경우 권장됩니다.</font></font></li>
 </ul>
 </li>
</ul>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>경고</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> : cobra 명령 함수는 를 사용하여 </font></font><code class="language-plaintext highlighter-rouge">cmd.Context()</code><font style=vertical-align:inherit><font style=vertical-align:inherit>자체 루트 컨텍스트를 생성하는 대신 컨텍스트를 얻기 위해 사용해야 합니다 </font></font><code class="language-plaintext highlighter-rouge">context.Background</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 하위 명령 패키지를 사용하는 코드는 이미 함수 매개변수로 올바른 컨텍스트를 받습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>각 하위 명령을 별도의 패키지에 배치할 필요는 없으며, 그렇게 할 필요가 없는 경우도 많습니다. Go 코드베이스에서와 마찬가지로 패키지 경계에 대해 동일한 고려 사항을 적용합니다. 코드를 라이브러리와 바이너리로 모두 사용할 수 있는 경우 일반적으로 CLI 코드와 라이브러리를 분리하여 CLI를 하나 이상의 클라이언트로 만드는 것이 좋습니다. (하위 명령이 있는 CLI에만 해당되는 것은 아니지만 일반적으로 나타나는 위치이기 때문에 여기서는 언급합니다.)</font></font></p>
<p><a id=tests></a></p>
<h2 id=tests><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트</font></font><a class=anchorjs-link href=#tests aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><a id=test-functions></a></p>
<h3 id=leave-testing-to-the-test-function><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트는 함수 </font><font style=vertical-align:inherit>에 맡기세요</font></font><a class=anchorjs-link href=#leave-testing-to-the-test-function aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go는 "테스트 도우미"와 "어설션 도우미"를 구별합니다.</font></font></p>
<ul>
 <li>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 헬퍼는</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 설정 또는 정리 작업을 수행하는 함수입니다. 테스트 헬퍼에서 발생하는 모든 실패는 환경의 실패(테스트 중인 코드의 실패가 아님)로 예상됩니다. 예를 들어, 이 머신에 더 이상 사용 가능한 포트가 없어서 테스트 데이터베이스를 시작할 수 없는 경우입니다. 이러한 함수의 경우 호출하여 </font><a href=https://google.github.io/styleguide/go/decisions#mark-test-helpers><font style=vertical-align:inherit>테스트 헬퍼로 표시하는</font></a></font><code class="language-plaintext highlighter-rouge">t.Helper</code><font style=vertical-align:inherit><font style=vertical-align:inherit> 것이 종종 적절합니다
 </font><font style=vertical-align:inherit>. </font><font style=vertical-align:inherit>자세한 내용은 </font><a href=#test-helper-error-handling><font style=vertical-align:inherit>테스트 헬퍼의 오류 처리를 참조하세요.</font></a></font><a href=https://google.github.io/styleguide/go/decisions#mark-test-helpers><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font><a href=#test-helper-error-handling><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
 </li>
 <li>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>어설션 도우미는</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 시스템의 정확성을 확인하고 기대치가 충족되지 않으면 테스트에 실패하는 기능입니다. 어설션 도우미는
 </font><font style=vertical-align:inherit>Go에서 </font></font><a href=https://google.github.io/styleguide/go/decisions#assert><font style=vertical-align:inherit><font style=vertical-align:inherit>관용적인 것으로 간주되지 않습니다 .</font></font></a><font style=vertical-align:inherit></font></p>
 </li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트의 목적은 테스트 중인 코드의 통과/실패 조건을 보고하는 것입니다. 테스트에 실패하는 이상적인 위치는 </font></font><code class="language-plaintext highlighter-rouge">Test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>함수 자체 내입니다. 함수 자체 에서는 </font></font><a href=https://google.github.io/styleguide/go/decisions#useful-test-failures><font style=vertical-align:inherit><font style=vertical-align:inherit>실패 메시지</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 와 테스트 논리가 명확해집니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 코드가 커짐에 따라 일부 기능을 분리하여 기능을 분리해야 할 수도 있습니다. </font></font><em><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 코드는 여전히 code</font></font></em><font style=vertical-align:inherit><font style=vertical-align:inherit> 이므로 표준 소프트웨어 엔지니어링 고려 사항이 여전히 적용됩니다 </font><font style=vertical-align:inherit>. 기능이 테스트 프레임워크와 상호 작용하지 않으면 일반적인 규칙이 모두 적용됩니다. 그러나 공통 코드가 프레임워크와 상호 작용할 때 정보가 없는 실패 메시지와 유지 관리할 수 없는 테스트로 이어질 수 있는 일반적인 함정을 피하기 위해 약간의 주의를 기울여야 합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>여러 개별 테스트 사례에 동일한 유효성 검사 논리가 필요한 경우 어설션 도우미나 복잡한 유효성 검사 기능을 사용하는 대신 다음 방법 중 하나로 테스트를 정렬하세요.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
반복되는 경우에도 함수 </font><font style=vertical-align:inherit>에 논리(검증 및 실패 모두)를 인라인하세요 . </font><font style=vertical-align:inherit>이는 간단한 경우에 가장 잘 작동합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>입력이 유사한 경우 </font><font style=vertical-align:inherit>
루프에 인라인된 논리를 유지하면서 입력을 </font></font><a href=https://google.github.io/styleguide/go/decisions#table-driven-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>테이블 기반 테스트</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 로 통합하는 것을 고려하십시오. 이는 검증 및 실패를 유지하면서 반복을 방지하는 데 도움이 됩니다 </font></font><code class="language-plaintext highlighter-rouge">Test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>동일한 유효성 검사 함수가 필요한 여러 호출자가 있지만 테이블 테스트가 적합하지 않은 경우(일반적으로 입력이 충분히 간단하지 않거나 일련의 작업의 일부로 유효성 검사가 필요하기 때문에) 값을 반환하도록 유효성 검사 함수를 배열합니다. (일반적으로
 </font></font><code class="language-plaintext highlighter-rouge">error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>) 매개변수를 가져와서 </font></font><code class="language-plaintext highlighter-rouge">testing.T</code><font style=vertical-align:inherit><font style=vertical-align:inherit>이를 사용하여 테스트에 실패하는 것입니다. </font></font><code class="language-plaintext highlighter-rouge">Test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>실패 여부를 결정하고
 </font></font><a href=https://google.github.io/styleguide/go/decisions#useful-test-failures><font style=vertical-align:inherit><font style=vertical-align:inherit>유용한 테스트 실패를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 제공하려면 내부 논리를 사용하십시오 </font><font style=vertical-align:inherit>. 일반적인 상용구 설정 코드를 제외하기 위해 테스트 도우미를 만들 수도 있습니다.</font></font></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>마지막 지점에 설명된 디자인은 직교성을 유지합니다. 예를 들어
 </font></font><a href=https://pkg.go.dev/github.com/google/go-cmp/cmp><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지는</font></font><code class="language-plaintext highlighter-rouge">cmp</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 테스트에 실패하도록 설계되지 않고 값을 비교(및 차이점)하도록 설계되었습니다. 따라서 호출자가 제공할 수 있으므로 비교가 이루어진 컨텍스트에 대해 알 필요가 없습니다. 일반적인 테스트 코드가 </font></font><code class="language-plaintext highlighter-rouge">cmp.Transformer</code><font style=vertical-align:inherit><font style=vertical-align:inherit>데이터 유형에 대한 을 제공하는 경우 이는 종종 가장 간단한 디자인일 수 있습니다. 다른 유효성 검사의 경우 </font></font><code class="language-plaintext highlighter-rouge">error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>값 반환을 고려하세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// polygonCmp returns a cmp.Option that equates s2 geometry objects up to</span>
<span class=c>// some small floating-point error.</span>
<span class=k>func</span> <span class=n>polygonCmp</span><span class=p>()</span> <span class=n>cmp</span><span class=o>.</span><span class=n>Option</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>cmp</span><span class=o>.</span><span class=n>Options</span><span class=p>{</span>
        <span class=n>cmp</span><span class=o>.</span><span class=n>Transformer</span><span class=p>(</span><span class=s>"polygon"</span><span class=p>,</span> <span class=k>func</span><span class=p>(</span><span class=n>p</span> <span class=o>*</span><span class=n>s2</span><span class=o>.</span><span class=n>Polygon</span><span class=p>)</span> <span class=p>[]</span><span class=o>*</span><span class=n>s2</span><span class=o>.</span><span class=n>Loop</span> <span class=p>{</span> <span class=k>return</span> <span class=n>p</span><span class=o>.</span><span class=n>Loops</span><span class=p>()</span> <span class=p>}),</span>
        <span class=n>cmp</span><span class=o>.</span><span class=n>Transformer</span><span class=p>(</span><span class=s>"loop"</span><span class=p>,</span> <span class=k>func</span><span class=p>(</span><span class=n>l</span> <span class=o>*</span><span class=n>s2</span><span class=o>.</span><span class=n>Loop</span><span class=p>)</span> <span class=p>[]</span><span class=n>s2</span><span class=o>.</span><span class=n>Point</span> <span class=p>{</span> <span class=k>return</span> <span class=n>l</span><span class=o>.</span><span class=n>Vertices</span><span class=p>()</span> <span class=p>}),</span>
        <span class=n>cmpopts</span><span class=o>.</span><span class=n>EquateApprox</span><span class=p>(</span><span class=m>0.00000001</span><span class=p>,</span> <span class=m>0</span><span class=p>),</span>
        <span class=n>cmpopts</span><span class=o>.</span><span class=n>EquateEmpty</span><span class=p>(),</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestFenceposts</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// This is a test for a fictional function, Fenceposts, which draws a fence</span>
    <span class=c>// around some Place object. The details are not important, except that</span>
    <span class=c>// the result is some object that has s2 geometry (github.com/golang/geo/s2)</span>
    <span class=n>got</span> <span class=o>:=</span> <span class=n>Fencepost</span><span class=p>(</span><span class=n>tomsDiner</span><span class=p>,</span> <span class=m>1</span><span class=o>*</span><span class=n>meter</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>diff</span> <span class=o>:=</span> <span class=n>cmp</span><span class=o>.</span><span class=n>Diff</span><span class=p>(</span><span class=n>want</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>polygonCmp</span><span class=p>());</span> <span class=n>diff</span> <span class=o>!=</span> <span class=s>""</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"Fencepost(tomsDiner, 1m) returned unexpected diff (-want+got):</span><span class=se>\n</span><span class=s>%v"</span><span class=p>,</span> <span class=n>diff</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>FuzzFencepost</span><span class=p>(</span><span class=n>f</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>F</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// Fuzz test (https://go.dev/doc/fuzz) for the same.</span><font></font>
<font></font>
    <span class=n>f</span><span class=o>.</span><span class=n>Add</span><span class=p>(</span><span class=n>tomsDiner</span><span class=p>,</span> <span class=m>1</span><span class=o>*</span><span class=n>meter</span><span class=p>)</span>
    <span class=n>f</span><span class=o>.</span><span class=n>Add</span><span class=p>(</span><span class=n>school</span><span class=p>,</span> <span class=m>3</span><span class=o>*</span><span class=n>meter</span><span class=p>)</span><font></font>
<font></font>
    <span class=n>f</span><span class=o>.</span><span class=n>Fuzz</span><span class=p>(</span><span class=k>func</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>geo</span> <span class=n>Place</span><span class=p>,</span> <span class=n>padding</span> <span class=n>Length</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>got</span> <span class=o>:=</span> <span class=n>Fencepost</span><span class=p>(</span><span class=n>geo</span><span class=p>,</span> <span class=n>padding</span><span class=p>)</span>
        <span class=c>// Simple reference implementation: not used in prod, but easy to</span>
        <span class=c>// reason about and therefore useful to check against in random tests.</span>
        <span class=n>reference</span> <span class=o>:=</span> <span class=n>slowFencepost</span><span class=p>(</span><span class=n>geo</span><span class=p>,</span> <span class=n>padding</span><span class=p>)</span><font></font>
<font></font>
        <span class=c>// In the fuzz test, inputs and outputs can be large so don't</span>
        <span class=c>// bother with printing a diff. cmp.Equal is enough.</span>
        <span class=k>if</span> <span class=o>!</span><span class=n>cmp</span><span class=o>.</span><span class=n>Equal</span><span class=p>(</span><span class=n>got</span><span class=p>,</span> <span class=n>reference</span><span class=p>,</span> <span class=n>polygonCmp</span><span class=p>())</span> <span class=p>{</span>
            <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"Fencepost returned wrong placement"</span><span class=p>)</span>
        <span class=p>}</span>
    <span class=p>})</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>함수는 </font></font><code class="language-plaintext highlighter-rouge">polygonCmp</code><font style=vertical-align:inherit><font style=vertical-align:inherit>호출 방법에 대해 불가지론적입니다. 구체적인 입력 유형을 취하지 않으며 두 개체가 일치하지 않는 경우 수행할 작업을 감시하지도 않습니다. 따라서 더 많은 발신자가 이를 활용할 수 있습니다.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 테스트 도우미와 일반 라이브러리 코드 사이에는 유사점이 있습니다. 라이브러리의 코드는 </font><font style=vertical-align:inherit>드문 경우를 제외하고는 일반적으로 </font></font><a href=https://google.github.io/styleguide/go/decisions#dont-panic><font style=vertical-align:inherit><font style=vertical-align:inherit>당황하지 않아야</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 합니다. 테스트에서 호출된 코드는
 </font></font><a href=#t-fatal><font style=vertical-align:inherit><font style=vertical-align:inherit>계속 진행할 필요가 없는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 한 테스트를 중지해서는 안 됩니다 .</font></font></p>
<p><a id=test-validation-apis></a></p>
<h3 id=designing-extensible-validation-apis><font style=vertical-align:inherit><font style=vertical-align:inherit>확장 가능한 검증 API 설계</font></font><a class=anchorjs-link href=#designing-extensible-validation-apis aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>스타일 가이드에서 테스트에 대한 조언의 대부분은 자신의 코드를 테스트하는 것에 관한 것입니다. 이 섹션은 다른 사람들이 작성한 코드를 테스트하여 라이브러리 요구 사항을 준수하는지 확인하는 방법을 제공합니다.</font></font></p>
<p><a id=test-validation-apis-what></a></p>
<h4 id=acceptance-testing><font style=vertical-align:inherit><font style=vertical-align:inherit>승인 테스트</font></font><a class=anchorjs-link href=#acceptance-testing aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit></font><a href=https://en.wikipedia.org/wiki/Acceptance_testing><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 테스트를 승인 테스트</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 라고 합니다 </font><font style=vertical-align:inherit>. 이런 종류의 테스트의 전제는 테스트를 사용하는 사람이 테스트에서 진행되는 모든 세부 사항을 알지 못한다는 것입니다. 그들은 작업을 수행하기 위해 테스트 시설에 입력을 넘겨주기만 하면 됩니다. 이는 </font></font><a href=https://en.wikipedia.org/wiki/Inversion_of_control><font style=vertical-align:inherit><font style=vertical-align:inherit>통제 역전</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 의 한 형태로 간주될 수 있습니다 </font><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적인 Go 테스트에서 테스트 기능은 프로그램 흐름을 제어하며,
 </font></font><a href=https://google.github.io/styleguide/go/decisions#assert><font style=vertical-align:inherit><font style=vertical-align:inherit>어설션 없음</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 및 </font></font><a href=#test-functions><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 기능</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 지침은 이를 유지하도록 권장합니다. 이 섹션에서는 Go 스타일과 일치하는 방식으로 이러한 테스트에 대한 지원을 작성하는 방법을 설명합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>방법을 알아보기 전에 </font></font><a href=https://pkg.go.dev/io/fs><code class="language-plaintext highlighter-rouge">io/fs</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>아래에서 발췌한 예를 살펴보세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>type</span> <span class=n>FS</span> <span class=k>interface</span> <span class=p>{</span>
    <span class=n>Open</span><span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=n>File</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>잘 알려진 구현이 존재하지만 </font></font><code class="language-plaintext highlighter-rouge">fs.FS</code><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 개발자는 이를 작성해야 할 수도 있습니다. 사용자가 구현한 것이 </font></font><code class="language-plaintext highlighter-rouge">fs.FS</code><font style=vertical-align:inherit><font style=vertical-align:inherit>올바른지 확인하는 데 도움이 되도록 일반 라이브러리 </font></font><a href=https://pkg.go.dev/testing/fstest><code class="language-plaintext highlighter-rouge">testing/fstest</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>가
 </font></font><a href=https://pkg.go.dev/testing/fstest#TestFS><code class="language-plaintext highlighter-rouge">fstest.TestFS</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>. 이 API는 구현을 블랙박스로 처리하여 계약의 가장 기본적인 부분을 유지하는지 확인합니다 </font></font><code class="language-plaintext highlighter-rouge">io/fs</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><a id=test-validation-apis-writing></a></p>
<h4 id=writing-an-acceptance-test><font style=vertical-align:inherit><font style=vertical-align:inherit>승인 테스트 작성</font></font><a class=anchorjs-link href=#writing-an-acceptance-test aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이제 승인 테스트가 무엇인지, 왜 사용해야 하는지 알았으니 </font></font><code class="language-plaintext highlighter-rouge">package chess</code><font style=vertical-align:inherit><font style=vertical-align:inherit>체스 게임을 시뮬레이션하는 데 사용되는 패키지인 에 대한 승인 테스트를 구축하는 방법을 살펴보겠습니다. 의 사용자는 인터페이스 </font></font><code class="language-plaintext highlighter-rouge">chess</code><font style=vertical-align:inherit><font style=vertical-align:inherit>를 구현해야 합니다
 </font></font><code class="language-plaintext highlighter-rouge">chess.Player</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 이러한 구현은 우리가 검증할 주요 사항입니다. 우리의 승인 테스트는 움직임이 현명한지 여부가 아니라 플레이어 구현이 합법적인 움직임을 만드는지 여부에 중점을 둡니다.</font></font></p>
<ol>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 이름에 단어를 추가하여
 </font></font><a href=#naming-doubles-helper-package><font style=vertical-align:inherit><font style=vertical-align:inherit>관례적으로 명명된</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 유효성 검사 동작을 위한 새 패키지를 만듭니다
 </font></font><code class="language-plaintext highlighter-rouge">test</code><font style=vertical-align:inherit><font style=vertical-align:inherit>(예: </font></font><code class="language-plaintext highlighter-rouge">chesstest</code><font style=vertical-align:inherit><font style=vertical-align:inherit>).</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 중인 구현을 인수로 받아서 검증을 수행하는 함수를 만들고 이를 실행합니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// ExercisePlayer tests a Player implementation in a single turn on a board.</span>
<span class=c>// The board itself is spot checked for sensibility and correctness.</span>
<span class=c>//</span>
<span class=c>// It returns a nil error if the player makes a correct move in the context</span>
<span class=c>// of the provided board. Otherwise ExercisePlayer returns one of this</span>
<span class=c>// package's errors to indicate how and why the player failed the</span>
<span class=c>// validation.</span>
<span class=k>func</span> <span class=n>ExercisePlayer</span><span class=p>(</span><span class=n>b</span> <span class=o>*</span><span class=n>chess</span><span class=o>.</span><span class=n>Board</span><span class=p>,</span> <span class=n>p</span> <span class=n>chess</span><span class=o>.</span><span class=n>Player</span><span class=p>)</span> <span class=kt>error</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트에서는 어떤 불변성이 어떻게 깨졌는지 기록해야 합니다. 설계에서는 오류 보고를 위한 두 가지 분야 중에서 선택할 수 있습니다.</font></font></p>
 <ul>
 <li>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>빠른 실패</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> : 구현이 불변성을 위반하는 즉시 오류를 반환합니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>이는 가장 간단한 접근 방식이며 승인 테스트가 빠르게 실행될 것으로 예상되는 경우 잘 작동합니다. 여기서는 </font><font style=vertical-align:inherit>간단한 오류 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>센티널</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 과
 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자 정의 유형을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 쉽게 사용할 수 있으며, 반대로 승인 테스트 테스트도 쉬워집니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>for</span> <span class=n>color</span><span class=p>,</span> <span class=n>army</span> <span class=o>:=</span> <span class=k>range</span> <span class=n>b</span><span class=o>.</span><span class=n>Armies</span> <span class=p>{</span>
    <span class=c>// The king should never leave the board, because the game ends at</span>
    <span class=c>// checkmate.</span>
    <span class=k>if</span> <span class=n>army</span><span class=o>.</span><span class=n>King</span> <span class=o>==</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=o>&amp;</span><span class=n>MissingPieceError</span><span class=p>{</span><span class=n>Color</span><span class=o>:</span> <span class=n>color</span><span class=p>,</span> <span class=n>Piece</span><span class=o>:</span> <span class=n>chess</span><span class=o>.</span><span class=n>King</span><span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>모든 실패를 집계합니다</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> . 모든 실패를 수집하여 모두 보고합니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 접근 방식은 느낌에 대한 </font></font><a href=https://google.github.io/styleguide/go/decisions#keep-going><font style=vertical-align:inherit><font style=vertical-align:inherit>지속적인</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 지침과 유사하며 수용 테스트가 느리게 실행될 것으로 예상되는 경우 더 바람직할 수 있습니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>실패를 집계하는 방법은 사용자에게 개별 실패를 조사할 수 있는 능력을 제공할 것인지 아니면 자신에게 부여할 것인지에 따라 결정되어야 합니다(예: 승인 테스트를 테스트하기 위해). 아래에서는 </font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit>오류를 집계</font></a><font style=vertical-align:inherit> 하는
 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자 정의 오류 유형을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용하는 방법을 보여줍니다 .</font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>var</span> <span class=n>badMoves</span> <span class=p>[]</span><span class=kt>error</span><font></font>
<font></font>
<span class=n>move</span> <span class=o>:=</span> <span class=n>p</span><span class=o>.</span><span class=n>Move</span><span class=p>()</span>
<span class=k>if</span> <span class=n>putsOwnKingIntoCheck</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>move</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>badMoves</span> <span class=o>=</span> <span class=nb>append</span><span class=p>(</span><span class=n>badMoves</span><span class=p>,</span> <span class=n>PutsSelfIntoCheckError</span><span class=p>{</span><span class=n>Move</span><span class=o>:</span> <span class=n>move</span><span class=p>})</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>badMoves</span><span class=p>)</span> <span class=o>&gt;</span> <span class=m>0</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>SimulationError</span><span class=p>{</span><span class=n>BadMoves</span><span class=o>:</span> <span class=n>badMoves</span><span class=p>}</span>
<span class=p>}</span>
<span class=k>return</span> <span class=no>nil</span>
</code></pre></div> </div>
 </li>
 </ul>
 </li>
</ol>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>승인 테스트는 </font><font style=vertical-align:inherit>테스트가 실행 중인 시스템에서 손상된 불변성을 감지하지 않는 한 </font><font style=vertical-align:inherit>호출하지 않음 으로써 </font></font><a href=https://google.github.io/styleguide/go/decisions#keep-going><font style=vertical-align:inherit><font style=vertical-align:inherit>계속 진행 지침을 준수해야 합니다.</font></font></a><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>예를 들어 평소와 같이 </font><a href=#test-helper-error-handling><font style=vertical-align:inherit>설정 실패</font></a></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit> 와 같은 예외적인 경우를 위해 예약되어야 합니다
 </font><font style=vertical-align:inherit>.</font></font><a href=#test-helper-error-handling><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>func</span> <span class=n>ExerciseGame</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>cfg</span> <span class=o>*</span><span class=n>Config</span><span class=p>,</span> <span class=n>p</span> <span class=n>chess</span><span class=o>.</span><span class=n>Player</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=n>t</span><span class=o>.</span><span class=n>Helper</span><span class=p>()</span><font></font>
<font></font>
    <span class=k>if</span> <span class=n>cfg</span><span class=o>.</span><span class=n>Simulation</span> <span class=o>==</span> <span class=n>Modem</span> <span class=p>{</span>
        <span class=n>conn</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>modempool</span><span class=o>.</span><span class=n>Allocate</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
            <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"No modem for the opponent could be provisioned: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
        <span class=p>}</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Cleanup</span><span class=p>(</span><span class=k>func</span><span class=p>()</span> <span class=p>{</span> <span class=n>modempool</span><span class=o>.</span><span class=n>Return</span><span class=p>(</span><span class=n>conn</span><span class=p>)</span> <span class=p>})</span>
    <span class=p>}</span>
    <span class=c>// Run acceptance test (a whole game).</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 기술은 간결하고 표준적인 유효성 검사를 만드는 데 도움이 될 수 있습니다. 그러나 </font></font><a href=https://google.github.io/styleguide/go/decisions#assert><font style=vertical-align:inherit><font style=vertical-align:inherit>어설션에 대한 지침을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 우회하기 위해 이를 사용하려고 시도하지 마십시오 </font><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>최종 제품은 최종 사용자에게 다음과 유사한 형식이어야 합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>deepblue_test</span><font></font>
<font></font>
<span class=k>import</span> <span class=p>(</span>
    <span class=s>"chesstest"</span>
    <span class=s>"deepblue"</span>
<span class=p>)</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestAcceptance</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>player</span> <span class=o>:=</span> <span class=n>deepblue</span><span class=o>.</span><span class=n>New</span><span class=p>()</span>
    <span class=n>err</span> <span class=o>:=</span> <span class=n>chesstest</span><span class=o>.</span><span class=n>ExerciseGame</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>chesstest</span><span class=o>.</span><span class=n>SimpleGame</span><span class=p>,</span> <span class=n>player</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"Deep Blue player failed acceptance test: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><a id=use-real-transports></a></p>
<h3 id=use-real-transports><font style=vertical-align:inherit><font style=vertical-align:inherit>실제 교통수단을 이용하세요</font></font><a class=anchorjs-link href=#use-real-transports aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>구성 요소 통합을 테스트할 때, 특히 HTTP 또는 RPC가 구성 요소 간의 기본 전송으로 사용되는 경우 실제 기본 전송을 사용하여 백엔드의 테스트 버전에 연결하는 것이 좋습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>예를 들어, 테스트하려는 코드(때때로 "테스트 대상 시스템" 또는 SUT라고도 함)가
 </font></font><a href=https://pkg.go.dev/google.golang.org/genproto/googleapis/longrunning><font style=vertical-align:inherit><font style=vertical-align:inherit>장기 실행 작업</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> API를 구현하는 백엔드와 상호 작용한다고 가정해 보겠습니다. SUT를 테스트하려면 </font><a href=https://pkg.go.dev/google.golang.org/genproto/googleapis/longrunning#OperationsServer><font style=vertical-align:inherit>OperationsServer 의 </font></a><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit>테스트 더블</font></a><font style=vertical-align:inherit> 
(예: 모의, 스텁 또는 가짜) </font><font style=vertical-align:inherit>
에 연결된
 실제 </font></font><a href=https://pkg.go.dev/google.golang.org/genproto/googleapis/longrunning#OperationsClient><font style=vertical-align:inherit><font style=vertical-align:inherit>OperationsClient를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용하세요 .</font></font><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font><a href=https://pkg.go.dev/google.golang.org/genproto/googleapis/longrunning#OperationsServer><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>클라이언트 동작을 올바르게 모방하는 것은 복잡하기 때문에 클라이언트를 직접 구현하는 것보다 이 방법을 사용하는 것이 좋습니다. 테스트 전용 서버와 함께 프로덕션 클라이언트를 사용하면 테스트에서 실제 코드를 최대한 많이 사용하고 있는지 확인할 수 있습니다.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>팁:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 가능하다면 테스트 중인 서비스 작성자가 제공하는 테스트 라이브러리를 사용하세요.</font></font></p>
<p><a id=t-fatal></a></p>
<h3 id=terror-vs-tfatal><code class="language-plaintext highlighter-rouge">t.Error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>대</font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><a class=anchorjs-link href=#terror-vs-tfatal aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#keep-going><font style=vertical-align:inherit><font style=vertical-align:inherit>결정</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에서 논의한 것처럼 </font><font style=vertical-align:inherit>일반적으로 테스트는 처음 발생한 문제에서 중단되어서는 안 됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>그러나 일부 상황에서는 테스트가 진행되지 않아야 합니다. 호출은 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 설정의 일부가 실패할 때, 특히
 </font></font><a href=#test-helper-error-handling><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 설정 도우미</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에서 실패할 때 적절하며 , 그렇지 않으면 나머지 테스트를 실행할 수 없습니다. 테이블 기반 테스트에서는 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 루프 이전에 전체 테스트 기능을 설정하는 실패에 적합합니다. 테스트 테이블의 단일 항목에 영향을 주어 해당 항목을 계속할 수 없게 만드는 실패는 다음과 같이 보고되어야 합니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">t.Run</code><font style=vertical-align:inherit><font style=vertical-align:inherit>하위 테스트를 </font><font style=vertical-align:inherit>사용하지 않는 경우 </font></font><code class="language-plaintext highlighter-rouge">t.Error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>명령문을 사용하여 </font></font><code class="language-plaintext highlighter-rouge">continue</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
다음 테이블 항목으로 이동하세요.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>하위 테스트를 사용하고 있는 경우(및 에 대한 호출 내부에 있는 경우 </font></font><code class="language-plaintext highlighter-rouge">t.Run</code><font style=vertical-align:inherit><font style=vertical-align:inherit>)
 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>현재 하위 테스트를 종료하고 테스트 사례가 다음 하위 테스트로 진행될 수 있도록 하는 를 사용하세요.</font></font></li>
</ul>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>경고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 호출 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>및 유사한 기능이 항상 안전한 것은 아닙니다.
 </font></font><a href=#t-fatal-goroutine><font style=vertical-align:inherit><font style=vertical-align:inherit>자세한 내용은 여기를 참조하세요</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> .</font></font></p>
<p><a id=test-helper-error-handling></a></p>
<h3 id=error-handling-in-test-helpers><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 도우미의 오류 처리</font></font><a class=anchorjs-link href=#error-handling-in-test-helpers aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 섹션에서는 </font><font style=vertical-align:inherit>Go에서 일반적인 어설션 기능이 아닌 테스트 설정 및 정리를 수행하는 함수라는 용어를 사용하는 의미의 </font></font><a href=https://google.github.io/styleguide/go/decisions#mark-test-helpers><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 도우미</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 대해 설명합니다. 자세한 내용은 </font></font><a href=#test-functions><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 기능</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 섹션을 참조하세요 .</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 도우미가 수행한 작업이 실패하는 경우가 있습니다. 예를 들어 파일이 포함된 디렉터리를 설정하려면 I/O가 필요하므로 실패할 수 있습니다. 테스트 도우미가 실패하면 설정 전제 조건이 실패했기 때문에 테스트를 계속할 수 없음을 의미하는 경우가 많습니다. 이런 일이 발생하면 </font></font><code class="language-plaintext highlighter-rouge">Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
도우미의 함수 중 하나를 호출하는 것이 좋습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>mustAddGameAssets</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>dir</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>t</span><span class=o>.</span><span class=n>Helper</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>WriteFile</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>Join</span><span class=p>(</span><span class=n>dir</span><span class=p>,</span> <span class=s>"pak0.pak"</span><span class=p>),</span> <span class=n>pak0</span><span class=p>,</span> <span class=m>0644</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Setup failed: could not write pak0 asset: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>WriteFile</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>Join</span><span class=p>(</span><span class=n>dir</span><span class=p>,</span> <span class=s>"pak1.pak"</span><span class=p>),</span> <span class=n>pak1</span><span class=p>,</span> <span class=m>0644</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Setup failed: could not write pak1 asset: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이렇게 하면 도우미가 테스트 자체에 오류를 반환하는 경우보다 호출측이 더 깔끔하게 유지됩니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>func</span> <span class=n>addGameAssets</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>dir</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=n>t</span><span class=o>.</span><span class=n>Helper</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>WriteFile</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>Join</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=s>"pak0.pak"</span><span class=p>),</span> <span class=n>pak0</span><span class=p>,</span> <span class=m>0644</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>err</span>
    <span class=p>}</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>WriteFile</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>Join</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=s>"pak1.pak"</span><span class=p>),</span> <span class=n>pak1</span><span class=p>,</span> <span class=m>0644</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>err</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=no>nil</span>
<span class=p>}</span>
</code></pre></div></div>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>경고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 호출 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>및 유사한 기능이 항상 안전한 것은 아닙니다.
 </font></font><a href=#t-fatal-goroutine><font style=vertical-align:inherit><font style=vertical-align:inherit>자세한 내용은</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 여기를 참조하세요.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>실패 메시지에는 발생한 상황에 대한 설명이 포함되어야 합니다. 이는 특히 도우미에서 오류를 생성하는 단계 수가 증가함에 따라 많은 사용자에게 테스트 API를 제공할 수 있으므로 중요합니다. 테스트가 실패하면 사용자는 어디서, 왜 실패했는지 알아야 합니다.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>팁:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> Go 1.14에는 </font></font><a href=https://pkg.go.dev/testing#T.Cleanup><code class="language-plaintext highlighter-rouge">t.Cleanup</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트가 완료될 때 실행되는 정리 기능을 등록하는 데 사용할 수 있는 기능이 도입되었습니다. 이 함수는 테스트 도우미와도 작동합니다. </font><font style=vertical-align:inherit>
테스트 도우미 단순화에 대한 지침은 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #4: 테스트 정리를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요
 .</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>아래의 가상 파일에 있는 스니펫은 </font><font style=vertical-align:inherit>Go 테스트에서 실패 보고에 </font></font><code class="language-plaintext highlighter-rouge">paint_test.go</code><font style=vertical-align:inherit><font style=vertical-align:inherit>어떤 영향을 미치는지 보여줍니다
 .</font></font><code class="language-plaintext highlighter-rouge">(*testing.T).Helper</code><font style=vertical-align:inherit></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>package</span> <span class=n>paint_test</span><font></font>
<font></font>
<span class=k>import</span> <span class=p>(</span>
    <span class=s>"fmt"</span>
    <span class=s>"testing"</span>
<span class=p>)</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>paint</span><span class=p>(</span><span class=n>color</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"no %q paint today"</span><span class=p>,</span> <span class=n>color</span><span class=p>)</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>badSetup</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// This should call t.Helper, but doesn't.</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>paint</span><span class=p>(</span><span class=s>"taupe"</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Could not paint the house under test: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span> <span class=c>// line 15</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>mustGoodSetup</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>t</span><span class=o>.</span><span class=n>Helper</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>paint</span><span class=p>(</span><span class=s>"lilac"</span><span class=p>);</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Could not paint the house under test: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestBad</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>badSetup</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
    <span class=c>// ...</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestGood</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>mustGoodSetup</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=c>// line 32</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음은 실행 시 출력의 예입니다. 강조 표시된 텍스트와 차이점을 확인하세요.</font></font></p>
<div class="language-text highlighter-rouge"><div class=highlight><pre class=highlight><code>=== RUN   TestBad<font></font>
    paint_test.go:15: Could not paint the house under test: no "taupe" paint today<font></font>
--- FAIL: TestBad (0.00s)<font></font>
=== RUN   TestGood<font></font>
    paint_test.go:32: Could not paint the house under test: no "lilac" paint today<font></font>
--- FAIL: TestGood (0.00s)<font></font>
FAIL<font></font>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>오류는 </font></font><code class="language-plaintext highlighter-rouge">paint_test.go:15</code><font style=vertical-align:inherit><font style=vertical-align:inherit>실패한 setup 함수의 줄을 참조합니다 </font></font><code class="language-plaintext highlighter-rouge">badSetup</code><font style=vertical-align:inherit><font style=vertical-align:inherit>:</font></font></p>
<p><code class="language-plaintext highlighter-rouge">t.Fatalf("Could not paint the house under test: %v", err)</code></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>반면 </font></font><code class="language-plaintext highlighter-rouge">paint_test.go:32</code><font style=vertical-align:inherit><font style=vertical-align:inherit>에 실패한 테스트 라인을 나타냅니다
 </font></font><code class="language-plaintext highlighter-rouge">TestGood</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><code class="language-plaintext highlighter-rouge">goodSetup(t)</code></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>다음과 같은 경우 속성을 올바르게 사용하면 </font></font><code class="language-plaintext highlighter-rouge">(*testing.T).Helper</code><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 위치가 훨씬 더 좋습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>도우미 기능이 성장합니다</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>도우미 함수는 다른 도우미를 호출합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 기능의 도우미 사용량 증가</font></font></li>
</ul>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>팁:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 도우미가 </font></font><code class="language-plaintext highlighter-rouge">(*testing.T).Error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>또는 를 호출하는 경우 </font></font><code class="language-plaintext highlighter-rouge">(*testing.T).Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>형식 문자열에 일부 컨텍스트를 제공하여 문제가 무엇인지, 왜 그런지 파악하는 데 도움을 줍니다.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>팁:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 도우미가 수행하는 작업으로 인해 테스트가 실패할 수 없는 경우 를 호출할 필요가 없습니다 </font></font><code class="language-plaintext highlighter-rouge">t.Helper</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. </font></font><code class="language-plaintext highlighter-rouge">t</code><font style=vertical-align:inherit><font style=vertical-align:inherit>함수 매개변수 목록에서 </font><font style=vertical-align:inherit>제거하여 서명을 단순화합니다 .</font></font></p>
<p><a id=t-fatal-goroutine></a></p>
<h3 id=dont-call-tfatal-from-separate-goroutines><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>별도의 고루틴에서 </font><font style=vertical-align:inherit>호출하지 마세요</font></font><a class=anchorjs-link href=#dont-call-tfatal-from-separate-goroutines aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><a href=https://pkg.go.dev/testing#T><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 패키지에 설명된</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 대로 </font><font style=vertical-align:inherit>테스트 함수(또는 하위 테스트)를 실행하는 고루틴이 아닌 다른 고루틴에서 , 등을 </font></font><code class="language-plaintext highlighter-rouge">t.FailNow</code><font style=vertical-align:inherit><font style=vertical-align:inherit>호출 </font><font style=vertical-align:inherit>하는 것은 올바르지 않습니다 . </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트가 새로운 고루틴을 시작하는 경우 해당 고루틴 내부에서 이러한 함수를 호출해서는 안 됩니다.</font></font></p>
<p><a href=#test-functions><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 도우미는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 일반적으로 새로운 고루틴에서 실패 신호를 보내지 않으므로 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 의심스러우면 전화를 걸어 </font></font><code class="language-plaintext highlighter-rouge">t.Error</code><font style=vertical-align:inherit><font style=vertical-align:inherit>대신 돌아오세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>TestRevEngine</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>engine</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>Start</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Engine failed to start: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span><font></font>
<font></font>
    <span class=n>num</span> <span class=o>:=</span> <span class=m>11</span>
    <span class=k>var</span> <span class=n>wg</span> <span class=n>sync</span><span class=o>.</span><span class=n>WaitGroup</span>
    <span class=n>wg</span><span class=o>.</span><span class=n>Add</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>i</span> <span class=o>:=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>num</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span> <span class=p>{</span>
        <span class=k>go</span> <span class=k>func</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>defer</span> <span class=n>wg</span><span class=o>.</span><span class=n>Done</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>engine</span><span class=o>.</span><span class=n>Vroom</span><span class=p>();</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
                <span class=c>// This cannot be t.Fatalf.</span>
                <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"No vroom left on engine: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
                <span class=k>return</span>
            <span class=p>}</span>
            <span class=k>if</span> <span class=n>rpm</span> <span class=o>:=</span> <span class=n>engine</span><span class=o>.</span><span class=n>Tachometer</span><span class=p>();</span> <span class=n>rpm</span> <span class=o>&gt;</span> <span class=m>1e6</span> <span class=p>{</span>
                <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"Inconceivable engine rate: %d"</span><span class=p>,</span> <span class=n>rpm</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=p>}()</span>
    <span class=p>}</span>
    <span class=n>wg</span><span class=o>.</span><span class=n>Wait</span><span class=p>()</span><font></font>
<font></font>
    <span class=k>if</span> <span class=n>seen</span> <span class=o>:=</span> <span class=n>engine</span><span class=o>.</span><span class=n>NumVrooms</span><span class=p>();</span> <span class=n>seen</span> <span class=o>!=</span> <span class=n>num</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"engine.NumVrooms() = %d, want %d"</span><span class=p>,</span> <span class=n>seen</span><span class=p>,</span> <span class=n>num</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">t.Parallel</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트나 하위 테스트에
 </font><font style=vertical-align:inherit>추가한다고 해서 호출하는 것이 안전하지 않게 되는 것은 아닙니다 </font></font><code class="language-plaintext highlighter-rouge">t.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>API 에 대한 모든 호출이 </font><a href=#test-functions><font style=vertical-align:inherit>테스트 함수</font></a></font><code class="language-plaintext highlighter-rouge">testing</code><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 있으면 일반적 </font><font style=vertical-align:inherit>으로 키워드가 눈에 띄기 </font><font style=vertical-align:inherit>때문에 잘못된 사용법을 쉽게 발견할 수 있습니다 . 인수를 </font><font style=vertical-align:inherit>전달하면 </font><font style=vertical-align:inherit>이러한 사용량을 추적하기가 더 어려워집니다. 일반적으로 이러한 인수를 전달하는 이유는 테스트 도우미를 도입하기 위한 것이며 테스트 중인 시스템에 의존해서는 안 됩니다. 따라서 테스트 도우미가 </font><a href=#test-helper-error-handling><font style=vertical-align:inherit>치명적인 테스트 실패를 등록하는</font></a><font style=vertical-align:inherit> 경우 테스트의 고루틴에서 그렇게 할 수 있고 그렇게 해야 합니다.</font></font><a href=#test-functions><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">go</code><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">testing.T</code><font style=vertical-align:inherit></font><a href=#test-helper-error-handling><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
<p><a id=t-field-names></a></p>
<h3 id=use-field-names-in-struct-literals><font style=vertical-align:inherit><font style=vertical-align:inherit>구조체 리터럴에 필드 이름 사용</font></font><a class=anchorjs-link href=#use-field-names-in-struct-literals aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><a id=t-field-labels></a></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테이블 기반 테스트에서는 테스트 케이스 구조체 리터럴을 초기화할 때 필드 이름을 지정하는 것을 선호합니다. 이는 테스트 케이스가 많은 양의 수직 공간(예: 20-30줄 이상)을 포함할 때, 동일한 유형의 인접한 필드가 있을 때, 값이 0인 필드를 생략하려는 경우에 유용합니다. 예를 들어:</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>TestStrJoin</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>tests</span> <span class=o>:=</span> <span class=p>[]</span><span class=k>struct</span> <span class=p>{</span>
        <span class=n>slice</span>     <span class=p>[]</span><span class=kt>string</span>
        <span class=n>separator</span> <span class=kt>string</span>
        <span class=n>skipEmpty</span> <span class=kt>bool</span>
        <span class=n>want</span>      <span class=kt>string</span>
    <span class=p>}{</span>
        <span class=p>{</span>
            <span class=n>slice</span><span class=o>:</span>     <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"a"</span><span class=p>,</span> <span class=s>"b"</span><span class=p>,</span> <span class=s>""</span><span class=p>},</span>
            <span class=n>separator</span><span class=o>:</span> <span class=s>","</span><span class=p>,</span>
            <span class=n>want</span><span class=o>:</span>      <span class=s>"a,b,"</span><span class=p>,</span>
        <span class=p>},</span>
        <span class=p>{</span>
            <span class=n>slice</span><span class=o>:</span>     <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>"a"</span><span class=p>,</span> <span class=s>"b"</span><span class=p>,</span> <span class=s>""</span><span class=p>},</span>
            <span class=n>separator</span><span class=o>:</span> <span class=s>","</span><span class=p>,</span>
            <span class=n>skipEmpty</span><span class=o>:</span> <span class=no>true</span><span class=p>,</span>
            <span class=n>want</span><span class=o>:</span>      <span class=s>"a,b"</span><span class=p>,</span>
        <span class=p>},</span>
        <span class=c>// ...</span>
    <span class=p>}</span>
    <span class=c>// ...</span>
<span class=p>}</span>
</code></pre></div></div>
<p><a id=t-common-setup-scope></a></p>
<h3 id=keep-setup-code-scoped-to-specific-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>설정 코드의 범위를 특정 테스트로 유지</font></font><a class=anchorjs-link href=#keep-setup-code-scoped-to-specific-tests aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가능한 경우 리소스 및 종속성 설정은 가능한 한 특정 테스트 사례에 밀접하게 적용되어야 합니다. 예를 들어, 설정 함수가 다음과 같습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// mustLoadDataSet loads a data set for the tests.</span>
<span class=c>//</span>
<span class=c>// This example is very simple and easy to read. Often realistic setup is more</span>
<span class=c>// complex, error-prone, and potentially slow.</span>
<span class=k>func</span> <span class=n>mustLoadDataset</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>[]</span><span class=kt>byte</span> <span class=p>{</span>
    <span class=n>t</span><span class=o>.</span><span class=n>Helper</span><span class=p>()</span>
    <span class=n>data</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>ReadFile</span><span class=p>(</span><span class=s>"path/to/your/project/testdata/dataset"</span><span class=p>)</span><font></font>
<font></font>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Could not load dataset: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=n>data</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">mustLoadDataset</code><font style=vertical-align:inherit><font style=vertical-align:inherit>필요한 테스트 함수에서 명시적으로 </font><font style=vertical-align:inherit>호출합니다 .</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>TestParseData</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>data</span> <span class=o>:=</span> <span class=n>mustLoadDataset</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
    <span class=n>parsed</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>ParseData</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Unexpected error parsing data: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=n>want</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=n>DataTable</span><span class=p>{</span> <span class=c>/* ... */</span> <span class=p>}</span>
    <span class=k>if</span> <span class=n>got</span> <span class=o>:=</span> <span class=n>parsed</span><span class=p>;</span> <span class=o>!</span><span class=n>cmp</span><span class=o>.</span><span class=n>Equal</span><span class=p>(</span><span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"ParseData(data) = %v, want %v"</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestListContents</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>data</span> <span class=o>:=</span> <span class=n>mustLoadDataset</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
    <span class=n>contents</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>ListContents</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Unexpected error listing contents: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=n>want</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span> <span class=c>/* ... */</span> <span class=p>}</span>
    <span class=k>if</span> <span class=n>got</span> <span class=o>:=</span> <span class=n>contents</span><span class=p>;</span> <span class=o>!</span><span class=n>cmp</span><span class=o>.</span><span class=n>Equal</span><span class=p>(</span><span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>"ListContents(data) = %v, want %v"</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestRegression682831</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span> <span class=o>:=</span> <span class=n>guessOS</span><span class=p>(</span><span class=s>"zpc79.example.com"</span><span class=p>),</span> <span class=s>"grhat"</span><span class=p>;</span> <span class=n>got</span> <span class=o>!=</span> <span class=n>want</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>`guessOS("zpc79.example.com") = %q, want %q`</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 함수는 </font></font><code class="language-plaintext highlighter-rouge">TestRegression682831</code><font style=vertical-align:inherit><font style=vertical-align:inherit>데이터 세트를 사용하지 않으므로 를 호출하지 않습니다 </font></font><code class="language-plaintext highlighter-rouge">mustLoadDataset</code><font style=vertical-align:inherit><font style=vertical-align:inherit>. 이는 속도가 느리고 실패할 가능성이 높습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>var</span> <span class=n>dataset</span> <span class=p>[]</span><span class=kt>byte</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestParseData</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// As documented above without calling mustLoadDataset directly.</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestListContents</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=c>// As documented above without calling mustLoadDataset directly.</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestRegression682831</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span> <span class=o>:=</span> <span class=n>guessOS</span><span class=p>(</span><span class=s>"zpc79.example.com"</span><span class=p>),</span> <span class=s>"grhat"</span><span class=p>;</span> <span class=n>got</span> <span class=o>!=</span> <span class=n>want</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>`guessOS("zpc79.example.com") = %q, want %q`</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>init</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>dataset</span> <span class=o>=</span> <span class=n>mustLoadDataset</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자는 다른 기능과 별도로 기능을 실행하기를 원할 수 있으며 다음 요인으로 인해 불이익을 받아서는 안 됩니다.</font></font></p>
<div class="language-shell highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c># No reason for this to perform the expensive initialization.</span>
<span class=nv>$ </span>go <span class=nb>test</span> <span class=nt>-run</span> TestRegression682831
</code></pre></div></div>
<p><a id=t-custom-main></a></p>
<h4 id=when-to-use-a-custom-testmain-entrypoint><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">TestMain</code><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자 정의 진입점을 </font><font style=vertical-align:inherit>사용하는 경우</font></font><a class=anchorjs-link href=#when-to-use-a-custom-testmain-entrypoint aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지의 모든 테스트에</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 공통 설정이 필요하고 </font></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>설정에 해체가 필요한</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 경우 사용자 </font></font><a href=https://golang.org/pkg/testing/#hdr-Main><font style=vertical-align:inherit><font style=vertical-align:inherit>지정 testmain 진입점을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 사용할 수 있습니다 . 이는 테스트 케이스에 필요한 리소스가 설정하기에 특히 비용이 많이 들고 비용을 상각해야 하는 경우에 발생할 수 있습니다. 일반적으로 그 시점에서 테스트 모음에서 관련 없는 모든 테스트를 추출했습니다. 일반적으로 </font></font><a href=https://en.wikipedia.org/wiki/Functional_testing><font style=vertical-align:inherit><font style=vertical-align:inherit>기능 테스트</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에만 사용됩니다 </font><font style=vertical-align:inherit>.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>올바른 사용을 위해 주의를 기울여야 하는 만큼 사용자 </font><font style=vertical-align:inherit>정의를 사용하는 것이 </font></font><code class="language-plaintext highlighter-rouge">TestMain</code> <strong><font style=vertical-align:inherit><font style=vertical-align:inherit>첫 번째 선택이 되어서는 안 됩니다 . </font></font></strong><font style=vertical-align:inherit></font><a href=#t-setup-amortization><em><font style=vertical-align:inherit><font style=vertical-align:inherit>분할 상환 일반 테스트 설정</font></font></em></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 섹션 의 솔루션 </font><font style=vertical-align:inherit>이나 일반 </font></font><a href=#t-common-setup-scope><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 도우미가</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 귀하의 요구 사항에 충분한지 먼저 고려하십시오.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=n>db</span> <span class=o>*</span><span class=n>sql</span><span class=o>.</span><span class=n>DB</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestInsert</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span> <span class=c>/* omitted */</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestSelect</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span> <span class=c>/* omitted */</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestUpdate</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span> <span class=c>/* omitted */</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestDelete</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span> <span class=c>/* omitted */</span> <span class=p>}</span><font></font>
<font></font>
<span class=c>// runMain sets up the test dependencies and eventually executes the tests.</span>
<span class=c>// It is defined as a separate function to enable the setup stages to clearly</span>
<span class=c>// defer their teardown steps.</span>
<span class=k>func</span> <span class=n>runMain</span><span class=p>(</span><span class=n>ctx</span> <span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>,</span> <span class=n>m</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>M</span><span class=p>)</span> <span class=p>(</span><span class=n>code</span> <span class=kt>int</span><span class=p>,</span> <span class=n>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ctx</span><span class=p>,</span> <span class=n>cancel</span> <span class=o>:=</span> <span class=n>context</span><span class=o>.</span><span class=n>WithCancel</span><span class=p>(</span><span class=n>ctx</span><span class=p>)</span>
    <span class=k>defer</span> <span class=n>cancel</span><span class=p>()</span><font></font>
<font></font>
    <span class=n>d</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>setupDatabase</span><span class=p>(</span><span class=n>ctx</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=k>return</span> <span class=m>0</span><span class=p>,</span> <span class=n>err</span>
    <span class=p>}</span>
    <span class=k>defer</span> <span class=n>d</span><span class=o>.</span><span class=n>Close</span><span class=p>()</span> <span class=c>// Expressly clean up database.</span>
    <span class=n>db</span> <span class=o>=</span> <span class=n>d</span>          <span class=c>// db is defined as a package-level variable.</span><font></font>
<font></font>
    <span class=c>// m.Run() executes the regular, user-defined test functions.</span>
    <span class=c>// Any defer statements that have been made will be run after m.Run()</span>
    <span class=c>// completes.</span>
    <span class=k>return</span> <span class=n>m</span><span class=o>.</span><span class=n>Run</span><span class=p>(),</span> <span class=no>nil</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestMain</span><span class=p>(</span><span class=n>m</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>M</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>code</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>runMain</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>Background</span><span class=p>(),</span> <span class=n>m</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=c>// Failure messages should be written to STDERR, which log.Fatal uses.</span>
        <span class=n>log</span><span class=o>.</span><span class=n>Fatal</span><span class=p>(</span><span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=c>// NOTE: defer statements do not run past here due to os.Exit</span>
    <span class=c>//       terminating the process.</span>
    <span class=n>os</span><span class=o>.</span><span class=n>Exit</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이상적으로 테스트 케이스는 자체 호출과 다른 테스트 케이스 간에 밀폐되어 있습니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>최소한 개별 테스트 사례가 수정한 전역 상태를 재설정했는지 확인하십시오(예: 테스트가 외부 데이터베이스를 사용하여 작동하는 경우).</font></font></p>
<p><a id=t-setup-amortization></a></p>
<h4 id=amortizing-common-test-setup><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적인 테스트 설정 분할 상환</font></font><a class=anchorjs-link href=#amortizing-common-test-setup aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h4>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">sync.Once</code><font style=vertical-align:inherit><font style=vertical-align:inherit>공통 설정에 대해 다음 사항이 모두 참인 경우 필수는 아니지만 </font><font style=vertical-align:inherit>a를 사용하는 것이 적절할 수 있습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>비쌉니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>일부 테스트에만 적용됩니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>분해가 필요하지 않습니다.</font></font></li>
</ul>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>var</span> <span class=n>dataset</span> <span class=k>struct</span> <span class=p>{</span>
    <span class=n>once</span> <span class=n>sync</span><span class=o>.</span><span class=n>Once</span>
    <span class=n>data</span> <span class=p>[]</span><span class=kt>byte</span>
    <span class=n>err</span>  <span class=kt>error</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>mustLoadDataset</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>[]</span><span class=kt>byte</span> <span class=p>{</span>
    <span class=n>t</span><span class=o>.</span><span class=n>Helper</span><span class=p>()</span>
    <span class=n>dataset</span><span class=o>.</span><span class=n>once</span><span class=o>.</span><span class=n>Do</span><span class=p>(</span><span class=k>func</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>data</span><span class=p>,</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>os</span><span class=o>.</span><span class=n>ReadFile</span><span class=p>(</span><span class=s>"path/to/your/project/testdata/dataset"</span><span class=p>)</span>
        <span class=c>// dataset is defined as a package-level variable.</span>
        <span class=n>dataset</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
        <span class=n>dataset</span><span class=o>.</span><span class=n>err</span> <span class=o>=</span> <span class=n>err</span>
    <span class=p>})</span>
    <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>err</span><span class=p>;</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Fatalf</span><span class=p>(</span><span class=s>"Could not load dataset: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=n>dataset</span><span class=o>.</span><span class=n>data</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>여러 테스트 기능에 사용되는 경우 </font></font><code class="language-plaintext highlighter-rouge">mustLoadDataset</code><font style=vertical-align:inherit><font style=vertical-align:inherit>비용은 상각됩니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>func</span> <span class=n>TestParseData</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>data</span> <span class=o>:=</span> <span class=n>mustLoadDataset</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><font></font>
<font></font>
    <span class=c>// As documented above.</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestListContents</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>data</span> <span class=o>:=</span> <span class=n>mustLoadDataset</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><font></font>
<font></font>
    <span class=c>// As documented above.</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestRegression682831</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span> <span class=o>:=</span> <span class=n>guessOS</span><span class=p>(</span><span class=s>"zpc79.example.com"</span><span class=p>),</span> <span class=s>"grhat"</span><span class=p>;</span> <span class=n>got</span> <span class=o>!=</span> <span class=n>want</span> <span class=p>{</span>
        <span class=n>t</span><span class=o>.</span><span class=n>Errorf</span><span class=p>(</span><span class=s>`guessOS("zpc79.example.com") = %q, want %q`</span><span class=p>,</span> <span class=n>got</span><span class=p>,</span> <span class=n>want</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>일반적인 분해가 까다로운 이유는 정리 루틴을 등록할 통일된 장소가 없기 때문입니다. 설정 기능(이 경우 </font></font><code class="language-plaintext highlighter-rouge">loadDataset</code><font style=vertical-align:inherit><font style=vertical-align:inherit>)이 컨텍스트에 의존하는 경우 </font></font><code class="language-plaintext highlighter-rouge">sync.Once</code><font style=vertical-align:inherit><font style=vertical-align:inherit>문제가 발생할 수 있습니다. 이는 설정 함수에 대한 두 번의 레이싱 호출 중 두 번째 호출이 반환되기 전에 첫 번째 호출이 완료될 때까지 기다려야 하기 때문입니다. 이 대기 기간은 컨텍스트 취소를 존중하기 위해 쉽게 만들어질 수 없습니다.</font></font></p>
<p><a id=string-concat></a></p>
<h2 id=string-concatenation><font style=vertical-align:inherit><font style=vertical-align:inherit>문자열 연결</font></font><a class=anchorjs-link href=#string-concatenation aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go에서 문자열을 연결하는 방법에는 여러 가지가 있습니다. 몇 가지 예는 다음과 같습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>"+" 연산자</font></font></li>
 <li><code class="language-plaintext highlighter-rouge">fmt.Sprintf</code></li>
 <li><code class="language-plaintext highlighter-rouge">strings.Builder</code></li>
 <li><code class="language-plaintext highlighter-rouge">text/template</code></li>
 <li><code class="language-plaintext highlighter-rouge">safehtml/template</code></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>선택할 수 있는 일률적인 규칙은 없지만 다음 지침에서는 각 방법이 선호되는 경우를 간략하게 설명합니다.</font></font></p>
<p><a id=string-concat-simple></a></p>
<h3 id=prefer--for-simple-cases><font style=vertical-align:inherit><font style=vertical-align:inherit>간단한 경우에는 "+"를 선호합니다.</font></font><a class=anchorjs-link href=#prefer--for-simple-cases aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>몇 개의 문자열을 연결할 때는 "+"를 사용하는 것이 좋습니다. 이 방법은 구문상 가장 간단하며 가져오기가 필요하지 않습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>key</span> <span class=o>:=</span> <span class=s>"projectid: "</span> <span class=o>+</span> <span class=n>p</span>
</code></pre></div></div>
<p><a id=string-concat-fmt></a></p>
<h3 id=prefer-fmtsprintf-when-formatting><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">fmt.Sprintf</code><font style=vertical-align:inherit><font style=vertical-align:inherit>포맷할 때 </font><font style=vertical-align:inherit>선호</font></font><a class=anchorjs-link href=#prefer-fmtsprintf-when-formatting aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">fmt.Sprintf</code><font style=vertical-align:inherit><font style=vertical-align:inherit>서식을 지정하여 복잡한 문자열을 작성할 때 </font><font style=vertical-align:inherit>사용하는 것이 좋습니다 . </font><font style=vertical-align:inherit>"+" 연산자를 많이 사용하면 최종 결과가 모호해질 수 있습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>str</span> <span class=o>:=</span> <span class=n>fmt</span><span class=o>.</span><span class=n>Sprintf</span><span class=p>(</span><span class=s>"%s [%s:%d]-&gt; %s"</span><span class=p>,</span> <span class=n>src</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>mtu</span><span class=p>,</span> <span class=n>dst</span><span class=p>)</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=n>bad</span> <span class=o>:=</span> <span class=n>src</span><span class=o>.</span><span class=n>String</span><span class=p>()</span> <span class=o>+</span> <span class=s>" ["</span> <span class=o>+</span> <span class=n>qos</span><span class=o>.</span><span class=n>String</span><span class=p>()</span> <span class=o>+</span> <span class=s>":"</span> <span class=o>+</span> <span class=n>strconv</span><span class=o>.</span><span class=n>Itoa</span><span class=p>(</span><span class=n>mtu</span><span class=p>)</span> <span class=o>+</span> <span class=s>"]-&gt; "</span> <span class=o>+</span> <span class=n>dst</span><span class=o>.</span><span class=n>String</span><span class=p>()</span>
</code></pre></div></div>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>모범 사례:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 문자열 작성 작업의 출력이 이면
 </font><font style=vertical-align:inherit>작성기로 보내기 위해 </font></font><code class="language-plaintext highlighter-rouge">io.Writer</code><font style=vertical-align:inherit><font style=vertical-align:inherit>임시 문자열을 구성하지 마세요 . </font></font><code class="language-plaintext highlighter-rouge">fmt.Sprintf</code><font style=vertical-align:inherit><font style=vertical-align:inherit>대신 </font></font><code class="language-plaintext highlighter-rouge">fmt.Fprintf</code><font style=vertical-align:inherit><font style=vertical-align:inherit>작성자에게 직접 내보내는 데 사용하세요.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>형식이 훨씬 더 복잡하다면 </font><font style=vertical-align:inherit>적절하게 </font></font><a href=https://pkg.go.dev/text/template><code class="language-plaintext highlighter-rouge">text/template</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>또는 를
 선호하세요.</font></font><a href=https://pkg.go.dev/github.com/google/safehtml/template><code class="language-plaintext highlighter-rouge">safehtml/template</code></a><font style=vertical-align:inherit></font></p>
<p><a id=string-concat-piecemeal></a></p>
<h3 id=prefer-stringsbuilder-for-constructing-a-string-piecemeal><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">strings.Builder</code><font style=vertical-align:inherit><font style=vertical-align:inherit>문자열을 단편적으로 구성하는 것을 </font><font style=vertical-align:inherit>선호합니다 .</font></font><a class=anchorjs-link href=#prefer-stringsbuilder-for-constructing-a-string-piecemeal aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">strings.Builder</code><font style=vertical-align:inherit><font style=vertical-align:inherit>문자열을 비트 단위로 작성할 때
 </font><font style=vertical-align:inherit>사용하는 것을 선호합니다 . </font></font><code class="language-plaintext highlighter-rouge">strings.Builder</code><font style=vertical-align:inherit><font style=vertical-align:inherit>상각된 선형 시간이 걸리는 반면, "+"와 "+"는 </font></font><code class="language-plaintext highlighter-rouge">fmt.Sprintf</code><font style=vertical-align:inherit><font style=vertical-align:inherit>
더 큰 문자열을 형성하기 위해 순차적으로 호출될 때 2차 시간이 걸립니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>b</span> <span class=o>:=</span> <span class=nb>new</span><span class=p>(</span><span class=n>strings</span><span class=o>.</span><span class=n>Builder</span><span class=p>)</span>
<span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span> <span class=o>:=</span> <span class=k>range</span> <span class=n>digitsOfPi</span> <span class=p>{</span>
    <span class=n>fmt</span><span class=o>.</span><span class=n>Fprintf</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=s>"the %d digit of pi is: %d</span><span class=se>\n</span><span class=s>"</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>
<span class=p>}</span>
<span class=n>str</span> <span class=o>:=</span> <span class=n>b</span><span class=o>.</span><span class=n>String</span><span class=p>()</span>
</code></pre></div></div>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 자세한 내용은
 </font></font><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>GoTip #29: 효율적으로 문자열 작성을</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 .</font></font></p>
<p><a id=string-constants></a></p>
<h3 id=constant-strings><font style=vertical-align:inherit><font style=vertical-align:inherit>상수 문자열</font></font><a class=anchorjs-link href=#constant-strings aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>상수, 여러 줄 문자열 리터럴을 생성할 때는 역따옴표(`)를 사용하는 것이 좋습니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=n>usage</span> <span class=o>:=</span> <span class=s>`Usage:

custom_tool [args]`</span>
</code></pre></div></div>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=n>usage</span> <span class=o>:=</span> <span class=s>""</span> <span class=o>+</span>
  <span class=s>"Usage:</span><span class=se>\n</span><span class=s>"</span> <span class=o>+</span>
  <span class=s>"</span><span class=se>\n</span><span class=s>"</span> <span class=o>+</span>
  <span class=s>"custom_tool [args]"</span>
</code></pre></div></div>
<p><a id=globals></a></p>
<h2 id=global-state><font style=vertical-align:inherit><font style=vertical-align:inherit>글로벌 상태</font></font><a class=anchorjs-link href=#global-state aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h2>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>라이브러리는 클라이언트가
 </font></font><a href=https://en.wikipedia.org/wiki/Global_variable><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 의존하는 API를 사용하도록 강요해서는 안 됩니다 . </font><font style=vertical-align:inherit>API의 일부로 모든 클라이언트의 동작을 제어하는 ​​API를 노출하거나 </font></font><a href=https://go.dev/ref/spec#TopLevelDecl><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 수준</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 변수를 내보내지 않는 것이 좋습니다
 . </font><font style=vertical-align:inherit>섹션의 나머지 부분에서는 "전역"과 "패키지 수준 상태"를 동의어로 사용합니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>대신, 기능이 상태를 유지하는 경우 클라이언트가 인스턴스 값을 생성하고 사용할 수 있도록 허용하세요.</font></font></p>
<p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>중요:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 이 지침은 모든 개발자에게 적용되지만, 다른 팀에 라이브러리, 통합 및 서비스를 제공하는 인프라 공급자에게 가장 중요합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=c>// Package sidecar manages subprocesses that provide features for applications.</span>
<span class=k>package</span> <span class=n>sidecar</span><font></font>
<font></font>
<span class=k>type</span> <span class=n>Registry</span> <span class=k>struct</span> <span class=p>{</span> <span class=n>plugins</span> <span class=k>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=n>Plugin</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>New</span><span class=p>()</span> <span class=o>*</span><span class=n>Registry</span> <span class=p>{</span> <span class=k>return</span> <span class=o>&amp;</span><span class=n>Registry</span><span class=p>{</span><span class=n>plugins</span><span class=o>:</span> <span class=nb>make</span><span class=p>(</span><span class=k>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=n>Plugin</span><span class=p>)}</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=p>(</span><span class=n>r</span> <span class=o>*</span><span class=n>Registry</span><span class=p>)</span> <span class=n>Register</span><span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>,</span> <span class=n>p</span> <span class=o>*</span><span class=n>Plugin</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=o>...</span> <span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자는 필요한 데이터(a </font></font><code class="language-plaintext highlighter-rouge">*sidecar.Registry</code><font style=vertical-align:inherit><font style=vertical-align:inherit>)를 인스턴스화한 다음 이를 명시적인 종속성으로 전달합니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>main</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>main</span><span class=p>()</span> <span class=p>{</span>
  <span class=n>sidecars</span> <span class=o>:=</span> <span class=n>sidecar</span><span class=o>.</span><span class=n>New</span><span class=p>()</span>
  <span class=k>if</span> <span class=n>err</span> <span class=o>:=</span> <span class=n>sidecars</span><span class=o>.</span><span class=n>Register</span><span class=p>(</span><span class=s>"Cloud Logger"</span><span class=p>,</span> <span class=n>cloudlogger</span><span class=o>.</span><span class=n>New</span><span class=p>());</span> <span class=n>err</span> <span class=o>!=</span> <span class=no>nil</span> <span class=p>{</span>
    <span class=n>log</span><span class=o>.</span><span class=n>Exitf</span><span class=p>(</span><span class=s>"could not setup cloud logger: %v"</span><span class=p>,</span> <span class=n>err</span><span class=p>)</span>
  <span class=p>}</span>
  <span class=n>cfg</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=n>myapp</span><span class=o>.</span><span class=n>Config</span><span class=p>{</span><span class=n>Sidecars</span><span class=o>:</span> <span class=n>sidecars</span><span class=p>}</span>
  <span class=n>myapp</span><span class=o>.</span><span class=n>Run</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>Background</span><span class=p>(),</span> <span class=n>cfg</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>종속성 전달을 지원하기 위해 기존 코드를 마이그레이션하는 방법에는 여러 가지가 있습니다. 주로 사용하게 될 것은 호출 체인의 생성자, 함수, 메서드 또는 구조체 필드에 종속성을 매개 변수로 전달하는 것입니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #5: 클라이언트 라이브러리 슬리밍</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #24: 사례별 구성 사용</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #40: 함수 매개변수를 사용하여 시간 테스트 가능성 향상</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #41: 함수 호출 매개변수 식별</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #44: 구조체 필드를 사용하여 시간 테스트 가능성 향상</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #80: 종속성 주입 원칙</font></font></a></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>명시적 종속성 전달을 지원하지 않는 API는 클라이언트 수가 증가함에 따라 취약해집니다.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>sidecar</span><font></font>
<font></font>
<span class=k>var</span> <span class=n>registry</span> <span class=o>=</span> <span class=nb>make</span><span class=p>(</span><span class=k>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=n>Plugin</span><span class=p>)</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>Register</span><span class=p>(</span><span class=n>name</span> <span class=kt>string</span><span class=p>,</span> <span class=n>p</span> <span class=o>*</span><span class=n>Plugin</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span> <span class=c>/* registers plugin in registry */</span> <span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>클라우드 로깅을 위해 사이드카에 전이적으로 의존하는 코드를 실행하는 테스트의 경우 어떤 일이 발생하는지 생각해 보세요.</font></font></p>
<div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>app</span><font></font>
<font></font>
<span class=k>import</span> <span class=p>(</span>
  <span class=s>"cloudlogger"</span>
  <span class=s>"sidecar"</span>
  <span class=s>"testing"</span>
<span class=p>)</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestEndToEnd</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
  <span class=c>// The system under test (SUT) relies on a sidecar for a production cloud</span>
  <span class=c>// logger already being registered.</span>
  <span class=o>...</span> <span class=c>// Exercise SUT and check invariants.</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestRegression_NetworkUnavailability</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
  <span class=c>// We had an outage because of a network partition that rendered the cloud</span>
  <span class=c>// logger inoperative, so we added a regression test to exercise the SUT with</span>
  <span class=c>// a test double that simulates network unavailability with the logger.</span>
  <span class=n>sidecar</span><span class=o>.</span><span class=n>Register</span><span class=p>(</span><span class=s>"cloudlogger"</span><span class=p>,</span> <span class=n>cloudloggertest</span><span class=o>.</span><span class=n>UnavailableLogger</span><span class=p>)</span>
  <span class=o>...</span> <span class=c>// Exercise SUT and check invariants.</span>
<span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>TestRegression_InvalidUser</span><span class=p>(</span><span class=n>t</span> <span class=o>*</span><span class=n>testing</span><span class=o>.</span><span class=n>T</span><span class=p>)</span> <span class=p>{</span>
  <span class=c>// The system under test (SUT) relies on a sidecar for a production cloud</span>
  <span class=c>// logger already being registered.</span>
  <span class=c>//</span>
  <span class=c>// Oops. cloudloggertest.UnavailableLogger is still registered from the</span>
  <span class=c>// previous test.</span>
  <span class=o>...</span> <span class=c>// Exercise SUT and check invariants.</span>
<span class=p>}</span>
</code></pre></div></div>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>Go 테스트는 기본적으로 순차적으로 실행되므로 위 테스트는 다음과 같이 실행됩니다.</font></font></p>
<ol>
 <li><code class="language-plaintext highlighter-rouge">TestEndToEnd</code></li>
 <li><code class="language-plaintext highlighter-rouge">TestRegression_NetworkUnavailability</code><font style=vertical-align:inherit><font style=vertical-align:inherit>, 이는 cloudlogger의 기본값을 재정의합니다.</font></font></li>
 <li><code class="language-plaintext highlighter-rouge">TestRegression_InvalidUser</code><font style=vertical-align:inherit><font style=vertical-align:inherit>에 등록된 cloudlogger의 기본값이 필요합니다.</font></font><code class="language-plaintext highlighter-rouge">package sidecar</code></li>
</ol>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이렇게 하면 테스트 필터 실행을 중단하고 테스트가 병렬로 실행되거나 샤딩되는 것을 방지하는 순서 종속 테스트 사례가 생성됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태를 사용하면 사용자와 API 클라이언트에 대한 쉬운 답변이 부족한 문제가 발생합니다.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Plugin</code><font style=vertical-align:inherit><font style=vertical-align:inherit>클라이언트가 동일한 프로세스 공간에서 서로 다른 별도의 운영 세트(예: 여러 서버 지원)를 </font><font style=vertical-align:inherit>사용해야 하는 경우 어떻게 됩니까 ?</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>클라이언트가 </font></font><code class="language-plaintext highlighter-rouge">Plugin</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트에서 </font></font><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 더블</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 과 같은 대체 구현으로 등록된 것을 대체하려는 경우 어떻게 됩니까 ?</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>클라이언트의 테스트에서 의 인스턴스 간
 </font></font><code class="language-plaintext highlighter-rouge">Plugin</code><font style=vertical-align:inherit><font style=vertical-align:inherit>또는 등록된 모든 플러그인 간 기밀성이 필요한 경우 어떻게 되나요?</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>동일한 이름으로 여러 클라이언트가 </font></font><code class="language-plaintext highlighter-rouge">Register</code><font style=vertical-align:inherit><font style=vertical-align:inherit>있는 </font><font style=vertical-align:inherit>경우 어떻게 되나요 ? </font></font><code class="language-plaintext highlighter-rouge">Plugin</code><font style=vertical-align:inherit><font style=vertical-align:inherit>있다면 어느 쪽이 이기나요?</font></font></p>
 <p><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/decisions#handle-errors><font style=vertical-align:inherit><font style=vertical-align:inherit>오류는 어떻게 처리</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 해야 합니까 </font><font style=vertical-align:inherit>? 코드가 패닉을 일으키거나 호출하는 경우 </font><a href=https://google.github.io/styleguide/go/decisions#dont-panic><font style=vertical-align:inherit>API가 호출되는 모든 위치에</font></a></font><code class="language-plaintext highlighter-rouge">log.Fatal</code><font style=vertical-align:inherit><font style=vertical-align:inherit> 항상 적합합니까
 </font><font style=vertical-align:inherit>? 그렇게 하기 전에 클라이언트가 나쁜 일을 하지 않는다는 것을 확인할 수 있습니까?</font></font><a href=https://google.github.io/styleguide/go/decisions#dont-panic><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Register</code><font style=vertical-align:inherit><font style=vertical-align:inherit>프로그램의 시작 단계 또는 수명 중 호출할 수 있는 특정 단계와 호출할 수 없는 </font><font style=vertical-align:inherit>특정 단계가 있습니까 ?</font></font></p>
 <p><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Register</code><font style=vertical-align:inherit><font style=vertical-align:inherit>잘못된 시간에 호출 </font><font style=vertical-align:inherit>되면 어떻게 되나요 ? </font><font style=vertical-align:inherit>클라이언트는
 </font><font style=vertical-align:inherit>플래그가 구문 분석되기 전이나 이후에 </font></font><code class="language-plaintext highlighter-rouge">Register</code><font style=vertical-align:inherit><font style=vertical-align:inherit>호출 할 수 있습니다 </font><font style=vertical-align:inherit>. 함수가 호출되는 단계는 오류 처리에 영향을 줍니다. API 작성자가 API가
 </font><font style=vertical-align:inherit>요구 사항 없이 프로그램 초기화 중에
 </font><em><font style=vertical-align:inherit>만</font></em><font style=vertical-align:inherit> 호출된다고 가정하면 작성자가 API를 -like 함수로 모델링하여
 </font><a href=https://google.github.io/styleguide/go/best-practices#program-init><font style=vertical-align:inherit>프로그램을 중단</font></a><font style=vertical-align:inherit> 하도록 오류 처리를 설계하도록 유도할 수 있습니다 . 중단은 모든 단계에서 사용할 수 있는 범용 라이브러리 함수에는 적합하지 않습니다.</font></font><a href=https://go.dev/ref/spec#Package_initialization><code class="language-plaintext highlighter-rouge">func init</code></a><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">main</code><font style=vertical-align:inherit></font><em><font style=vertical-align:inherit></font></em><font style=vertical-align:inherit></font><a href=https://google.github.io/styleguide/go/best-practices#program-init><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">Must</code><font style=vertical-align:inherit></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>클라이언트와 디자이너의 동시성 요구 사항이 일치하지 않으면 어떻게 되나요?</font></font></p>
 </li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #36: 패키지 수준 상태 포함</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #71: 병렬 테스트 결함 줄이기</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #80: 종속성 주입 원칙</font></font></a></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>오류 처리:
 </font></font><a href=https://docs.python.org/3/glossary.html#term-LBYL><font style=vertical-align:inherit><font style=vertical-align:inherit>도약하기 전에 살펴보는 것</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 
vs
 </font></font><a href=https://docs.python.org/3/glossary.html#term-EAFP><font style=vertical-align:inherit><font style=vertical-align:inherit>허락보다 용서를 구하는 것이 더 쉽다</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/#unit-testing-practices><font style=vertical-align:inherit><font style=vertical-align:inherit>공개 API에 대한 단위 테스트 방법</font></font></a></li>
</ul>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태는
 </font></font><a href=https://google.github.io/styleguide/go/guide.html#maintainability><font style=vertical-align:inherit><font style=vertical-align:inherit>Google 코드베이스의 상태</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에 연쇄적인 영향을 미칩니다 . 글로벌 상태는 </font></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>극도로 면밀히 조사</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 하여 접근해야 합니다 .</font></font></p>
<p><a href=#globals-forms><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태는 여러 형태로 나타나며</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 몇 가지
 </font></font><a href=#globals-litmus-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>리트머스 테스트를 사용하여 언제 안전한지 확인할</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 수 있습니다 .</font></font></p>
<p><a id=globals-forms></a></p>
<h3 id=major-forms-of-package-state-apis><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지 상태 API의 주요 형태</font></font><a class=anchorjs-link href=#major-forms-of-package-state-apis aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>가장 일반적으로 문제가 되는 API 양식은 다음과 같습니다.</font></font></p>
<ul>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>내보내기 여부에 관계없이 최상위 변수입니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>logger</span><font></font>
<font></font>
<span class=c>// Sinks manages the default output sources for this package's logging API.  This</span>
<span class=c>// variable should be set at package initialization time and never thereafter.</span>
<span class=k>var</span> <span class=n>Sinks</span> <span class=p>[]</span><span class=n>Sink</span>
</code></pre></div> </div>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>언제 안전한지 알아보려면 </font></font><a href=#globals-litmus-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>리트머스 테스트를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 .</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>서비스
 </font></font><a href=https://en.wikipedia.org/wiki/Service_locator_pattern><font style=vertical-align:inherit><font style=vertical-align:inherit>로케이터 패턴</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> . </font></font><a href=#globals><font style=vertical-align:inherit><font style=vertical-align:inherit>첫 번째 예를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 참조하세요 </font><font style=vertical-align:inherit>. 서비스 로케이터 패턴 자체는 문제가 되지 않으며 오히려 로케이터가 전역으로 정의됩니다.</font></font></p>
 </li>
 <li>
 <p><font style=vertical-align:inherit></font><a href=https://en.wikipedia.org/wiki/Callback_/(computer_programming/)><font style=vertical-align:inherit><font style=vertical-align:inherit>콜백</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 
및 유사한 동작을 </font><font style=vertical-align:inherit>위한 레지스트리입니다
 .</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>health</span><font></font>
<font></font>
<span class=k>var</span> <span class=n>unhealthyFuncs</span> <span class=p>[]</span><span class=k>func</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>OnUnhealthy</span><span class=p>(</span><span class=n>f</span> <span class=k>func</span><span class=p>())</span> <span class=p>{</span>
  <span class=n>unhealthyFuncs</span> <span class=o>=</span> <span class=nb>append</span><span class=p>(</span><span class=n>unhealthyFuncs</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> </div>
 </li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>백엔드, 스토리지, 데이터 액세스 계층 및 기타 시스템 리소스와 같은 항목을 위한 Thick-Client 싱글톤입니다. 이는 종종 서비스 안정성에 추가적인 문제를 야기합니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Bad:</span>
<span class=k>package</span> <span class=n>useradmin</span><font></font>
<font></font>
<span class=k>var</span> <span class=n>client</span> <span class=n>pb</span><span class=o>.</span><span class=n>UserAdminServiceClientInterface</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>Client</span><span class=p>()</span> <span class=o>*</span><span class=n>pb</span><span class=o>.</span><span class=n>UserAdminServiceClient</span> <span class=p>{</span>
    <span class=k>if</span> <span class=n>client</span> <span class=o>==</span> <span class=no>nil</span> <span class=p>{</span>
        <span class=n>client</span> <span class=o>=</span> <span class=o>...</span>  <span class=c>// Set up client.</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=n>client</span>
<span class=p>}</span>
</code></pre></div> </div>
 </li>
</ul>
<blockquote>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고:</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> Google 코드베이스의 많은 레거시 API는 이 지침을 따르지 않습니다. 실제로 일부 Go 표준 라이브러리는 전역 값을 통한 구성을 허용합니다. 그럼에도 불구하고 레거시 API의 이 지침 위반
 </font><font style=vertical-align:inherit>이 패턴을 지속하기 위한 </font></font><strong><a href=https://google.github.io/styleguide/go/guide#local-consistency><font style=vertical-align:inherit><font style=vertical-align:inherit>선례로 사용되어서는 안 됩니다 .</font></font></a></strong><font style=vertical-align:inherit></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>나중에 재설계 비용을 지불하는 것보다 지금 적절한 API 설계에 투자하는 것이 좋습니다.</font></font></p>
</blockquote>
<p><a id=globals-litmus-tests></a></p>
<h3 id=litmus-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>리트머스 테스트</font></font><a class=anchorjs-link href=#litmus-tests aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><a href=#globals-forms><font style=vertical-align:inherit><font style=vertical-align:inherit>위 패턴을 사용하는 API는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 다음과 같은 경우 안전하지 않습니다.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>여러 함수는 독립적임에도 불구하고 동일한 프로그램에서 실행될 때 전역 상태를 통해 상호 작용합니다(예: 매우 다른 디렉토리의 다른 작성자에 의해 작성됨).</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>독립적인 테스트 케이스는 전역 상태를 통해 서로 상호 작용합니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>API 사용자는 테스트 목적으로 전역 상태를 바꾸거나 대체하고 싶어하는데, 특히 상태의 일부를
 </font><font style=vertical-align:inherit>스텁, 가짜, 스파이 또는 모의와 같은 </font></font><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트 더블 로 대체하고 싶어합니다.</font></font></a><font style=vertical-align:inherit></font></li>
 <li><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">func init</code><font style=vertical-align:inherit><font style=vertical-align:inherit>사용자는 전역 상태 (플래그가 아직 구문 분석되었는지 여부 등) </font><font style=vertical-align:inherit>와 상호 작용할 때 특별한 순서 요구 사항을 고려해야 합니다.</font></font></li>
</ul>
<p><font style=vertical-align:inherit></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>위의 조건을 피한다면 이러한 API가 안전한 몇 가지 제한된 상황</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> , 즉 다음 중 하나라도 해당되는 경우가 </font><font style=vertical-align:inherit>있습니다 .</font></font></p>
<ul>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태는 논리적으로 일정합니다( </font></font><a href=https://github.com/klauspost/compress/blob/290f4cfacb3eff892555a491e3eeb569a48665e7/zstd/snappy.go#L413><font style=vertical-align:inherit><font style=vertical-align:inherit>예</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> ).</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지의 관찰 가능한 동작은 상태 비저장입니다. 예를 들어, 공용 함수는 전용 전역 변수를 캐시로 사용할 수 있지만 호출자가 캐시 적중과 누락을 구별할 수 없는 한 함수는 상태 비저장입니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태는 사이드카 프로세스나 공유 파일 시스템의 파일과 같이 프로그램 외부에 있는 항목에 영향을 주지 않습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>예측 가능한 동작은 기대되지 않습니다( </font></font><a href=https://pkg.go.dev/math/rand><font style=vertical-align:inherit><font style=vertical-align:inherit>예</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> ).</font></font></li>
</ul>
<blockquote>
 <p><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>참고: </font></font></strong>
<a href=https://www.oreilly.com/library/view/designing-distributed-systems/9781491983638/ch02.html><font style=vertical-align:inherit><font style=vertical-align:inherit>사이드카 프로세스는</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 엄밀히 말하면 프로세스 로컬이 </font></font><strong><font style=vertical-align:inherit><font style=vertical-align:inherit>아닐</font></font></strong><font style=vertical-align:inherit><font style=vertical-align:inherit> 
수도 있습니다 . </font><font style=vertical-align:inherit>이는 둘 이상의 지원 프로세스와 공유될 수 있으며 종종 공유됩니다. 더욱이 이러한 사이드카는 종종 외부 분산 시스템과 상호 작용합니다.</font></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한 위의 기본 고려 사항 외에도 동일한 무국적, 멱등성 및 로컬 규칙이 사이드카 프로세스 자체의 코드에 적용됩니다.</font></font></p>
</blockquote>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 안전한 상황 중 하나의 예는
 </font></font><a href=https://pkg.go.dev/image><code class="language-plaintext highlighter-rouge">package image</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>해당
 </font></font><a href=https://pkg.go.dev/image#RegisterFormat><code class="language-plaintext highlighter-rouge">image.RegisterFormat</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>기능입니다. </font></font><a href=https://pkg.go.dev/image/png><font style=vertical-align:inherit><font style=vertical-align:inherit>PNG</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 형식을 처리하는 것과 같은 일반적인 디코더에 적용되는 위의 리트머스 테스트를 고려하십시오 </font><font style=vertical-align:inherit>.</font></font></p>
<ul>
 <li><font style=vertical-align:inherit></font><code class="language-plaintext highlighter-rouge">package image</code><font style=vertical-align:inherit><font style=vertical-align:inherit>등록된 디코더(예: )를 사용하는 의 API </font><font style=vertical-align:inherit>에 대한 다중 호출은 </font></font><code class="language-plaintext highlighter-rouge">image.Decode</code><font style=vertical-align:inherit><font style=vertical-align:inherit>테스트와 마찬가지로 서로 간섭할 수 없습니다. 유일한 예외는 이지만 </font></font><code class="language-plaintext highlighter-rouge">image.RegisterFormat</code><font style=vertical-align:inherit><font style=vertical-align:inherit>아래 사항으로 완화됩니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>PNG 디코더는 실제 객체에 대한 코드베이스의 선호도가 적용되는 사례를 예시하므로 사용자가 디코더를 </font></font><a href=https://abseil.io/resources/swe-book/html/ch13.html#basic_concepts><font style=vertical-align:inherit><font style=vertical-align:inherit>test double</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 로 교체하려고 할 가능성은 거의 없습니다
 . </font><font style=vertical-align:inherit>그러나 디코더가 운영 체제 리소스(예: 네트워크)와 상태적으로 상호 작용하는 경우 사용자는 디코더를 테스트 더블로 교체할 가능성이 더 높습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>등록 시 충돌이 발생할 수 있지만 실제로는 거의 발생하지 않습니다.</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>디코더는 상태가 없고, 멱등성이 있고 순수합니다.</font></font></li>
</ul>
<p><a id=globals-default-instance></a></p>
<h3 id=providing-a-default-instance><font style=vertical-align:inherit><font style=vertical-align:inherit>기본 인스턴스 제공</font></font><a class=anchorjs-link href=#providing-a-default-instance aria-label=닻 data-anchorjs-icon= style="font:1em/1 anchorjs-icons;padding-left:0.375em"></a></h3>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>권장하지는 않지만 사용자의 편의성을 극대화해야 하는 경우 패키지 수준 상태를 사용하는 단순화된 API를 제공하는 것은 허용됩니다.</font></font></p>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>이러한 경우에는 다음 지침에 따라 </font></font><a href=#globals-litmus-tests><font style=vertical-align:inherit><font style=vertical-align:inherit>리트머스 테스트를</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 따르십시오 .</font></font></p>
<ol>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>패키지는 클라이언트에게 </font></font><a href=#globals-forms><font style=vertical-align:inherit><font style=vertical-align:inherit>위에서 설명한</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 대로 패키지 유형의 격리된 인스턴스를 생성할 수 있는 기능을 제공해야 합니다 .</font></font></li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>전역 상태를 사용하는 공개 API는 이전 API에 대한 씬 프록시여야 합니다. 이에 대한 좋은 예는
 </font></font><a href=https://pkg.go.dev/net/http#Handle><code class="language-plaintext highlighter-rouge">http.Handle</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>내부적
 </font></font><a href=https://pkg.go.dev/net/http#ServeMux.Handle><code class="language-plaintext highlighter-rouge">(*http.ServeMux).Handle</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>으로 패키지 변수를
 호출하는 것입니다 </font></font><a href=https://pkg.go.dev/net/http#DefaultServeMux><code class="language-plaintext highlighter-rouge">http.DefaultServeMux</code></a><font style=vertical-align:inherit><font style=vertical-align:inherit>.</font></font></li>
 <li>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>이 패키지 수준 API는 라이브러리가 종속성 전달을 지원하기 위해 리팩토링을 수행하지 않는 한 </font><a href=https://github.com/bazelbuild/rules_go/blob/master/docs/go/core/rules.md#go_library><font style=vertical-align:inherit>라이브러리</font></a><font style=vertical-align:inherit> 가 아닌
 </font></font><a href=https://github.com/bazelbuild/rules_go/blob/master/docs/go/core/rules.md#go_binary><font style=vertical-align:inherit><font style=vertical-align:inherit>바이너리 빌드 대상</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 에서만 사용해야 합니다 . </font><font style=vertical-align:inherit>다른 패키지에서 가져올 수 있는 인프라 라이브러리는 가져오는 패키지의 패키지 수준 상태에 의존해서는 안 됩니다.</font></font><a href=https://github.com/bazelbuild/rules_go/blob/master/docs/go/core/rules.md#go_library><font style=vertical-align:inherit></font></a><font style=vertical-align:inherit></font></p>
 <p><font style=vertical-align:inherit><font style=vertical-align:inherit>예를 들어, 상위에서 API를 사용하여 다른 팀과 공유할 사이드카를 구현하는 인프라 제공자는 이를 수용할 수 있는 API를 제공해야 합니다.</font></font></p>
 <div class="language-go highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=c>// Good:</span>
<span class=k>package</span> <span class=n>cloudlogger</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>New</span><span class=p>()</span> <span class=o>*</span><span class=n>Logger</span> <span class=p>{</span> <span class=o>...</span> <span class=p>}</span><font></font>
<font></font>
<span class=k>func</span> <span class=n>Register</span><span class=p>(</span><span class=n>r</span> <span class=o>*</span><span class=n>sidecar</span><span class=o>.</span><span class=n>Registry</span><span class=p>,</span> <span class=n>l</span> <span class=o>*</span><span class=n>Logger</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>r</span><span class=o>.</span><span class=n>Register</span><span class=p>(</span><span class=s>"Cloud Logging"</span><span class=p>,</span> <span class=n>l</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> </div>
 </li>
 <li><font style=vertical-align:inherit><font style=vertical-align:inherit>이 패키지 수준 API는 불변성을 </font></font><a href=#documentation-conventions><font style=vertical-align:inherit><font style=vertical-align:inherit>문서화</font></font></a><font style=vertical-align:inherit><font style=vertical-align:inherit> 하고 적용해야 합니다(예: 프로그램 수명의 어느 단계에서 호출할 수 있는지, 동시에 사용할 수 있는지 여부). 또한 전역 상태를 알려진 양호한 기본값으로 재설정하는 API를 제공해야 합니다(예: 테스트를 용이하게 하기 위해).</font></font></li>
</ol>
<p><font style=vertical-align:inherit><font style=vertical-align:inherit>또한보십시오:</font></font></p>
<ul>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #36: 패키지 수준 상태 포함</font></font></a></li>
 <li><a href=https://google.github.io/styleguide/go/index.html#gotip><font style=vertical-align:inherit><font style=vertical-align:inherit>팁 #80: 종속성 주입 원칙</font></font></a></li>
</ul>
 
 <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray sf-hidden"></div>
 
 </div>
 
 <div id=goog-gt-tt class="VIpgJd-yAWNEb-L7lbkb skiptranslate sf-hidden" style='border-radius:12px;margin:0 0 0-23px;padding:0;font-family:"Google Sans",Arial,sans-serif' data-id></div>
 
